(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();function Qa(e,t){const i=Object.create(null),s=e.split(",");for(let n=0;n<s.length;n++)i[s[n]]=!0;return t?n=>!!i[n.toLowerCase()]:n=>!!i[n]}const Tt={},hs=[],Se=()=>{},Ff=()=>!1,Nf=/^on[^a-z]/,Gr=e=>Nf.test(e),th=e=>e.startsWith("onUpdate:"),Ht=Object.assign,eh=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},Of=Object.prototype.hasOwnProperty,pt=(e,t)=>Of.call(e,t),ct=Array.isArray,Js=e=>Wr(e)==="[object Map]",Lf=e=>Wr(e)==="[object Set]",ut=e=>typeof e=="function",Vt=e=>typeof e=="string",ih=e=>typeof e=="symbol",Ot=e=>e!==null&&typeof e=="object",Qc=e=>Ot(e)&&ut(e.then)&&ut(e.catch),kf=Object.prototype.toString,Wr=e=>kf.call(e),Uf=e=>Wr(e).slice(8,-1),Hf=e=>Wr(e)==="[object Object]",sh=e=>Vt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,nr=Qa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xr=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},Gf=/-(\w)/g,xs=Xr(e=>e.replace(Gf,(t,i)=>i?i.toUpperCase():"")),Wf=/\B([A-Z])/g,Cs=Xr(e=>e.replace(Wf,"-$1").toLowerCase()),tu=Xr(e=>e.charAt(0).toUpperCase()+e.slice(1)),go=Xr(e=>e?`on${tu(e)}`:""),nn=(e,t)=>!Object.is(e,t),_o=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},_r=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},Xf=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let jh;const ta=()=>jh||(jh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function nh(e){if(ct(e)){const t={};for(let i=0;i<e.length;i++){const s=e[i],n=Vt(s)?jf(s):nh(s);if(n)for(const r in n)t[r]=n[r]}return t}else{if(Vt(e))return e;if(Ot(e))return e}}const $f=/;(?![^(]*\))/g,zf=/:([^]+)/,Vf=new RegExp("\\/\\*.*?\\*\\/","gs");function jf(e){const t={};return e.replace(Vf,"").split($f).forEach(i=>{if(i){const s=i.split(zf);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function rh(e){let t="";if(Vt(e))t=e;else if(ct(e))for(let i=0;i<e.length;i++){const s=rh(e[i]);s&&(t+=s+" ")}else if(Ot(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Yf="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Kf=Qa(Yf);function eu(e){return!!e||e===""}let ge;class iu{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ge,!t&&ge&&(this.index=(ge.scopes||(ge.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const i=ge;try{return ge=this,t()}finally{ge=i}}}on(){ge=this}off(){ge=this.parent}stop(t){if(this._active){let i,s;for(i=0,s=this.effects.length;i<s;i++)this.effects[i].stop();for(i=0,s=this.cleanups.length;i<s;i++)this.cleanups[i]();if(this.scopes)for(i=0,s=this.scopes.length;i<s;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this._active=!1}}}function qf(e){return new iu(e)}function Zf(e,t=ge){t&&t.active&&t.effects.push(e)}function Jf(){return ge}const oh=e=>{const t=new Set(e);return t.w=0,t.n=0,t},su=e=>(e.w&wi)>0,nu=e=>(e.n&wi)>0,Qf=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=wi},tp=e=>{const{deps:t}=e;if(t.length){let i=0;for(let s=0;s<t.length;s++){const n=t[s];su(n)&&!nu(n)?n.delete(e):t[i++]=n,n.w&=~wi,n.n&=~wi}t.length=i}},ea=new WeakMap;let Ws=0,wi=1;const ia=30;let we;const Li=Symbol(""),sa=Symbol("");class ah{constructor(t,i=null,s){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,Zf(this,s)}run(){if(!this.active)return this.fn();let t=we,i=_i;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=we,we=this,_i=!0,wi=1<<++Ws,Ws<=ia?Qf(this):Yh(this),this.fn()}finally{Ws<=ia&&tp(this),wi=1<<--Ws,we=this.parent,_i=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){we===this?this.deferStop=!0:this.active&&(Yh(this),this.onStop&&this.onStop(),this.active=!1)}}function Yh(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let _i=!0;const ru=[];function Is(){ru.push(_i),_i=!1}function Ps(){const e=ru.pop();_i=e===void 0?!0:e}function ie(e,t,i){if(_i&&we){let s=ea.get(e);s||ea.set(e,s=new Map);let n=s.get(i);n||s.set(i,n=oh()),ou(n)}}function ou(e,t){let i=!1;Ws<=ia?nu(e)||(e.n|=wi,i=!su(e)):i=!e.has(we),i&&(e.add(we),we.deps.push(e))}function si(e,t,i,s,n,r){const o=ea.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(i==="length"&&ct(e)){const h=Number(s);o.forEach((l,c)=>{(c==="length"||c>=h)&&a.push(l)})}else switch(i!==void 0&&a.push(o.get(i)),t){case"add":ct(e)?sh(i)&&a.push(o.get("length")):(a.push(o.get(Li)),Js(e)&&a.push(o.get(sa)));break;case"delete":ct(e)||(a.push(o.get(Li)),Js(e)&&a.push(o.get(sa)));break;case"set":Js(e)&&a.push(o.get(Li));break}if(a.length===1)a[0]&&na(a[0]);else{const h=[];for(const l of a)l&&h.push(...l);na(oh(h))}}function na(e,t){const i=ct(e)?e:[...e];for(const s of i)s.computed&&Kh(s);for(const s of i)s.computed||Kh(s)}function Kh(e,t){(e!==we||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const ep=Qa("__proto__,__v_isRef,__isVue"),au=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ih)),ip=hh(),sp=hh(!1,!0),np=hh(!0),qh=rp();function rp(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const s=gt(this);for(let r=0,o=this.length;r<o;r++)ie(s,"get",r+"");const n=s[t](...i);return n===-1||n===!1?s[t](...i.map(gt)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){Is();const s=gt(this)[t].apply(this,i);return Ps(),s}}),e}function op(e){const t=gt(this);return ie(t,"has",e),t.hasOwnProperty(e)}function hh(e=!1,t=!1){return function(s,n,r){if(n==="__v_isReactive")return!e;if(n==="__v_isReadonly")return e;if(n==="__v_isShallow")return t;if(n==="__v_raw"&&r===(e?t?bp:du:t?uu:cu).get(s))return s;const o=ct(s);if(!e){if(o&&pt(qh,n))return Reflect.get(qh,n,r);if(n==="hasOwnProperty")return op}const a=Reflect.get(s,n,r);return(ih(n)?au.has(n):ep(n))||(e||ie(s,"get",n),t)?a:Yt(a)?o&&sh(n)?a:a.value:Ot(a)?e?fu(a):uh(a):a}}const ap=hu(),hp=hu(!0);function hu(e=!1){return function(i,s,n,r){let o=i[s];if(ys(o)&&Yt(o)&&!Yt(n))return!1;if(!e&&(!xr(n)&&!ys(n)&&(o=gt(o),n=gt(n)),!ct(i)&&Yt(o)&&!Yt(n)))return o.value=n,!0;const a=ct(i)&&sh(s)?Number(s)<i.length:pt(i,s),h=Reflect.set(i,s,n,r);return i===gt(r)&&(a?nn(n,o)&&si(i,"set",s,n):si(i,"add",s,n)),h}}function lp(e,t){const i=pt(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&i&&si(e,"delete",t,void 0),s}function cp(e,t){const i=Reflect.has(e,t);return(!ih(t)||!au.has(t))&&ie(e,"has",t),i}function up(e){return ie(e,"iterate",ct(e)?"length":Li),Reflect.ownKeys(e)}const lu={get:ip,set:ap,deleteProperty:lp,has:cp,ownKeys:up},dp={get:np,set(e,t){return!0},deleteProperty(e,t){return!0}},fp=Ht({},lu,{get:sp,set:hp}),lh=e=>e,$r=e=>Reflect.getPrototypeOf(e);function In(e,t,i=!1,s=!1){e=e.__v_raw;const n=gt(e),r=gt(t);i||(t!==r&&ie(n,"get",t),ie(n,"get",r));const{has:o}=$r(n),a=s?lh:i?ph:rn;if(o.call(n,t))return a(e.get(t));if(o.call(n,r))return a(e.get(r));e!==n&&e.get(t)}function Pn(e,t=!1){const i=this.__v_raw,s=gt(i),n=gt(e);return t||(e!==n&&ie(s,"has",e),ie(s,"has",n)),e===n?i.has(e):i.has(e)||i.has(n)}function Mn(e,t=!1){return e=e.__v_raw,!t&&ie(gt(e),"iterate",Li),Reflect.get(e,"size",e)}function Zh(e){e=gt(e);const t=gt(this);return $r(t).has.call(t,e)||(t.add(e),si(t,"add",e,e)),this}function Jh(e,t){t=gt(t);const i=gt(this),{has:s,get:n}=$r(i);let r=s.call(i,e);r||(e=gt(e),r=s.call(i,e));const o=n.call(i,e);return i.set(e,t),r?nn(t,o)&&si(i,"set",e,t):si(i,"add",e,t),this}function Qh(e){const t=gt(this),{has:i,get:s}=$r(t);let n=i.call(t,e);n||(e=gt(e),n=i.call(t,e)),s&&s.call(t,e);const r=t.delete(e);return n&&si(t,"delete",e,void 0),r}function tl(){const e=gt(this),t=e.size!==0,i=e.clear();return t&&si(e,"clear",void 0,void 0),i}function Rn(e,t){return function(s,n){const r=this,o=r.__v_raw,a=gt(o),h=t?lh:e?ph:rn;return!e&&ie(a,"iterate",Li),o.forEach((l,c)=>s.call(n,h(l),h(c),r))}}function Dn(e,t,i){return function(...s){const n=this.__v_raw,r=gt(n),o=Js(r),a=e==="entries"||e===Symbol.iterator&&o,h=e==="keys"&&o,l=n[e](...s),c=i?lh:t?ph:rn;return!t&&ie(r,"iterate",h?sa:Li),{next(){const{value:u,done:d}=l.next();return d?{value:u,done:d}:{value:a?[c(u[0]),c(u[1])]:c(u),done:d}},[Symbol.iterator](){return this}}}}function hi(e){return function(...t){return e==="delete"?!1:this}}function pp(){const e={get(r){return In(this,r)},get size(){return Mn(this)},has:Pn,add:Zh,set:Jh,delete:Qh,clear:tl,forEach:Rn(!1,!1)},t={get(r){return In(this,r,!1,!0)},get size(){return Mn(this)},has:Pn,add:Zh,set:Jh,delete:Qh,clear:tl,forEach:Rn(!1,!0)},i={get(r){return In(this,r,!0)},get size(){return Mn(this,!0)},has(r){return Pn.call(this,r,!0)},add:hi("add"),set:hi("set"),delete:hi("delete"),clear:hi("clear"),forEach:Rn(!0,!1)},s={get(r){return In(this,r,!0,!0)},get size(){return Mn(this,!0)},has(r){return Pn.call(this,r,!0)},add:hi("add"),set:hi("set"),delete:hi("delete"),clear:hi("clear"),forEach:Rn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=Dn(r,!1,!1),i[r]=Dn(r,!0,!1),t[r]=Dn(r,!1,!0),s[r]=Dn(r,!0,!0)}),[e,i,t,s]}const[mp,gp,_p,xp]=pp();function ch(e,t){const i=t?e?xp:_p:e?gp:mp;return(s,n,r)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?s:Reflect.get(pt(i,n)&&n in s?i:s,n,r)}const yp={get:ch(!1,!1)},vp={get:ch(!1,!0)},wp={get:ch(!0,!1)},cu=new WeakMap,uu=new WeakMap,du=new WeakMap,bp=new WeakMap;function Tp(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ep(e){return e.__v_skip||!Object.isExtensible(e)?0:Tp(Uf(e))}function uh(e){return ys(e)?e:dh(e,!1,lu,yp,cu)}function Ap(e){return dh(e,!1,fp,vp,uu)}function fu(e){return dh(e,!0,dp,wp,du)}function dh(e,t,i,s,n){if(!Ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=n.get(e);if(r)return r;const o=Ep(e);if(o===0)return e;const a=new Proxy(e,o===2?s:i);return n.set(e,a),a}function ls(e){return ys(e)?ls(e.__v_raw):!!(e&&e.__v_isReactive)}function ys(e){return!!(e&&e.__v_isReadonly)}function xr(e){return!!(e&&e.__v_isShallow)}function pu(e){return ls(e)||ys(e)}function gt(e){const t=e&&e.__v_raw;return t?gt(t):e}function fh(e){return _r(e,"__v_skip",!0),e}const rn=e=>Ot(e)?uh(e):e,ph=e=>Ot(e)?fu(e):e;function mu(e){_i&&we&&(e=gt(e),ou(e.dep||(e.dep=oh())))}function gu(e,t){e=gt(e);const i=e.dep;i&&na(i)}function Yt(e){return!!(e&&e.__v_isRef===!0)}function ra(e){return Sp(e,!1)}function Sp(e,t){return Yt(e)?e:new Cp(e,t)}class Cp{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:gt(t),this._value=i?t:rn(t)}get value(){return mu(this),this._value}set value(t){const i=this.__v_isShallow||xr(t)||ys(t);t=i?t:gt(t),nn(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:rn(t),gu(this))}}function Ip(e){return Yt(e)?e.value:e}const Pp={get:(e,t,i)=>Ip(Reflect.get(e,t,i)),set:(e,t,i,s)=>{const n=e[t];return Yt(n)&&!Yt(i)?(n.value=i,!0):Reflect.set(e,t,i,s)}};function _u(e){return ls(e)?e:new Proxy(e,Pp)}class Mp{constructor(t,i,s,n){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new ah(t,()=>{this._dirty||(this._dirty=!0,gu(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=s}get value(){const t=gt(this);return mu(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Rp(e,t,i=!1){let s,n;const r=ut(e);return r?(s=e,n=Se):(s=e.get,n=e.set),new Mp(s,n,r||!n,i)}function xi(e,t,i,s){let n;try{n=s?e(...s):e()}catch(r){zr(r,t,i)}return n}function Ce(e,t,i,s){if(ut(e)){const r=xi(e,t,i,s);return r&&Qc(r)&&r.catch(o=>{zr(o,t,i)}),r}const n=[];for(let r=0;r<e.length;r++)n.push(Ce(e[r],t,i,s));return n}function zr(e,t,i,s=!0){const n=t?t.vnode:null;if(t){let r=t.parent;const o=t.proxy,a=i;for(;r;){const l=r.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](e,o,a)===!1)return}r=r.parent}const h=t.appContext.config.errorHandler;if(h){xi(h,null,10,[e,o,a]);return}}Dp(e,i,n,s)}function Dp(e,t,i,s=!0){console.error(e)}let on=!1,oa=!1;const jt=[];let He=0;const cs=[];let Je=null,Bi=0;const xu=Promise.resolve();let mh=null;function Bp(e){const t=mh||xu;return e?t.then(this?e.bind(this):e):t}function Fp(e){let t=He+1,i=jt.length;for(;t<i;){const s=t+i>>>1;an(jt[s])<e?t=s+1:i=s}return t}function gh(e){(!jt.length||!jt.includes(e,on&&e.allowRecurse?He+1:He))&&(e.id==null?jt.push(e):jt.splice(Fp(e.id),0,e),yu())}function yu(){!on&&!oa&&(oa=!0,mh=xu.then(wu))}function Np(e){const t=jt.indexOf(e);t>He&&jt.splice(t,1)}function Op(e){ct(e)?cs.push(...e):(!Je||!Je.includes(e,e.allowRecurse?Bi+1:Bi))&&cs.push(e),yu()}function el(e,t=on?He+1:0){for(;t<jt.length;t++){const i=jt[t];i&&i.pre&&(jt.splice(t,1),t--,i())}}function vu(e){if(cs.length){const t=[...new Set(cs)];if(cs.length=0,Je){Je.push(...t);return}for(Je=t,Je.sort((i,s)=>an(i)-an(s)),Bi=0;Bi<Je.length;Bi++)Je[Bi]();Je=null,Bi=0}}const an=e=>e.id==null?1/0:e.id,Lp=(e,t)=>{const i=an(e)-an(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function wu(e){oa=!1,on=!0,jt.sort(Lp);const t=Se;try{for(He=0;He<jt.length;He++){const i=jt[He];i&&i.active!==!1&&xi(i,null,14)}}finally{He=0,jt.length=0,vu(),on=!1,mh=null,(jt.length||cs.length)&&wu()}}function kp(e,t,...i){if(e.isUnmounted)return;const s=e.vnode.props||Tt;let n=i;const r=t.startsWith("update:"),o=r&&t.slice(7);if(o&&o in s){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:d}=s[c]||Tt;d&&(n=i.map(f=>Vt(f)?f.trim():f)),u&&(n=i.map(Xf))}let a,h=s[a=go(t)]||s[a=go(xs(t))];!h&&r&&(h=s[a=go(Cs(t))]),h&&Ce(h,e,6,n);const l=s[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Ce(l,e,6,n)}}function bu(e,t,i=!1){const s=t.emitsCache,n=s.get(e);if(n!==void 0)return n;const r=e.emits;let o={},a=!1;if(!ut(e)){const h=l=>{const c=bu(l,t,!0);c&&(a=!0,Ht(o,c))};!i&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!r&&!a?(Ot(e)&&s.set(e,null),null):(ct(r)?r.forEach(h=>o[h]=null):Ht(o,r),Ot(e)&&s.set(e,o),o)}function Vr(e,t){return!e||!Gr(t)?!1:(t=t.slice(2).replace(/Once$/,""),pt(e,t[0].toLowerCase()+t.slice(1))||pt(e,Cs(t))||pt(e,t))}let Te=null,Tu=null;function yr(e){const t=Te;return Te=e,Tu=e&&e.type.__scopeId||null,t}function Up(e,t=Te,i){if(!t||e._n)return e;const s=(...n)=>{s._d&&ul(-1);const r=yr(t);let o;try{o=e(...n)}finally{yr(r),s._d&&ul(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function xo(e){const{type:t,vnode:i,proxy:s,withProxy:n,props:r,propsOptions:[o],slots:a,attrs:h,emit:l,render:c,renderCache:u,data:d,setupState:f,ctx:p,inheritAttrs:m}=e;let g,y;const v=yr(e);try{if(i.shapeFlag&4){const x=n||s;g=Le(c.call(x,x,u,r,f,d,p)),y=h}else{const x=t;g=Le(x.length>1?x(r,{attrs:h,slots:a,emit:l}):x(r,null)),y=t.props?h:Hp(h)}}catch(x){tn.length=0,zr(x,e,1),g=yi(hn)}let _=g;if(y&&m!==!1){const x=Object.keys(y),{shapeFlag:A}=_;x.length&&A&7&&(o&&x.some(th)&&(y=Gp(y,o)),_=vs(_,y))}return i.dirs&&(_=vs(_),_.dirs=_.dirs?_.dirs.concat(i.dirs):i.dirs),i.transition&&(_.transition=i.transition),g=_,yr(v),g}const Hp=e=>{let t;for(const i in e)(i==="class"||i==="style"||Gr(i))&&((t||(t={}))[i]=e[i]);return t},Gp=(e,t)=>{const i={};for(const s in e)(!th(s)||!(s.slice(9)in t))&&(i[s]=e[s]);return i};function Wp(e,t,i){const{props:s,children:n,component:r}=e,{props:o,children:a,patchFlag:h}=t,l=r.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&h>=0){if(h&1024)return!0;if(h&16)return s?il(s,o,l):!!o;if(h&8){const c=t.dynamicProps;for(let u=0;u<c.length;u++){const d=c[u];if(o[d]!==s[d]&&!Vr(l,d))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?il(s,o,l):!0:!!o;return!1}function il(e,t,i){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let n=0;n<s.length;n++){const r=s[n];if(t[r]!==e[r]&&!Vr(i,r))return!0}return!1}function Xp({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const $p=e=>e.__isSuspense;function zp(e,t){t&&t.pendingBranch?ct(e)?t.effects.push(...e):t.effects.push(e):Op(e)}const Bn={};function yo(e,t,i){return Eu(e,t,i)}function Eu(e,t,{immediate:i,deep:s,flush:n,onTrack:r,onTrigger:o}=Tt){var a;const h=Jf()===((a=Xt)==null?void 0:a.scope)?Xt:null;let l,c=!1,u=!1;if(Yt(e)?(l=()=>e.value,c=xr(e)):ls(e)?(l=()=>e,s=!0):ct(e)?(u=!0,c=e.some(x=>ls(x)||xr(x)),l=()=>e.map(x=>{if(Yt(x))return x.value;if(ls(x))return rs(x);if(ut(x))return xi(x,h,2)})):ut(e)?t?l=()=>xi(e,h,2):l=()=>{if(!(h&&h.isUnmounted))return d&&d(),Ce(e,h,3,[f])}:l=Se,t&&s){const x=l;l=()=>rs(x())}let d,f=x=>{d=v.onStop=()=>{xi(x,h,4)}},p;if(cn)if(f=Se,t?i&&Ce(t,h,3,[l(),u?[]:void 0,f]):l(),n==="sync"){const x=Hm();p=x.__watcherHandles||(x.__watcherHandles=[])}else return Se;let m=u?new Array(e.length).fill(Bn):Bn;const g=()=>{if(v.active)if(t){const x=v.run();(s||c||(u?x.some((A,T)=>nn(A,m[T])):nn(x,m)))&&(d&&d(),Ce(t,h,3,[x,m===Bn?void 0:u&&m[0]===Bn?[]:m,f]),m=x)}else v.run()};g.allowRecurse=!!t;let y;n==="sync"?y=g:n==="post"?y=()=>Qt(g,h&&h.suspense):(g.pre=!0,h&&(g.id=h.uid),y=()=>gh(g));const v=new ah(l,y);t?i?g():m=v.run():n==="post"?Qt(v.run.bind(v),h&&h.suspense):v.run();const _=()=>{v.stop(),h&&h.scope&&eh(h.scope.effects,v)};return p&&p.push(_),_}function Vp(e,t,i){const s=this.proxy,n=Vt(e)?e.includes(".")?Au(s,e):()=>s[e]:e.bind(s,s);let r;ut(t)?r=t:(r=t.handler,i=t);const o=Xt;ws(this);const a=Eu(n,r.bind(s),i);return o?ws(o):ki(),a}function Au(e,t){const i=t.split(".");return()=>{let s=e;for(let n=0;n<i.length&&s;n++)s=s[i[n]];return s}}function rs(e,t){if(!Ot(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Yt(e))rs(e.value,t);else if(ct(e))for(let i=0;i<e.length;i++)rs(e[i],t);else if(Lf(e)||Js(e))e.forEach(i=>{rs(i,t)});else if(Hf(e))for(const i in e)rs(e[i],t);return e}function Ai(e,t,i,s){const n=e.dirs,r=t&&t.dirs;for(let o=0;o<n.length;o++){const a=n[o];r&&(a.oldValue=r[o].value);let h=a.dir[s];h&&(Is(),Ce(h,i,8,[e.el,a,e,t]),Ps())}}function _h(e,t){return ut(e)?(()=>Ht({name:e.name},t,{setup:e}))():e}const rr=e=>!!e.type.__asyncLoader,Su=e=>e.type.__isKeepAlive;function jp(e,t){Cu(e,"a",t)}function Yp(e,t){Cu(e,"da",t)}function Cu(e,t,i=Xt){const s=e.__wdc||(e.__wdc=()=>{let n=i;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(jr(t,s,i),i){let n=i.parent;for(;n&&n.parent;)Su(n.parent.vnode)&&Kp(s,t,i,n),n=n.parent}}function Kp(e,t,i,s){const n=jr(t,e,s,!0);Pu(()=>{eh(s[t],n)},i)}function jr(e,t,i=Xt,s=!1){if(i){const n=i[e]||(i[e]=[]),r=t.__weh||(t.__weh=(...o)=>{if(i.isUnmounted)return;Is(),ws(i);const a=Ce(t,i,e,o);return ki(),Ps(),a});return s?n.unshift(r):n.push(r),r}}const oi=e=>(t,i=Xt)=>(!cn||e==="sp")&&jr(e,(...s)=>t(...s),i),qp=oi("bm"),Iu=oi("m"),Zp=oi("bu"),Jp=oi("u"),Qp=oi("bum"),Pu=oi("um"),tm=oi("sp"),em=oi("rtg"),im=oi("rtc");function sm(e,t=Xt){jr("ec",e,t)}const nm=Symbol.for("v-ndc"),aa=e=>e?Wu(e)?Th(e)||e.proxy:aa(e.parent):null,Qs=Ht(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>aa(e.parent),$root:e=>aa(e.root),$emit:e=>e.emit,$options:e=>xh(e),$forceUpdate:e=>e.f||(e.f=()=>gh(e.update)),$nextTick:e=>e.n||(e.n=Bp.bind(e.proxy)),$watch:e=>Vp.bind(e)}),vo=(e,t)=>e!==Tt&&!e.__isScriptSetup&&pt(e,t),rm={get({_:e},t){const{ctx:i,setupState:s,data:n,props:r,accessCache:o,type:a,appContext:h}=e;let l;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return s[t];case 2:return n[t];case 4:return i[t];case 3:return r[t]}else{if(vo(s,t))return o[t]=1,s[t];if(n!==Tt&&pt(n,t))return o[t]=2,n[t];if((l=e.propsOptions[0])&&pt(l,t))return o[t]=3,r[t];if(i!==Tt&&pt(i,t))return o[t]=4,i[t];ha&&(o[t]=0)}}const c=Qs[t];let u,d;if(c)return t==="$attrs"&&ie(e,"get",t),c(e);if((u=a.__cssModules)&&(u=u[t]))return u;if(i!==Tt&&pt(i,t))return o[t]=4,i[t];if(d=h.config.globalProperties,pt(d,t))return d[t]},set({_:e},t,i){const{data:s,setupState:n,ctx:r}=e;return vo(n,t)?(n[t]=i,!0):s!==Tt&&pt(s,t)?(s[t]=i,!0):pt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:s,appContext:n,propsOptions:r}},o){let a;return!!i[o]||e!==Tt&&pt(e,o)||vo(t,o)||(a=r[0])&&pt(a,o)||pt(s,o)||pt(Qs,o)||pt(n.config.globalProperties,o)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:pt(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function sl(e){return ct(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let ha=!0;function om(e){const t=xh(e),i=e.proxy,s=e.ctx;ha=!1,t.beforeCreate&&nl(t.beforeCreate,e,"bc");const{data:n,computed:r,methods:o,watch:a,provide:h,inject:l,created:c,beforeMount:u,mounted:d,beforeUpdate:f,updated:p,activated:m,deactivated:g,beforeDestroy:y,beforeUnmount:v,destroyed:_,unmounted:x,render:A,renderTracked:T,renderTriggered:I,errorCaptured:S,serverPrefetch:G,expose:H,inheritAttrs:N,components:$,directives:D,filters:M}=t;if(l&&am(l,s,null),o)for(const O in o){const Z=o[O];ut(Z)&&(s[O]=Z.bind(i))}if(n){const O=n.call(i,i);Ot(O)&&(e.data=uh(O))}if(ha=!0,r)for(const O in r){const Z=r[O],_t=ut(Z)?Z.bind(i,i):ut(Z.get)?Z.get.bind(i,i):Se,B=!ut(Z)&&ut(Z.set)?Z.set.bind(i):Se,J=km({get:_t,set:B});Object.defineProperty(s,O,{enumerable:!0,configurable:!0,get:()=>J.value,set:rt=>J.value=rt})}if(a)for(const O in a)Mu(a[O],s,i,O);if(h){const O=ut(h)?h.call(i):h;Reflect.ownKeys(O).forEach(Z=>{fm(Z,O[Z])})}c&&nl(c,e,"c");function it(O,Z){ct(Z)?Z.forEach(_t=>O(_t.bind(i))):Z&&O(Z.bind(i))}if(it(qp,u),it(Iu,d),it(Zp,f),it(Jp,p),it(jp,m),it(Yp,g),it(sm,S),it(im,T),it(em,I),it(Qp,v),it(Pu,x),it(tm,G),ct(H))if(H.length){const O=e.exposed||(e.exposed={});H.forEach(Z=>{Object.defineProperty(O,Z,{get:()=>i[Z],set:_t=>i[Z]=_t})})}else e.exposed||(e.exposed={});A&&e.render===Se&&(e.render=A),N!=null&&(e.inheritAttrs=N),$&&(e.components=$),D&&(e.directives=D)}function am(e,t,i=Se){ct(e)&&(e=la(e));for(const s in e){const n=e[s];let r;Ot(n)?"default"in n?r=or(n.from||s,n.default,!0):r=or(n.from||s):r=or(n),Yt(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[s]=r}}function nl(e,t,i){Ce(ct(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,i)}function Mu(e,t,i,s){const n=s.includes(".")?Au(i,s):()=>i[s];if(Vt(e)){const r=t[e];ut(r)&&yo(n,r)}else if(ut(e))yo(n,e.bind(i));else if(Ot(e))if(ct(e))e.forEach(r=>Mu(r,t,i,s));else{const r=ut(e.handler)?e.handler.bind(i):t[e.handler];ut(r)&&yo(n,r,e)}}function xh(e){const t=e.type,{mixins:i,extends:s}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=e.appContext,a=r.get(t);let h;return a?h=a:!n.length&&!i&&!s?h=t:(h={},n.length&&n.forEach(l=>vr(h,l,o,!0)),vr(h,t,o)),Ot(t)&&r.set(t,h),h}function vr(e,t,i,s=!1){const{mixins:n,extends:r}=t;r&&vr(e,r,i,!0),n&&n.forEach(o=>vr(e,o,i,!0));for(const o in t)if(!(s&&o==="expose")){const a=hm[o]||i&&i[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const hm={data:rl,props:ol,emits:ol,methods:Xs,computed:Xs,beforeCreate:qt,created:qt,beforeMount:qt,mounted:qt,beforeUpdate:qt,updated:qt,beforeDestroy:qt,beforeUnmount:qt,destroyed:qt,unmounted:qt,activated:qt,deactivated:qt,errorCaptured:qt,serverPrefetch:qt,components:Xs,directives:Xs,watch:cm,provide:rl,inject:lm};function rl(e,t){return t?e?function(){return Ht(ut(e)?e.call(this,this):e,ut(t)?t.call(this,this):t)}:t:e}function lm(e,t){return Xs(la(e),la(t))}function la(e){if(ct(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function qt(e,t){return e?[...new Set([].concat(e,t))]:t}function Xs(e,t){return e?Ht(Object.create(null),e,t):t}function ol(e,t){return e?ct(e)&&ct(t)?[...new Set([...e,...t])]:Ht(Object.create(null),sl(e),sl(t??{})):t}function cm(e,t){if(!e)return t;if(!t)return e;const i=Ht(Object.create(null),e);for(const s in t)i[s]=qt(e[s],t[s]);return i}function Ru(){return{app:null,config:{isNativeTag:Ff,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let um=0;function dm(e,t){return function(s,n=null){ut(s)||(s=Ht({},s)),n!=null&&!Ot(n)&&(n=null);const r=Ru(),o=new Set;let a=!1;const h=r.app={_uid:um++,_component:s,_props:n,_container:null,_context:r,_instance:null,version:Gm,get config(){return r.config},set config(l){},use(l,...c){return o.has(l)||(l&&ut(l.install)?(o.add(l),l.install(h,...c)):ut(l)&&(o.add(l),l(h,...c))),h},mixin(l){return r.mixins.includes(l)||r.mixins.push(l),h},component(l,c){return c?(r.components[l]=c,h):r.components[l]},directive(l,c){return c?(r.directives[l]=c,h):r.directives[l]},mount(l,c,u){if(!a){const d=yi(s,n);return d.appContext=r,c&&t?t(d,l):e(d,l,u),a=!0,h._container=l,l.__vue_app__=h,Th(d.component)||d.component.proxy}},unmount(){a&&(e(null,h._container),delete h._container.__vue_app__)},provide(l,c){return r.provides[l]=c,h},runWithContext(l){wr=h;try{return l()}finally{wr=null}}};return h}}let wr=null;function fm(e,t){if(Xt){let i=Xt.provides;const s=Xt.parent&&Xt.parent.provides;s===i&&(i=Xt.provides=Object.create(s)),i[e]=t}}function or(e,t,i=!1){const s=Xt||Te;if(s||wr){const n=s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:wr._context.provides;if(n&&e in n)return n[e];if(arguments.length>1)return i&&ut(t)?t.call(s&&s.proxy):t}}function pm(e,t,i,s=!1){const n={},r={};_r(r,Kr,1),e.propsDefaults=Object.create(null),Du(e,t,n,r);for(const o in e.propsOptions[0])o in n||(n[o]=void 0);i?e.props=s?n:Ap(n):e.type.props?e.props=n:e.props=r,e.attrs=r}function mm(e,t,i,s){const{props:n,attrs:r,vnode:{patchFlag:o}}=e,a=gt(n),[h]=e.propsOptions;let l=!1;if((s||o>0)&&!(o&16)){if(o&8){const c=e.vnode.dynamicProps;for(let u=0;u<c.length;u++){let d=c[u];if(Vr(e.emitsOptions,d))continue;const f=t[d];if(h)if(pt(r,d))f!==r[d]&&(r[d]=f,l=!0);else{const p=xs(d);n[p]=ca(h,a,p,f,e,!1)}else f!==r[d]&&(r[d]=f,l=!0)}}}else{Du(e,t,n,r)&&(l=!0);let c;for(const u in a)(!t||!pt(t,u)&&((c=Cs(u))===u||!pt(t,c)))&&(h?i&&(i[u]!==void 0||i[c]!==void 0)&&(n[u]=ca(h,a,u,void 0,e,!0)):delete n[u]);if(r!==a)for(const u in r)(!t||!pt(t,u))&&(delete r[u],l=!0)}l&&si(e,"set","$attrs")}function Du(e,t,i,s){const[n,r]=e.propsOptions;let o=!1,a;if(t)for(let h in t){if(nr(h))continue;const l=t[h];let c;n&&pt(n,c=xs(h))?!r||!r.includes(c)?i[c]=l:(a||(a={}))[c]=l:Vr(e.emitsOptions,h)||(!(h in s)||l!==s[h])&&(s[h]=l,o=!0)}if(r){const h=gt(i),l=a||Tt;for(let c=0;c<r.length;c++){const u=r[c];i[u]=ca(n,h,u,l[u],e,!pt(l,u))}}return o}function ca(e,t,i,s,n,r){const o=e[i];if(o!=null){const a=pt(o,"default");if(a&&s===void 0){const h=o.default;if(o.type!==Function&&!o.skipFactory&&ut(h)){const{propsDefaults:l}=n;i in l?s=l[i]:(ws(n),s=l[i]=h.call(null,t),ki())}else s=h}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===Cs(i))&&(s=!0))}return s}function Bu(e,t,i=!1){const s=t.propsCache,n=s.get(e);if(n)return n;const r=e.props,o={},a=[];let h=!1;if(!ut(e)){const c=u=>{h=!0;const[d,f]=Bu(u,t,!0);Ht(o,d),f&&a.push(...f)};!i&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!r&&!h)return Ot(e)&&s.set(e,hs),hs;if(ct(r))for(let c=0;c<r.length;c++){const u=xs(r[c]);al(u)&&(o[u]=Tt)}else if(r)for(const c in r){const u=xs(c);if(al(u)){const d=r[c],f=o[u]=ct(d)||ut(d)?{type:d}:Ht({},d);if(f){const p=cl(Boolean,f.type),m=cl(String,f.type);f[0]=p>-1,f[1]=m<0||p<m,(p>-1||pt(f,"default"))&&a.push(u)}}}const l=[o,a];return Ot(e)&&s.set(e,l),l}function al(e){return e[0]!=="$"}function hl(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function ll(e,t){return hl(e)===hl(t)}function cl(e,t){return ct(t)?t.findIndex(i=>ll(i,e)):ut(t)&&ll(t,e)?0:-1}const Fu=e=>e[0]==="_"||e==="$stable",yh=e=>ct(e)?e.map(Le):[Le(e)],gm=(e,t,i)=>{if(t._n)return t;const s=Up((...n)=>yh(t(...n)),i);return s._c=!1,s},Nu=(e,t,i)=>{const s=e._ctx;for(const n in e){if(Fu(n))continue;const r=e[n];if(ut(r))t[n]=gm(n,r,s);else if(r!=null){const o=yh(r);t[n]=()=>o}}},Ou=(e,t)=>{const i=yh(t);e.slots.default=()=>i},_m=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=gt(t),_r(t,"_",i)):Nu(t,e.slots={})}else e.slots={},t&&Ou(e,t);_r(e.slots,Kr,1)},xm=(e,t,i)=>{const{vnode:s,slots:n}=e;let r=!0,o=Tt;if(s.shapeFlag&32){const a=t._;a?i&&a===1?r=!1:(Ht(n,t),!i&&a===1&&delete n._):(r=!t.$stable,Nu(t,n)),o=t}else t&&(Ou(e,t),o={default:1});if(r)for(const a in n)!Fu(a)&&!(a in o)&&delete n[a]};function ua(e,t,i,s,n=!1){if(ct(e)){e.forEach((d,f)=>ua(d,t&&(ct(t)?t[f]:t),i,s,n));return}if(rr(s)&&!n)return;const r=s.shapeFlag&4?Th(s.component)||s.component.proxy:s.el,o=n?null:r,{i:a,r:h}=e,l=t&&t.r,c=a.refs===Tt?a.refs={}:a.refs,u=a.setupState;if(l!=null&&l!==h&&(Vt(l)?(c[l]=null,pt(u,l)&&(u[l]=null)):Yt(l)&&(l.value=null)),ut(h))xi(h,a,12,[o,c]);else{const d=Vt(h),f=Yt(h);if(d||f){const p=()=>{if(e.f){const m=d?pt(u,h)?u[h]:c[h]:h.value;n?ct(m)&&eh(m,r):ct(m)?m.includes(r)||m.push(r):d?(c[h]=[r],pt(u,h)&&(u[h]=c[h])):(h.value=[r],e.k&&(c[e.k]=h.value))}else d?(c[h]=o,pt(u,h)&&(u[h]=o)):f&&(h.value=o,e.k&&(c[e.k]=o))};o?(p.id=-1,Qt(p,i)):p()}}}const Qt=zp;function ym(e){return vm(e)}function vm(e,t){const i=ta();i.__VUE__=!0;const{insert:s,remove:n,patchProp:r,createElement:o,createText:a,createComment:h,setText:l,setElementText:c,parentNode:u,nextSibling:d,setScopeId:f=Se,insertStaticContent:p}=e,m=(w,b,E,P=null,R=null,L=null,X=!1,k=null,W=!!b.dynamicChildren)=>{if(w===b)return;w&&!Bs(w,b)&&(P=St(w),rt(w,R,L,!0),w=null),b.patchFlag===-2&&(W=!1,b.dynamicChildren=null);const{type:F,ref:Q,shapeFlag:j}=b;switch(F){case Yr:g(w,b,E,P);break;case hn:y(w,b,E,P);break;case wo:w==null&&v(b,E,P,X);break;case Qe:$(w,b,E,P,R,L,X,k,W);break;default:j&1?A(w,b,E,P,R,L,X,k,W):j&6?D(w,b,E,P,R,L,X,k,W):(j&64||j&128)&&F.process(w,b,E,P,R,L,X,k,W,Bt)}Q!=null&&R&&ua(Q,w&&w.ref,L,b||w,!b)},g=(w,b,E,P)=>{if(w==null)s(b.el=a(b.children),E,P);else{const R=b.el=w.el;b.children!==w.children&&l(R,b.children)}},y=(w,b,E,P)=>{w==null?s(b.el=h(b.children||""),E,P):b.el=w.el},v=(w,b,E,P)=>{[w.el,w.anchor]=p(w.children,b,E,P,w.el,w.anchor)},_=({el:w,anchor:b},E,P)=>{let R;for(;w&&w!==b;)R=d(w),s(w,E,P),w=R;s(b,E,P)},x=({el:w,anchor:b})=>{let E;for(;w&&w!==b;)E=d(w),n(w),w=E;n(b)},A=(w,b,E,P,R,L,X,k,W)=>{X=X||b.type==="svg",w==null?T(b,E,P,R,L,X,k,W):G(w,b,R,L,X,k,W)},T=(w,b,E,P,R,L,X,k)=>{let W,F;const{type:Q,props:j,shapeFlag:tt,transition:ot,dirs:dt}=w;if(W=w.el=o(w.type,L,j&&j.is,j),tt&8?c(W,w.children):tt&16&&S(w.children,W,null,P,R,L&&Q!=="foreignObject",X,k),dt&&Ai(w,null,P,"created"),I(W,w,w.scopeId,X,P),j){for(const wt in j)wt!=="value"&&!nr(wt)&&r(W,wt,null,j[wt],L,w.children,P,R,xt);"value"in j&&r(W,"value",null,j.value),(F=j.onVnodeBeforeMount)&&Fe(F,P,w)}dt&&Ai(w,null,P,"beforeMount");const Et=(!R||R&&!R.pendingBranch)&&ot&&!ot.persisted;Et&&ot.beforeEnter(W),s(W,b,E),((F=j&&j.onVnodeMounted)||Et||dt)&&Qt(()=>{F&&Fe(F,P,w),Et&&ot.enter(W),dt&&Ai(w,null,P,"mounted")},R)},I=(w,b,E,P,R)=>{if(E&&f(w,E),P)for(let L=0;L<P.length;L++)f(w,P[L]);if(R){let L=R.subTree;if(b===L){const X=R.vnode;I(w,X,X.scopeId,X.slotScopeIds,R.parent)}}},S=(w,b,E,P,R,L,X,k,W=0)=>{for(let F=W;F<w.length;F++){const Q=w[F]=k?ui(w[F]):Le(w[F]);m(null,Q,b,E,P,R,L,X,k)}},G=(w,b,E,P,R,L,X)=>{const k=b.el=w.el;let{patchFlag:W,dynamicChildren:F,dirs:Q}=b;W|=w.patchFlag&16;const j=w.props||Tt,tt=b.props||Tt;let ot;E&&Si(E,!1),(ot=tt.onVnodeBeforeUpdate)&&Fe(ot,E,b,w),Q&&Ai(b,w,E,"beforeUpdate"),E&&Si(E,!0);const dt=R&&b.type!=="foreignObject";if(F?H(w.dynamicChildren,F,k,E,P,dt,L):X||Z(w,b,k,null,E,P,dt,L,!1),W>0){if(W&16)N(k,b,j,tt,E,P,R);else if(W&2&&j.class!==tt.class&&r(k,"class",null,tt.class,R),W&4&&r(k,"style",j.style,tt.style,R),W&8){const Et=b.dynamicProps;for(let wt=0;wt<Et.length;wt++){const Ft=Et[wt],ue=j[Ft],Ki=tt[Ft];(Ki!==ue||Ft==="value")&&r(k,Ft,ue,Ki,R,w.children,E,P,xt)}}W&1&&w.children!==b.children&&c(k,b.children)}else!X&&F==null&&N(k,b,j,tt,E,P,R);((ot=tt.onVnodeUpdated)||Q)&&Qt(()=>{ot&&Fe(ot,E,b,w),Q&&Ai(b,w,E,"updated")},P)},H=(w,b,E,P,R,L,X)=>{for(let k=0;k<b.length;k++){const W=w[k],F=b[k],Q=W.el&&(W.type===Qe||!Bs(W,F)||W.shapeFlag&70)?u(W.el):E;m(W,F,Q,null,P,R,L,X,!0)}},N=(w,b,E,P,R,L,X)=>{if(E!==P){if(E!==Tt)for(const k in E)!nr(k)&&!(k in P)&&r(w,k,E[k],null,X,b.children,R,L,xt);for(const k in P){if(nr(k))continue;const W=P[k],F=E[k];W!==F&&k!=="value"&&r(w,k,F,W,X,b.children,R,L,xt)}"value"in P&&r(w,"value",E.value,P.value)}},$=(w,b,E,P,R,L,X,k,W)=>{const F=b.el=w?w.el:a(""),Q=b.anchor=w?w.anchor:a("");let{patchFlag:j,dynamicChildren:tt,slotScopeIds:ot}=b;ot&&(k=k?k.concat(ot):ot),w==null?(s(F,E,P),s(Q,E,P),S(b.children,E,Q,R,L,X,k,W)):j>0&&j&64&&tt&&w.dynamicChildren?(H(w.dynamicChildren,tt,E,R,L,X,k),(b.key!=null||R&&b===R.subTree)&&Lu(w,b,!0)):Z(w,b,E,Q,R,L,X,k,W)},D=(w,b,E,P,R,L,X,k,W)=>{b.slotScopeIds=k,w==null?b.shapeFlag&512?R.ctx.activate(b,E,P,X,W):M(b,E,P,R,L,X,W):ht(w,b,W)},M=(w,b,E,P,R,L,X)=>{const k=w.component=Rm(w,P,R);if(Su(w)&&(k.ctx.renderer=Bt),Bm(k),k.asyncDep){if(R&&R.registerDep(k,it),!w.el){const W=k.subTree=yi(hn);y(null,W,b,E)}return}it(k,w,b,E,R,L,X)},ht=(w,b,E)=>{const P=b.component=w.component;if(Wp(w,b,E))if(P.asyncDep&&!P.asyncResolved){O(P,b,E);return}else P.next=b,Np(P.update),P.update();else b.el=w.el,P.vnode=b},it=(w,b,E,P,R,L,X)=>{const k=()=>{if(w.isMounted){let{next:Q,bu:j,u:tt,parent:ot,vnode:dt}=w,Et=Q,wt;Si(w,!1),Q?(Q.el=dt.el,O(w,Q,X)):Q=dt,j&&_o(j),(wt=Q.props&&Q.props.onVnodeBeforeUpdate)&&Fe(wt,ot,Q,dt),Si(w,!0);const Ft=xo(w),ue=w.subTree;w.subTree=Ft,m(ue,Ft,u(ue.el),St(ue),w,R,L),Q.el=Ft.el,Et===null&&Xp(w,Ft.el),tt&&Qt(tt,R),(wt=Q.props&&Q.props.onVnodeUpdated)&&Qt(()=>Fe(wt,ot,Q,dt),R)}else{let Q;const{el:j,props:tt}=b,{bm:ot,m:dt,parent:Et}=w,wt=rr(b);if(Si(w,!1),ot&&_o(ot),!wt&&(Q=tt&&tt.onVnodeBeforeMount)&&Fe(Q,Et,b),Si(w,!0),j&&vt){const Ft=()=>{w.subTree=xo(w),vt(j,w.subTree,w,R,null)};wt?b.type.__asyncLoader().then(()=>!w.isUnmounted&&Ft()):Ft()}else{const Ft=w.subTree=xo(w);m(null,Ft,E,P,w,R,L),b.el=Ft.el}if(dt&&Qt(dt,R),!wt&&(Q=tt&&tt.onVnodeMounted)){const Ft=b;Qt(()=>Fe(Q,Et,Ft),R)}(b.shapeFlag&256||Et&&rr(Et.vnode)&&Et.vnode.shapeFlag&256)&&w.a&&Qt(w.a,R),w.isMounted=!0,b=E=P=null}},W=w.effect=new ah(k,()=>gh(F),w.scope),F=w.update=()=>W.run();F.id=w.uid,Si(w,!0),F()},O=(w,b,E)=>{b.component=w;const P=w.vnode.props;w.vnode=b,w.next=null,mm(w,b.props,P,E),xm(w,b.children,E),Is(),el(),Ps()},Z=(w,b,E,P,R,L,X,k,W=!1)=>{const F=w&&w.children,Q=w?w.shapeFlag:0,j=b.children,{patchFlag:tt,shapeFlag:ot}=b;if(tt>0){if(tt&128){B(F,j,E,P,R,L,X,k,W);return}else if(tt&256){_t(F,j,E,P,R,L,X,k,W);return}}ot&8?(Q&16&&xt(F,R,L),j!==F&&c(E,j)):Q&16?ot&16?B(F,j,E,P,R,L,X,k,W):xt(F,R,L,!0):(Q&8&&c(E,""),ot&16&&S(j,E,P,R,L,X,k,W))},_t=(w,b,E,P,R,L,X,k,W)=>{w=w||hs,b=b||hs;const F=w.length,Q=b.length,j=Math.min(F,Q);let tt;for(tt=0;tt<j;tt++){const ot=b[tt]=W?ui(b[tt]):Le(b[tt]);m(w[tt],ot,E,null,R,L,X,k,W)}F>Q?xt(w,R,L,!0,!1,j):S(b,E,P,R,L,X,k,W,j)},B=(w,b,E,P,R,L,X,k,W)=>{let F=0;const Q=b.length;let j=w.length-1,tt=Q-1;for(;F<=j&&F<=tt;){const ot=w[F],dt=b[F]=W?ui(b[F]):Le(b[F]);if(Bs(ot,dt))m(ot,dt,E,null,R,L,X,k,W);else break;F++}for(;F<=j&&F<=tt;){const ot=w[j],dt=b[tt]=W?ui(b[tt]):Le(b[tt]);if(Bs(ot,dt))m(ot,dt,E,null,R,L,X,k,W);else break;j--,tt--}if(F>j){if(F<=tt){const ot=tt+1,dt=ot<Q?b[ot].el:P;for(;F<=tt;)m(null,b[F]=W?ui(b[F]):Le(b[F]),E,dt,R,L,X,k,W),F++}}else if(F>tt)for(;F<=j;)rt(w[F],R,L,!0),F++;else{const ot=F,dt=F,Et=new Map;for(F=dt;F<=tt;F++){const se=b[F]=W?ui(b[F]):Le(b[F]);se.key!=null&&Et.set(se.key,F)}let wt,Ft=0;const ue=tt-dt+1;let Ki=!1,$h=0;const Ds=new Array(ue);for(F=0;F<ue;F++)Ds[F]=0;for(F=ot;F<=j;F++){const se=w[F];if(Ft>=ue){rt(se,R,L,!0);continue}let Be;if(se.key!=null)Be=Et.get(se.key);else for(wt=dt;wt<=tt;wt++)if(Ds[wt-dt]===0&&Bs(se,b[wt])){Be=wt;break}Be===void 0?rt(se,R,L,!0):(Ds[Be-dt]=F+1,Be>=$h?$h=Be:Ki=!0,m(se,b[Be],E,null,R,L,X,k,W),Ft++)}const zh=Ki?wm(Ds):hs;for(wt=zh.length-1,F=ue-1;F>=0;F--){const se=dt+F,Be=b[se],Vh=se+1<Q?b[se+1].el:P;Ds[F]===0?m(null,Be,E,Vh,R,L,X,k,W):Ki&&(wt<0||F!==zh[wt]?J(Be,E,Vh,2):wt--)}}},J=(w,b,E,P,R=null)=>{const{el:L,type:X,transition:k,children:W,shapeFlag:F}=w;if(F&6){J(w.component.subTree,b,E,P);return}if(F&128){w.suspense.move(b,E,P);return}if(F&64){X.move(w,b,E,Bt);return}if(X===Qe){s(L,b,E);for(let j=0;j<W.length;j++)J(W[j],b,E,P);s(w.anchor,b,E);return}if(X===wo){_(w,b,E);return}if(P!==2&&F&1&&k)if(P===0)k.beforeEnter(L),s(L,b,E),Qt(()=>k.enter(L),R);else{const{leave:j,delayLeave:tt,afterLeave:ot}=k,dt=()=>s(L,b,E),Et=()=>{j(L,()=>{dt(),ot&&ot()})};tt?tt(L,dt,Et):Et()}else s(L,b,E)},rt=(w,b,E,P=!1,R=!1)=>{const{type:L,props:X,ref:k,children:W,dynamicChildren:F,shapeFlag:Q,patchFlag:j,dirs:tt}=w;if(k!=null&&ua(k,null,E,w,!0),Q&256){b.ctx.deactivate(w);return}const ot=Q&1&&tt,dt=!rr(w);let Et;if(dt&&(Et=X&&X.onVnodeBeforeUnmount)&&Fe(Et,b,w),Q&6)Dt(w.component,E,P);else{if(Q&128){w.suspense.unmount(E,P);return}ot&&Ai(w,null,b,"beforeUnmount"),Q&64?w.type.remove(w,b,E,R,Bt,P):F&&(L!==Qe||j>0&&j&64)?xt(F,b,E,!1,!0):(L===Qe&&j&384||!R&&Q&16)&&xt(W,b,E),P&&mt(w)}(dt&&(Et=X&&X.onVnodeUnmounted)||ot)&&Qt(()=>{Et&&Fe(Et,b,w),ot&&Ai(w,null,b,"unmounted")},E)},mt=w=>{const{type:b,el:E,anchor:P,transition:R}=w;if(b===Qe){yt(E,P);return}if(b===wo){x(w);return}const L=()=>{n(E),R&&!R.persisted&&R.afterLeave&&R.afterLeave()};if(w.shapeFlag&1&&R&&!R.persisted){const{leave:X,delayLeave:k}=R,W=()=>X(E,L);k?k(w.el,L,W):W()}else L()},yt=(w,b)=>{let E;for(;w!==b;)E=d(w),n(w),w=E;n(b)},Dt=(w,b,E)=>{const{bum:P,scope:R,update:L,subTree:X,um:k}=w;P&&_o(P),R.stop(),L&&(L.active=!1,rt(X,w,b,E)),k&&Qt(k,b),Qt(()=>{w.isUnmounted=!0},b),b&&b.pendingBranch&&!b.isUnmounted&&w.asyncDep&&!w.asyncResolved&&w.suspenseId===b.pendingId&&(b.deps--,b.deps===0&&b.resolve())},xt=(w,b,E,P=!1,R=!1,L=0)=>{for(let X=L;X<w.length;X++)rt(w[X],b,E,P,R)},St=w=>w.shapeFlag&6?St(w.component.subTree):w.shapeFlag&128?w.suspense.next():d(w.anchor||w.el),Lt=(w,b,E)=>{w==null?b._vnode&&rt(b._vnode,null,null,!0):m(b._vnode||null,w,b,null,null,null,E),el(),vu(),b._vnode=w},Bt={p:m,um:rt,m:J,r:mt,mt:M,mc:S,pc:Z,pbc:H,n:St,o:e};let Mt,vt;return t&&([Mt,vt]=t(Bt)),{render:Lt,hydrate:Mt,createApp:dm(Lt,Mt)}}function Si({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function Lu(e,t,i=!1){const s=e.children,n=t.children;if(ct(s)&&ct(n))for(let r=0;r<s.length;r++){const o=s[r];let a=n[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[r]=ui(n[r]),a.el=o.el),i||Lu(o,a)),a.type===Yr&&(a.el=o.el)}}function wm(e){const t=e.slice(),i=[0];let s,n,r,o,a;const h=e.length;for(s=0;s<h;s++){const l=e[s];if(l!==0){if(n=i[i.length-1],e[n]<l){t[s]=n,i.push(s);continue}for(r=0,o=i.length-1;r<o;)a=r+o>>1,e[i[a]]<l?r=a+1:o=a;l<e[i[r]]&&(r>0&&(t[s]=i[r-1]),i[r]=s)}}for(r=i.length,o=i[r-1];r-- >0;)i[r]=o,o=t[o];return i}const bm=e=>e.__isTeleport,Qe=Symbol.for("v-fgt"),Yr=Symbol.for("v-txt"),hn=Symbol.for("v-cmt"),wo=Symbol.for("v-stc"),tn=[];let Ee=null;function ku(e=!1){tn.push(Ee=e?null:[])}function Tm(){tn.pop(),Ee=tn[tn.length-1]||null}let ln=1;function ul(e){ln+=e}function Em(e){return e.dynamicChildren=ln>0?Ee||hs:null,Tm(),ln>0&&Ee&&Ee.push(e),e}function Uu(e,t,i,s,n,r){return Em(vh(e,t,i,s,n,r,!0))}function Am(e){return e?e.__v_isVNode===!0:!1}function Bs(e,t){return e.type===t.type&&e.key===t.key}const Kr="__vInternal",Hu=({key:e})=>e??null,ar=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Vt(e)||Yt(e)||ut(e)?{i:Te,r:e,k:t,f:!!i}:e:null);function vh(e,t=null,i=null,s=0,n=null,r=e===Qe?0:1,o=!1,a=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Hu(t),ref:t&&ar(t),scopeId:Tu,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Te};return a?(wh(h,i),r&128&&e.normalize(h)):i&&(h.shapeFlag|=Vt(i)?8:16),ln>0&&!o&&Ee&&(h.patchFlag>0||r&6)&&h.patchFlag!==32&&Ee.push(h),h}const yi=Sm;function Sm(e,t=null,i=null,s=0,n=null,r=!1){if((!e||e===nm)&&(e=hn),Am(e)){const a=vs(e,t,!0);return i&&wh(a,i),ln>0&&!r&&Ee&&(a.shapeFlag&6?Ee[Ee.indexOf(e)]=a:Ee.push(a)),a.patchFlag|=-2,a}if(Lm(e)&&(e=e.__vccOpts),t){t=Cm(t);let{class:a,style:h}=t;a&&!Vt(a)&&(t.class=rh(a)),Ot(h)&&(pu(h)&&!ct(h)&&(h=Ht({},h)),t.style=nh(h))}const o=Vt(e)?1:$p(e)?128:bm(e)?64:Ot(e)?4:ut(e)?2:0;return vh(e,t,i,s,n,o,r,!0)}function Cm(e){return e?pu(e)||Kr in e?Ht({},e):e:null}function vs(e,t,i=!1){const{props:s,ref:n,patchFlag:r,children:o}=e,a=t?Im(s||{},t):s;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Hu(a),ref:t&&t.ref?i&&n?ct(n)?n.concat(ar(t)):[n,ar(t)]:ar(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Qe?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&vs(e.ssContent),ssFallback:e.ssFallback&&vs(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Gu(e=" ",t=0){return yi(Yr,null,e,t)}function Le(e){return e==null||typeof e=="boolean"?yi(hn):ct(e)?yi(Qe,null,e.slice()):typeof e=="object"?ui(e):yi(Yr,null,String(e))}function ui(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:vs(e)}function wh(e,t){let i=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(ct(t))i=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),wh(e,n()),n._c&&(n._d=!0));return}else{i=32;const n=t._;!n&&!(Kr in t)?t._ctx=Te:n===3&&Te&&(Te.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ut(t)?(t={default:t,_ctx:Te},i=32):(t=String(t),s&64?(i=16,t=[Gu(t)]):i=8);e.children=t,e.shapeFlag|=i}function Im(...e){const t={};for(let i=0;i<e.length;i++){const s=e[i];for(const n in s)if(n==="class")t.class!==s.class&&(t.class=rh([t.class,s.class]));else if(n==="style")t.style=nh([t.style,s.style]);else if(Gr(n)){const r=t[n],o=s[n];o&&r!==o&&!(ct(r)&&r.includes(o))&&(t[n]=r?[].concat(r,o):o)}else n!==""&&(t[n]=s[n])}return t}function Fe(e,t,i,s=null){Ce(e,t,7,[i,s])}const Pm=Ru();let Mm=0;function Rm(e,t,i){const s=e.type,n=(t?t.appContext:e.appContext)||Pm,r={uid:Mm++,vnode:e,type:s,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new iu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Bu(s,n),emitsOptions:bu(s,n),emit:null,emitted:null,propsDefaults:Tt,inheritAttrs:s.inheritAttrs,ctx:Tt,data:Tt,props:Tt,attrs:Tt,slots:Tt,refs:Tt,setupState:Tt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=kp.bind(null,r),e.ce&&e.ce(r),r}let Xt=null;const Dm=()=>Xt||Te;let bh,qi,dl="__VUE_INSTANCE_SETTERS__";(qi=ta()[dl])||(qi=ta()[dl]=[]),qi.push(e=>Xt=e),bh=e=>{qi.length>1?qi.forEach(t=>t(e)):qi[0](e)};const ws=e=>{bh(e),e.scope.on()},ki=()=>{Xt&&Xt.scope.off(),bh(null)};function Wu(e){return e.vnode.shapeFlag&4}let cn=!1;function Bm(e,t=!1){cn=t;const{props:i,children:s}=e.vnode,n=Wu(e);pm(e,i,n,t),_m(e,s);const r=n?Fm(e,t):void 0;return cn=!1,r}function Fm(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=fh(new Proxy(e.ctx,rm));const{setup:s}=i;if(s){const n=e.setupContext=s.length>1?Om(e):null;ws(e),Is();const r=xi(s,e,0,[e.props,n]);if(Ps(),ki(),Qc(r)){if(r.then(ki,ki),t)return r.then(o=>{fl(e,o,t)}).catch(o=>{zr(o,e,0)});e.asyncDep=r}else fl(e,r,t)}else Xu(e,t)}function fl(e,t,i){ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ot(t)&&(e.setupState=_u(t)),Xu(e,i)}let pl;function Xu(e,t,i){const s=e.type;if(!e.render){if(!t&&pl&&!s.render){const n=s.template||xh(e).template;if(n){const{isCustomElement:r,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:h}=s,l=Ht(Ht({isCustomElement:r,delimiters:a},o),h);s.render=pl(n,l)}}e.render=s.render||Se}ws(e),Is(),om(e),Ps(),ki()}function Nm(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,i){return ie(e,"get","$attrs"),t[i]}}))}function Om(e){const t=i=>{e.exposed=i||{}};return{get attrs(){return Nm(e)},slots:e.slots,emit:e.emit,expose:t}}function Th(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(_u(fh(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in Qs)return Qs[i](e)},has(t,i){return i in t||i in Qs}}))}function Lm(e){return ut(e)&&"__vccOpts"in e}const km=(e,t)=>Rp(e,t,cn),Um=Symbol.for("v-scx"),Hm=()=>or(Um),Gm="3.3.2",Wm="http://www.w3.org/2000/svg",Fi=typeof document<"u"?document:null,ml=Fi&&Fi.createElement("template"),Xm={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,s)=>{const n=t?Fi.createElementNS(Wm,e):Fi.createElement(e,i?{is:i}:void 0);return e==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:e=>Fi.createTextNode(e),createComment:e=>Fi.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Fi.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,s,n,r){const o=i?i.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),i),!(n===r||!(n=n.nextSibling)););else{ml.innerHTML=s?`<svg>${e}</svg>`:e;const a=ml.content;if(s){const h=a.firstChild;for(;h.firstChild;)a.appendChild(h.firstChild);a.removeChild(h)}t.insertBefore(a,i)}return[o?o.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function $m(e,t,i){const s=e._vtc;s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function zm(e,t,i){const s=e.style,n=Vt(i);if(i&&!n){if(t&&!Vt(t))for(const r in t)i[r]==null&&da(s,r,"");for(const r in i)da(s,r,i[r])}else{const r=s.display;n?t!==i&&(s.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(s.display=r)}}const gl=/\s*!important$/;function da(e,t,i){if(ct(i))i.forEach(s=>da(e,t,s));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const s=Vm(e,t);gl.test(i)?e.setProperty(Cs(s),i.replace(gl,""),"important"):e[s]=i}}const _l=["Webkit","Moz","ms"],bo={};function Vm(e,t){const i=bo[t];if(i)return i;let s=xs(t);if(s!=="filter"&&s in e)return bo[t]=s;s=tu(s);for(let n=0;n<_l.length;n++){const r=_l[n]+s;if(r in e)return bo[t]=r}return t}const xl="http://www.w3.org/1999/xlink";function jm(e,t,i,s,n){if(s&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(xl,t.slice(6,t.length)):e.setAttributeNS(xl,t,i);else{const r=Kf(t);i==null||r&&!eu(i)?e.removeAttribute(t):e.setAttribute(t,r?"":i)}}function Ym(e,t,i,s,n,r,o){if(t==="innerHTML"||t==="textContent"){s&&o(s,n,r),e[t]=i??"";return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){e._value=i;const l=a==="OPTION"?e.getAttribute("value"):e.value,c=i??"";l!==c&&(e.value=c),i==null&&e.removeAttribute(t);return}let h=!1;if(i===""||i==null){const l=typeof e[t];l==="boolean"?i=eu(i):i==null&&l==="string"?(i="",h=!0):l==="number"&&(i=0,h=!0)}try{e[t]=i}catch{}h&&e.removeAttribute(t)}function Km(e,t,i,s){e.addEventListener(t,i,s)}function qm(e,t,i,s){e.removeEventListener(t,i,s)}function Zm(e,t,i,s,n=null){const r=e._vei||(e._vei={}),o=r[t];if(s&&o)o.value=s;else{const[a,h]=Jm(t);if(s){const l=r[t]=eg(s,n);Km(e,a,l,h)}else o&&(qm(e,a,o,h),r[t]=void 0)}}const yl=/(?:Once|Passive|Capture)$/;function Jm(e){let t;if(yl.test(e)){t={};let s;for(;s=e.match(yl);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Cs(e.slice(2)),t]}let To=0;const Qm=Promise.resolve(),tg=()=>To||(Qm.then(()=>To=0),To=Date.now());function eg(e,t){const i=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=i.attached)return;Ce(ig(s,i.value),t,5,[s])};return i.value=e,i.attached=tg(),i}function ig(e,t){if(ct(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(s=>n=>!n._stopped&&s&&s(n))}else return t}const vl=/^on[a-z]/,sg=(e,t,i,s,n=!1,r,o,a,h)=>{t==="class"?$m(e,s,n):t==="style"?zm(e,i,s):Gr(t)?th(t)||Zm(e,t,i,s,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):ng(e,t,s,n))?Ym(e,t,s,r,o,a,h):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),jm(e,t,s,n))};function ng(e,t,i,s){return s?!!(t==="innerHTML"||t==="textContent"||t in e&&vl.test(t)&&ut(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||vl.test(t)&&Vt(i)?!1:t in e}function $u(e="$style"){{const t=Dm();if(!t)return Tt;const i=t.type.__cssModules;if(!i)return Tt;const s=i[e];return s||Tt}}const rg=Ht({patchProp:sg},Xm);let wl;function og(){return wl||(wl=ym(rg))}const ag=(...e)=>{const t=og().createApp(...e),{mount:i}=t;return t.mount=s=>{const n=hg(s);if(!n)return;const r=t._component;!ut(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.innerHTML="";const o=i(n,!1,n instanceof SVGElement);return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};function hg(e){return Vt(e)?document.querySelector(e):e}var lg=!1;/*!
  * pinia v2.0.36
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const cg=Symbol();var bl;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(bl||(bl={}));function ug(){const e=qf(!0),t=e.run(()=>ra({}));let i=[],s=[];const n=fh({install(r){n._a=r,r.provide(cg,n),r.config.globalProperties.$pinia=n,s.forEach(o=>i.push(o)),s=[]},use(r){return!this._a&&!lg?s.push(r):i.push(r),this},_p:i,_a:null,_e:e,_s:new Map,state:t});return n}var dg={value:()=>{}};function Eh(){for(var e=0,t=arguments.length,i={},s;e<t;++e){if(!(s=arguments[e]+"")||s in i||/[\s.]/.test(s))throw new Error("illegal type: "+s);i[s]=[]}return new hr(i)}function hr(e){this._=e}function fg(e,t){return e.trim().split(/^|\s+/).map(function(i){var s="",n=i.indexOf(".");if(n>=0&&(s=i.slice(n+1),i=i.slice(0,n)),i&&!t.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:s}})}hr.prototype=Eh.prototype={constructor:hr,on:function(e,t){var i=this._,s=fg(e+"",i),n,r=-1,o=s.length;if(arguments.length<2){for(;++r<o;)if((n=(e=s[r]).type)&&(n=pg(i[n],e.name)))return n;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++r<o;)if(n=(e=s[r]).type)i[n]=Tl(i[n],e.name,t);else if(t==null)for(n in i)i[n]=Tl(i[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var i in t)e[i]=t[i].slice();return new hr(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var i=new Array(n),s=0,n,r;s<n;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=this._[e],s=0,n=r.length;s<n;++s)r[s].value.apply(t,i)},apply:function(e,t,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],n=0,r=s.length;n<r;++n)s[n].value.apply(t,i)}};function pg(e,t){for(var i=0,s=e.length,n;i<s;++i)if((n=e[i]).name===t)return n.value}function Tl(e,t,i){for(var s=0,n=e.length;s<n;++s)if(e[s].name===t){e[s]=dg,e=e.slice(0,s).concat(e.slice(s+1));break}return i!=null&&e.push({name:t,value:i}),e}var fa="http://www.w3.org/1999/xhtml";const El={svg:"http://www.w3.org/2000/svg",xhtml:fa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qr(e){var t=e+="",i=t.indexOf(":");return i>=0&&(t=e.slice(0,i))!=="xmlns"&&(e=e.slice(i+1)),El.hasOwnProperty(t)?{space:El[t],local:e}:e}function mg(e){return function(){var t=this.ownerDocument,i=this.namespaceURI;return i===fa&&t.documentElement.namespaceURI===fa?t.createElement(e):t.createElementNS(i,e)}}function gg(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function zu(e){var t=qr(e);return(t.local?gg:mg)(t)}function _g(){}function Ah(e){return e==null?_g:function(){return this.querySelector(e)}}function xg(e){typeof e!="function"&&(e=Ah(e));for(var t=this._groups,i=t.length,s=new Array(i),n=0;n<i;++n)for(var r=t[n],o=r.length,a=s[n]=new Array(o),h,l,c=0;c<o;++c)(h=r[c])&&(l=e.call(h,h.__data__,c,r))&&("__data__"in h&&(l.__data__=h.__data__),a[c]=l);return new oe(s,this._parents)}function yg(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function vg(){return[]}function Vu(e){return e==null?vg:function(){return this.querySelectorAll(e)}}function wg(e){return function(){return yg(e.apply(this,arguments))}}function bg(e){typeof e=="function"?e=wg(e):e=Vu(e);for(var t=this._groups,i=t.length,s=[],n=[],r=0;r<i;++r)for(var o=t[r],a=o.length,h,l=0;l<a;++l)(h=o[l])&&(s.push(e.call(h,h.__data__,l,o)),n.push(h));return new oe(s,n)}function ju(e){return function(){return this.matches(e)}}function Yu(e){return function(t){return t.matches(e)}}var Tg=Array.prototype.find;function Eg(e){return function(){return Tg.call(this.children,e)}}function Ag(){return this.firstElementChild}function Sg(e){return this.select(e==null?Ag:Eg(typeof e=="function"?e:Yu(e)))}var Cg=Array.prototype.filter;function Ig(){return Array.from(this.children)}function Pg(e){return function(){return Cg.call(this.children,e)}}function Mg(e){return this.selectAll(e==null?Ig:Pg(typeof e=="function"?e:Yu(e)))}function Rg(e){typeof e!="function"&&(e=ju(e));for(var t=this._groups,i=t.length,s=new Array(i),n=0;n<i;++n)for(var r=t[n],o=r.length,a=s[n]=[],h,l=0;l<o;++l)(h=r[l])&&e.call(h,h.__data__,l,r)&&a.push(h);return new oe(s,this._parents)}function Ku(e){return new Array(e.length)}function Dg(){return new oe(this._enter||this._groups.map(Ku),this._parents)}function br(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}br.prototype={constructor:br,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Bg(e){return function(){return e}}function Fg(e,t,i,s,n,r){for(var o=0,a,h=t.length,l=r.length;o<l;++o)(a=t[o])?(a.__data__=r[o],s[o]=a):i[o]=new br(e,r[o]);for(;o<h;++o)(a=t[o])&&(n[o]=a)}function Ng(e,t,i,s,n,r,o){var a,h,l=new Map,c=t.length,u=r.length,d=new Array(c),f;for(a=0;a<c;++a)(h=t[a])&&(d[a]=f=o.call(h,h.__data__,a,t)+"",l.has(f)?n[a]=h:l.set(f,h));for(a=0;a<u;++a)f=o.call(e,r[a],a,r)+"",(h=l.get(f))?(s[a]=h,h.__data__=r[a],l.delete(f)):i[a]=new br(e,r[a]);for(a=0;a<c;++a)(h=t[a])&&l.get(d[a])===h&&(n[a]=h)}function Og(e){return e.__data__}function Lg(e,t){if(!arguments.length)return Array.from(this,Og);var i=t?Ng:Fg,s=this._parents,n=this._groups;typeof e!="function"&&(e=Bg(e));for(var r=n.length,o=new Array(r),a=new Array(r),h=new Array(r),l=0;l<r;++l){var c=s[l],u=n[l],d=u.length,f=kg(e.call(c,c&&c.__data__,l,s)),p=f.length,m=a[l]=new Array(p),g=o[l]=new Array(p),y=h[l]=new Array(d);i(c,u,m,g,y,f,t);for(var v=0,_=0,x,A;v<p;++v)if(x=m[v]){for(v>=_&&(_=v+1);!(A=g[_])&&++_<p;);x._next=A||null}}return o=new oe(o,s),o._enter=a,o._exit=h,o}function kg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ug(){return new oe(this._exit||this._groups.map(Ku),this._parents)}function Hg(e,t,i){var s=this.enter(),n=this,r=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(n=t(n),n&&(n=n.selection())),i==null?r.remove():i(r),s&&n?s.merge(n).order():n}function Gg(e){for(var t=e.selection?e.selection():e,i=this._groups,s=t._groups,n=i.length,r=s.length,o=Math.min(n,r),a=new Array(n),h=0;h<o;++h)for(var l=i[h],c=s[h],u=l.length,d=a[h]=new Array(u),f,p=0;p<u;++p)(f=l[p]||c[p])&&(d[p]=f);for(;h<n;++h)a[h]=i[h];return new oe(a,this._parents)}function Wg(){for(var e=this._groups,t=-1,i=e.length;++t<i;)for(var s=e[t],n=s.length-1,r=s[n],o;--n>=0;)(o=s[n])&&(r&&o.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(o,r),r=o);return this}function Xg(e){e||(e=$g);function t(u,d){return u&&d?e(u.__data__,d.__data__):!u-!d}for(var i=this._groups,s=i.length,n=new Array(s),r=0;r<s;++r){for(var o=i[r],a=o.length,h=n[r]=new Array(a),l,c=0;c<a;++c)(l=o[c])&&(h[c]=l);h.sort(t)}return new oe(n,this._parents).order()}function $g(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zg(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Vg(){return Array.from(this)}function jg(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var s=e[t],n=0,r=s.length;n<r;++n){var o=s[n];if(o)return o}return null}function Yg(){let e=0;for(const t of this)++e;return e}function Kg(){return!this.node()}function qg(e){for(var t=this._groups,i=0,s=t.length;i<s;++i)for(var n=t[i],r=0,o=n.length,a;r<o;++r)(a=n[r])&&e.call(a,a.__data__,r,n);return this}function Zg(e){return function(){this.removeAttribute(e)}}function Jg(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Qg(e,t){return function(){this.setAttribute(e,t)}}function t_(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function e_(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttribute(e):this.setAttribute(e,i)}}function i_(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}}function s_(e,t){var i=qr(e);if(arguments.length<2){var s=this.node();return i.local?s.getAttributeNS(i.space,i.local):s.getAttribute(i)}return this.each((t==null?i.local?Jg:Zg:typeof t=="function"?i.local?i_:e_:i.local?t_:Qg)(i,t))}function qu(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function n_(e){return function(){this.style.removeProperty(e)}}function r_(e,t,i){return function(){this.style.setProperty(e,t,i)}}function o_(e,t,i){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,i)}}function a_(e,t,i){return arguments.length>1?this.each((t==null?n_:typeof t=="function"?o_:r_)(e,t,i??"")):bs(this.node(),e)}function bs(e,t){return e.style.getPropertyValue(t)||qu(e).getComputedStyle(e,null).getPropertyValue(t)}function h_(e){return function(){delete this[e]}}function l_(e,t){return function(){this[e]=t}}function c_(e,t){return function(){var i=t.apply(this,arguments);i==null?delete this[e]:this[e]=i}}function u_(e,t){return arguments.length>1?this.each((t==null?h_:typeof t=="function"?c_:l_)(e,t)):this.node()[e]}function Zu(e){return e.trim().split(/^|\s+/)}function Sh(e){return e.classList||new Ju(e)}function Ju(e){this._node=e,this._names=Zu(e.getAttribute("class")||"")}Ju.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Qu(e,t){for(var i=Sh(e),s=-1,n=t.length;++s<n;)i.add(t[s])}function td(e,t){for(var i=Sh(e),s=-1,n=t.length;++s<n;)i.remove(t[s])}function d_(e){return function(){Qu(this,e)}}function f_(e){return function(){td(this,e)}}function p_(e,t){return function(){(t.apply(this,arguments)?Qu:td)(this,e)}}function m_(e,t){var i=Zu(e+"");if(arguments.length<2){for(var s=Sh(this.node()),n=-1,r=i.length;++n<r;)if(!s.contains(i[n]))return!1;return!0}return this.each((typeof t=="function"?p_:t?d_:f_)(i,t))}function g_(){this.textContent=""}function __(e){return function(){this.textContent=e}}function x_(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function y_(e){return arguments.length?this.each(e==null?g_:(typeof e=="function"?x_:__)(e)):this.node().textContent}function v_(){this.innerHTML=""}function w_(e){return function(){this.innerHTML=e}}function b_(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function T_(e){return arguments.length?this.each(e==null?v_:(typeof e=="function"?b_:w_)(e)):this.node().innerHTML}function E_(){this.nextSibling&&this.parentNode.appendChild(this)}function A_(){return this.each(E_)}function S_(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function C_(){return this.each(S_)}function I_(e){var t=typeof e=="function"?e:zu(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function P_(){return null}function M_(e,t){var i=typeof e=="function"?e:zu(e),s=t==null?P_:typeof t=="function"?t:Ah(t);return this.select(function(){return this.insertBefore(i.apply(this,arguments),s.apply(this,arguments)||null)})}function R_(){var e=this.parentNode;e&&e.removeChild(this)}function D_(){return this.each(R_)}function B_(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function F_(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function N_(e){return this.select(e?F_:B_)}function O_(e){return arguments.length?this.property("__data__",e):this.node().__data__}function L_(e){return function(t){e.call(this,t,this.__data__)}}function k_(e){return e.trim().split(/^|\s+/).map(function(t){var i="",s=t.indexOf(".");return s>=0&&(i=t.slice(s+1),t=t.slice(0,s)),{type:t,name:i}})}function U_(e){return function(){var t=this.__on;if(t){for(var i=0,s=-1,n=t.length,r;i<n;++i)r=t[i],(!e.type||r.type===e.type)&&r.name===e.name?this.removeEventListener(r.type,r.listener,r.options):t[++s]=r;++s?t.length=s:delete this.__on}}}function H_(e,t,i){return function(){var s=this.__on,n,r=L_(t);if(s){for(var o=0,a=s.length;o<a;++o)if((n=s[o]).type===e.type&&n.name===e.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=r,n.options=i),n.value=t;return}}this.addEventListener(e.type,r,i),n={type:e.type,name:e.name,value:t,listener:r,options:i},s?s.push(n):this.__on=[n]}}function G_(e,t,i){var s=k_(e+""),n,r=s.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var h=0,l=a.length,c;h<l;++h)for(n=0,c=a[h];n<r;++n)if((o=s[n]).type===c.type&&o.name===c.name)return c.value}return}for(a=t?H_:U_,n=0;n<r;++n)this.each(a(s[n],t,i));return this}function ed(e,t,i){var s=qu(e),n=s.CustomEvent;typeof n=="function"?n=new n(t,i):(n=s.document.createEvent("Event"),i?(n.initEvent(t,i.bubbles,i.cancelable),n.detail=i.detail):n.initEvent(t,!1,!1)),e.dispatchEvent(n)}function W_(e,t){return function(){return ed(this,e,t)}}function X_(e,t){return function(){return ed(this,e,t.apply(this,arguments))}}function $_(e,t){return this.each((typeof t=="function"?X_:W_)(e,t))}function*z_(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var s=e[t],n=0,r=s.length,o;n<r;++n)(o=s[n])&&(yield o)}var id=[null];function oe(e,t){this._groups=e,this._parents=t}function bn(){return new oe([[document.documentElement]],id)}function V_(){return this}oe.prototype=bn.prototype={constructor:oe,select:xg,selectAll:bg,selectChild:Sg,selectChildren:Mg,filter:Rg,data:Lg,enter:Dg,exit:Ug,join:Hg,merge:Gg,selection:V_,order:Wg,sort:Xg,call:zg,nodes:Vg,node:jg,size:Yg,empty:Kg,each:qg,attr:s_,style:a_,property:u_,classed:m_,text:y_,html:T_,raise:A_,lower:C_,append:I_,insert:M_,remove:D_,clone:N_,datum:O_,on:G_,dispatch:$_,[Symbol.iterator]:z_};function j_(e){return typeof e=="string"?new oe([[document.querySelector(e)]],[document.documentElement]):new oe([[e]],id)}function Ch(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function sd(e,t){var i=Object.create(e.prototype);for(var s in t)i[s]=t[s];return i}function Tn(){}var un=.7,Tr=1/un,us="\\s*([+-]?\\d+)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",We="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Y_=/^#([0-9a-f]{3,8})$/,K_=new RegExp(`^rgb\\(${us},${us},${us}\\)$`),q_=new RegExp(`^rgb\\(${We},${We},${We}\\)$`),Z_=new RegExp(`^rgba\\(${us},${us},${us},${dn}\\)$`),J_=new RegExp(`^rgba\\(${We},${We},${We},${dn}\\)$`),Q_=new RegExp(`^hsl\\(${dn},${We},${We}\\)$`),t0=new RegExp(`^hsla\\(${dn},${We},${We},${dn}\\)$`),Al={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ch(Tn,fn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Sl,formatHex:Sl,formatHex8:e0,formatHsl:i0,formatRgb:Cl,toString:Cl});function Sl(){return this.rgb().formatHex()}function e0(){return this.rgb().formatHex8()}function i0(){return nd(this).formatHsl()}function Cl(){return this.rgb().formatRgb()}function fn(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=Y_.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?Il(t):i===3?new ee(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?Fn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?Fn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=K_.exec(e))?new ee(t[1],t[2],t[3],1):(t=q_.exec(e))?new ee(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Z_.exec(e))?Fn(t[1],t[2],t[3],t[4]):(t=J_.exec(e))?Fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Q_.exec(e))?Rl(t[1],t[2]/100,t[3]/100,1):(t=t0.exec(e))?Rl(t[1],t[2]/100,t[3]/100,t[4]):Al.hasOwnProperty(e)?Il(Al[e]):e==="transparent"?new ee(NaN,NaN,NaN,0):null}function Il(e){return new ee(e>>16&255,e>>8&255,e&255,1)}function Fn(e,t,i,s){return s<=0&&(e=t=i=NaN),new ee(e,t,i,s)}function s0(e){return e instanceof Tn||(e=fn(e)),e?(e=e.rgb(),new ee(e.r,e.g,e.b,e.opacity)):new ee}function pa(e,t,i,s){return arguments.length===1?s0(e):new ee(e,t,i,s??1)}function ee(e,t,i,s){this.r=+e,this.g=+t,this.b=+i,this.opacity=+s}Ch(ee,pa,sd(Tn,{brighter(e){return e=e==null?Tr:Math.pow(Tr,e),new ee(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?un:Math.pow(un,e),new ee(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ee(Ui(this.r),Ui(this.g),Ui(this.b),Er(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pl,formatHex:Pl,formatHex8:n0,formatRgb:Ml,toString:Ml}));function Pl(){return`#${Ni(this.r)}${Ni(this.g)}${Ni(this.b)}`}function n0(){return`#${Ni(this.r)}${Ni(this.g)}${Ni(this.b)}${Ni((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ml(){const e=Er(this.opacity);return`${e===1?"rgb(":"rgba("}${Ui(this.r)}, ${Ui(this.g)}, ${Ui(this.b)}${e===1?")":`, ${e})`}`}function Er(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ui(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ni(e){return e=Ui(e),(e<16?"0":"")+e.toString(16)}function Rl(e,t,i,s){return s<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new be(e,t,i,s)}function nd(e){if(e instanceof be)return new be(e.h,e.s,e.l,e.opacity);if(e instanceof Tn||(e=fn(e)),!e)return new be;if(e instanceof be)return e;e=e.rgb();var t=e.r/255,i=e.g/255,s=e.b/255,n=Math.min(t,i,s),r=Math.max(t,i,s),o=NaN,a=r-n,h=(r+n)/2;return a?(t===r?o=(i-s)/a+(i<s)*6:i===r?o=(s-t)/a+2:o=(t-i)/a+4,a/=h<.5?r+n:2-r-n,o*=60):a=h>0&&h<1?0:o,new be(o,a,h,e.opacity)}function r0(e,t,i,s){return arguments.length===1?nd(e):new be(e,t,i,s??1)}function be(e,t,i,s){this.h=+e,this.s=+t,this.l=+i,this.opacity=+s}Ch(be,r0,sd(Tn,{brighter(e){return e=e==null?Tr:Math.pow(Tr,e),new be(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?un:Math.pow(un,e),new be(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,s=i+(i<.5?i:1-i)*t,n=2*i-s;return new ee(Eo(e>=240?e-240:e+120,n,s),Eo(e,n,s),Eo(e<120?e+240:e-120,n,s),this.opacity)},clamp(){return new be(Dl(this.h),Nn(this.s),Nn(this.l),Er(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Er(this.opacity);return`${e===1?"hsl(":"hsla("}${Dl(this.h)}, ${Nn(this.s)*100}%, ${Nn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Dl(e){return e=(e||0)%360,e<0?e+360:e}function Nn(e){return Math.max(0,Math.min(1,e||0))}function Eo(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}const rd=e=>()=>e;function o0(e,t){return function(i){return e+i*t}}function a0(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(s){return Math.pow(e+s*t,i)}}function h0(e){return(e=+e)==1?od:function(t,i){return i-t?a0(t,i,e):rd(isNaN(t)?i:t)}}function od(e,t){var i=t-e;return i?o0(e,i):rd(isNaN(e)?t:e)}const Bl=function e(t){var i=h0(t);function s(n,r){var o=i((n=pa(n)).r,(r=pa(r)).r),a=i(n.g,r.g),h=i(n.b,r.b),l=od(n.opacity,r.opacity);return function(c){return n.r=o(c),n.g=a(c),n.b=h(c),n.opacity=l(c),n+""}}return s.gamma=e,s}(1);function di(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}var ma=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ao=new RegExp(ma.source,"g");function l0(e){return function(){return e}}function c0(e){return function(t){return e(t)+""}}function u0(e,t){var i=ma.lastIndex=Ao.lastIndex=0,s,n,r,o=-1,a=[],h=[];for(e=e+"",t=t+"";(s=ma.exec(e))&&(n=Ao.exec(t));)(r=n.index)>i&&(r=t.slice(i,r),a[o]?a[o]+=r:a[++o]=r),(s=s[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,h.push({i:o,x:di(s,n)})),i=Ao.lastIndex;return i<t.length&&(r=t.slice(i),a[o]?a[o]+=r:a[++o]=r),a.length<2?h[0]?c0(h[0].x):l0(t):(t=h.length,function(l){for(var c=0,u;c<t;++c)a[(u=h[c]).i]=u.x(l);return a.join("")})}var Fl=180/Math.PI,ga={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ad(e,t,i,s,n,r){var o,a,h;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(h=e*i+t*s)&&(i-=e*h,s-=t*h),(a=Math.sqrt(i*i+s*s))&&(i/=a,s/=a,h/=a),e*s<t*i&&(e=-e,t=-t,h=-h,o=-o),{translateX:n,translateY:r,rotate:Math.atan2(t,e)*Fl,skewX:Math.atan(h)*Fl,scaleX:o,scaleY:a}}var On;function d0(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ga:ad(t.a,t.b,t.c,t.d,t.e,t.f)}function f0(e){return e==null||(On||(On=document.createElementNS("http://www.w3.org/2000/svg","g")),On.setAttribute("transform",e),!(e=On.transform.baseVal.consolidate()))?ga:(e=e.matrix,ad(e.a,e.b,e.c,e.d,e.e,e.f))}function hd(e,t,i,s){function n(l){return l.length?l.pop()+" ":""}function r(l,c,u,d,f,p){if(l!==u||c!==d){var m=f.push("translate(",null,t,null,i);p.push({i:m-4,x:di(l,u)},{i:m-2,x:di(c,d)})}else(u||d)&&f.push("translate("+u+t+d+i)}function o(l,c,u,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:u.push(n(u)+"rotate(",null,s)-2,x:di(l,c)})):c&&u.push(n(u)+"rotate("+c+s)}function a(l,c,u,d){l!==c?d.push({i:u.push(n(u)+"skewX(",null,s)-2,x:di(l,c)}):c&&u.push(n(u)+"skewX("+c+s)}function h(l,c,u,d,f,p){if(l!==u||c!==d){var m=f.push(n(f)+"scale(",null,",",null,")");p.push({i:m-4,x:di(l,u)},{i:m-2,x:di(c,d)})}else(u!==1||d!==1)&&f.push(n(f)+"scale("+u+","+d+")")}return function(l,c){var u=[],d=[];return l=e(l),c=e(c),r(l.translateX,l.translateY,c.translateX,c.translateY,u,d),o(l.rotate,c.rotate,u,d),a(l.skewX,c.skewX,u,d),h(l.scaleX,l.scaleY,c.scaleX,c.scaleY,u,d),l=c=null,function(f){for(var p=-1,m=d.length,g;++p<m;)u[(g=d[p]).i]=g.x(f);return u.join("")}}}var p0=hd(d0,"px, ","px)","deg)"),m0=hd(f0,", ",")",")"),Ts=0,$s=0,Fs=0,ld=1e3,Ar,zs,Sr=0,Wi=0,Zr=0,pn=typeof performance=="object"&&performance.now?performance:Date,cd=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ih(){return Wi||(cd(g0),Wi=pn.now()+Zr)}function g0(){Wi=0}function Cr(){this._call=this._time=this._next=null}Cr.prototype=Ph.prototype={constructor:Cr,restart:function(e,t,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?Ih():+i)+(t==null?0:+t),!this._next&&zs!==this&&(zs?zs._next=this:Ar=this,zs=this),this._call=e,this._time=i,_a()},stop:function(){this._call&&(this._call=null,this._time=1/0,_a())}};function Ph(e,t,i){var s=new Cr;return s.restart(e,t,i),s}function _0(){Ih(),++Ts;for(var e=Ar,t;e;)(t=Wi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ts}function Nl(){Wi=(Sr=pn.now())+Zr,Ts=$s=0;try{_0()}finally{Ts=0,y0(),Wi=0}}function x0(){var e=pn.now(),t=e-Sr;t>ld&&(Zr-=t,Sr=e)}function y0(){for(var e,t=Ar,i,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(i=t._next,t._next=null,t=e?e._next=i:Ar=i);zs=e,_a(s)}function _a(e){if(!Ts){$s&&($s=clearTimeout($s));var t=e-Wi;t>24?(e<1/0&&($s=setTimeout(Nl,e-pn.now()-Zr)),Fs&&(Fs=clearInterval(Fs))):(Fs||(Sr=pn.now(),Fs=setInterval(x0,ld)),Ts=1,cd(Nl))}}function Ol(e,t,i){var s=new Cr;return t=t==null?0:+t,s.restart(n=>{s.stop(),e(n+t)},t,i),s}var v0=Eh("start","end","cancel","interrupt"),w0=[],ud=0,Ll=1,xa=2,lr=3,kl=4,ya=5,cr=6;function Jr(e,t,i,s,n,r){var o=e.__transition;if(!o)e.__transition={};else if(i in o)return;b0(e,i,{name:t,index:s,group:n,on:v0,tween:w0,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:ud})}function Mh(e,t){var i=Re(e,t);if(i.state>ud)throw new Error("too late; already scheduled");return i}function Ve(e,t){var i=Re(e,t);if(i.state>lr)throw new Error("too late; already running");return i}function Re(e,t){var i=e.__transition;if(!i||!(i=i[t]))throw new Error("transition not found");return i}function b0(e,t,i){var s=e.__transition,n;s[t]=i,i.timer=Ph(r,0,i.time);function r(l){i.state=Ll,i.timer.restart(o,i.delay,i.time),i.delay<=l&&o(l-i.delay)}function o(l){var c,u,d,f;if(i.state!==Ll)return h();for(c in s)if(f=s[c],f.name===i.name){if(f.state===lr)return Ol(o);f.state===kl?(f.state=cr,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete s[c]):+c<t&&(f.state=cr,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete s[c])}if(Ol(function(){i.state===lr&&(i.state=kl,i.timer.restart(a,i.delay,i.time),a(l))}),i.state=xa,i.on.call("start",e,e.__data__,i.index,i.group),i.state===xa){for(i.state=lr,n=new Array(d=i.tween.length),c=0,u=-1;c<d;++c)(f=i.tween[c].value.call(e,e.__data__,i.index,i.group))&&(n[++u]=f);n.length=u+1}}function a(l){for(var c=l<i.duration?i.ease.call(null,l/i.duration):(i.timer.restart(h),i.state=ya,1),u=-1,d=n.length;++u<d;)n[u].call(e,c);i.state===ya&&(i.on.call("end",e,e.__data__,i.index,i.group),h())}function h(){i.state=cr,i.timer.stop(),delete s[t];for(var l in s)return;delete e.__transition}}function T0(e,t){var i=e.__transition,s,n,r=!0,o;if(i){t=t==null?null:t+"";for(o in i){if((s=i[o]).name!==t){r=!1;continue}n=s.state>xa&&s.state<ya,s.state=cr,s.timer.stop(),s.on.call(n?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete i[o]}r&&delete e.__transition}}function E0(e){return this.each(function(){T0(this,e)})}function A0(e,t){var i,s;return function(){var n=Ve(this,e),r=n.tween;if(r!==i){s=i=r;for(var o=0,a=s.length;o<a;++o)if(s[o].name===t){s=s.slice(),s.splice(o,1);break}}n.tween=s}}function S0(e,t,i){var s,n;if(typeof i!="function")throw new Error;return function(){var r=Ve(this,e),o=r.tween;if(o!==s){n=(s=o).slice();for(var a={name:t,value:i},h=0,l=n.length;h<l;++h)if(n[h].name===t){n[h]=a;break}h===l&&n.push(a)}r.tween=n}}function C0(e,t){var i=this._id;if(e+="",arguments.length<2){for(var s=Re(this.node(),i).tween,n=0,r=s.length,o;n<r;++n)if((o=s[n]).name===e)return o.value;return null}return this.each((t==null?A0:S0)(i,e,t))}function Rh(e,t,i){var s=e._id;return e.each(function(){var n=Ve(this,s);(n.value||(n.value={}))[t]=i.apply(this,arguments)}),function(n){return Re(n,s).value[t]}}function dd(e,t){var i;return(typeof t=="number"?di:t instanceof fn?Bl:(i=fn(t))?(t=i,Bl):u0)(e,t)}function I0(e){return function(){this.removeAttribute(e)}}function P0(e){return function(){this.removeAttributeNS(e.space,e.local)}}function M0(e,t,i){var s,n=i+"",r;return function(){var o=this.getAttribute(e);return o===n?null:o===s?r:r=t(s=o,i)}}function R0(e,t,i){var s,n=i+"",r;return function(){var o=this.getAttributeNS(e.space,e.local);return o===n?null:o===s?r:r=t(s=o,i)}}function D0(e,t,i){var s,n,r;return function(){var o,a=i(this),h;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),h=a+"",o===h?null:o===s&&h===n?r:(n=h,r=t(s=o,a)))}}function B0(e,t,i){var s,n,r;return function(){var o,a=i(this),h;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),h=a+"",o===h?null:o===s&&h===n?r:(n=h,r=t(s=o,a)))}}function F0(e,t){var i=qr(e),s=i==="transform"?m0:dd;return this.attrTween(e,typeof t=="function"?(i.local?B0:D0)(i,s,Rh(this,"attr."+e,t)):t==null?(i.local?P0:I0)(i):(i.local?R0:M0)(i,s,t))}function N0(e,t){return function(i){this.setAttribute(e,t.call(this,i))}}function O0(e,t){return function(i){this.setAttributeNS(e.space,e.local,t.call(this,i))}}function L0(e,t){var i,s;function n(){var r=t.apply(this,arguments);return r!==s&&(i=(s=r)&&O0(e,r)),i}return n._value=t,n}function k0(e,t){var i,s;function n(){var r=t.apply(this,arguments);return r!==s&&(i=(s=r)&&N0(e,r)),i}return n._value=t,n}function U0(e,t){var i="attr."+e;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;var s=qr(e);return this.tween(i,(s.local?L0:k0)(s,t))}function H0(e,t){return function(){Mh(this,e).delay=+t.apply(this,arguments)}}function G0(e,t){return t=+t,function(){Mh(this,e).delay=t}}function W0(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?H0:G0)(t,e)):Re(this.node(),t).delay}function X0(e,t){return function(){Ve(this,e).duration=+t.apply(this,arguments)}}function $0(e,t){return t=+t,function(){Ve(this,e).duration=t}}function z0(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?X0:$0)(t,e)):Re(this.node(),t).duration}function V0(e,t){if(typeof t!="function")throw new Error;return function(){Ve(this,e).ease=t}}function j0(e){var t=this._id;return arguments.length?this.each(V0(t,e)):Re(this.node(),t).ease}function Y0(e,t){return function(){var i=t.apply(this,arguments);if(typeof i!="function")throw new Error;Ve(this,e).ease=i}}function K0(e){if(typeof e!="function")throw new Error;return this.each(Y0(this._id,e))}function q0(e){typeof e!="function"&&(e=ju(e));for(var t=this._groups,i=t.length,s=new Array(i),n=0;n<i;++n)for(var r=t[n],o=r.length,a=s[n]=[],h,l=0;l<o;++l)(h=r[l])&&e.call(h,h.__data__,l,r)&&a.push(h);return new ni(s,this._parents,this._name,this._id)}function Z0(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,i=e._groups,s=t.length,n=i.length,r=Math.min(s,n),o=new Array(s),a=0;a<r;++a)for(var h=t[a],l=i[a],c=h.length,u=o[a]=new Array(c),d,f=0;f<c;++f)(d=h[f]||l[f])&&(u[f]=d);for(;a<s;++a)o[a]=t[a];return new ni(o,this._parents,this._name,this._id)}function J0(e){return(e+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||t==="start"})}function Q0(e,t,i){var s,n,r=J0(t)?Mh:Ve;return function(){var o=r(this,e),a=o.on;a!==s&&(n=(s=a).copy()).on(t,i),o.on=n}}function tx(e,t){var i=this._id;return arguments.length<2?Re(this.node(),i).on.on(e):this.each(Q0(i,e,t))}function ex(e){return function(){var t=this.parentNode;for(var i in this.__transition)if(+i!==e)return;t&&t.removeChild(this)}}function ix(){return this.on("end.remove",ex(this._id))}function sx(e){var t=this._name,i=this._id;typeof e!="function"&&(e=Ah(e));for(var s=this._groups,n=s.length,r=new Array(n),o=0;o<n;++o)for(var a=s[o],h=a.length,l=r[o]=new Array(h),c,u,d=0;d<h;++d)(c=a[d])&&(u=e.call(c,c.__data__,d,a))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u,Jr(l[d],t,i,d,l,Re(c,i)));return new ni(r,this._parents,t,i)}function nx(e){var t=this._name,i=this._id;typeof e!="function"&&(e=Vu(e));for(var s=this._groups,n=s.length,r=[],o=[],a=0;a<n;++a)for(var h=s[a],l=h.length,c,u=0;u<l;++u)if(c=h[u]){for(var d=e.call(c,c.__data__,u,h),f,p=Re(c,i),m=0,g=d.length;m<g;++m)(f=d[m])&&Jr(f,t,i,m,d,p);r.push(d),o.push(c)}return new ni(r,o,t,i)}var rx=bn.prototype.constructor;function ox(){return new rx(this._groups,this._parents)}function ax(e,t){var i,s,n;return function(){var r=bs(this,e),o=(this.style.removeProperty(e),bs(this,e));return r===o?null:r===i&&o===s?n:n=t(i=r,s=o)}}function fd(e){return function(){this.style.removeProperty(e)}}function hx(e,t,i){var s,n=i+"",r;return function(){var o=bs(this,e);return o===n?null:o===s?r:r=t(s=o,i)}}function lx(e,t,i){var s,n,r;return function(){var o=bs(this,e),a=i(this),h=a+"";return a==null&&(h=a=(this.style.removeProperty(e),bs(this,e))),o===h?null:o===s&&h===n?r:(n=h,r=t(s=o,a))}}function cx(e,t){var i,s,n,r="style."+t,o="end."+r,a;return function(){var h=Ve(this,e),l=h.on,c=h.value[r]==null?a||(a=fd(t)):void 0;(l!==i||n!==c)&&(s=(i=l).copy()).on(o,n=c),h.on=s}}function ux(e,t,i){var s=(e+="")=="transform"?p0:dd;return t==null?this.styleTween(e,ax(e,s)).on("end.style."+e,fd(e)):typeof t=="function"?this.styleTween(e,lx(e,s,Rh(this,"style."+e,t))).each(cx(this._id,e)):this.styleTween(e,hx(e,s,t),i).on("end.style."+e,null)}function dx(e,t,i){return function(s){this.style.setProperty(e,t.call(this,s),i)}}function fx(e,t,i){var s,n;function r(){var o=t.apply(this,arguments);return o!==n&&(s=(n=o)&&dx(e,o,i)),s}return r._value=t,r}function px(e,t,i){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,fx(e,t,i??""))}function mx(e){return function(){this.textContent=e}}function gx(e){return function(){var t=e(this);this.textContent=t??""}}function _x(e){return this.tween("text",typeof e=="function"?gx(Rh(this,"text",e)):mx(e==null?"":e+""))}function xx(e){return function(t){this.textContent=e.call(this,t)}}function yx(e){var t,i;function s(){var n=e.apply(this,arguments);return n!==i&&(t=(i=n)&&xx(n)),t}return s._value=e,s}function vx(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,yx(e))}function wx(){for(var e=this._name,t=this._id,i=pd(),s=this._groups,n=s.length,r=0;r<n;++r)for(var o=s[r],a=o.length,h,l=0;l<a;++l)if(h=o[l]){var c=Re(h,t);Jr(h,e,i,l,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ni(s,this._parents,e,i)}function bx(){var e,t,i=this,s=i._id,n=i.size();return new Promise(function(r,o){var a={value:o},h={value:function(){--n===0&&r()}};i.each(function(){var l=Ve(this,s),c=l.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(h)),l.on=t}),n===0&&r()})}var Tx=0;function ni(e,t,i,s){this._groups=e,this._parents=t,this._name=i,this._id=s}function pd(){return++Tx}var Ye=bn.prototype;ni.prototype={constructor:ni,select:sx,selectAll:nx,selectChild:Ye.selectChild,selectChildren:Ye.selectChildren,filter:q0,merge:Z0,selection:ox,transition:wx,call:Ye.call,nodes:Ye.nodes,node:Ye.node,size:Ye.size,empty:Ye.empty,each:Ye.each,on:tx,attr:F0,attrTween:U0,style:ux,styleTween:px,text:_x,textTween:vx,remove:ix,tween:C0,delay:W0,duration:z0,ease:j0,easeVarying:K0,end:bx,[Symbol.iterator]:Ye[Symbol.iterator]};function Ex(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ax={time:null,delay:0,duration:250,ease:Ex};function Sx(e,t){for(var i;!(i=e.__transition)||!(i=i[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return i}function Cx(e){var t,i;e instanceof ni?(t=e._id,e=e._name):(t=pd(),(i=Ax).time=Ih(),e=e==null?null:e+"");for(var s=this._groups,n=s.length,r=0;r<n;++r)for(var o=s[r],a=o.length,h,l=0;l<a;++l)(h=o[l])&&Jr(h,e,t,l,o,i||Sx(h,t));return new ni(s,this._parents,e,t)}bn.prototype.interrupt=E0;bn.prototype.transition=Cx;function Ix(e,t){var i,s=1;e==null&&(e=0),t==null&&(t=0);function n(){var r,o=i.length,a,h=0,l=0;for(r=0;r<o;++r)a=i[r],h+=a.x,l+=a.y;for(h=(h/o-e)*s,l=(l/o-t)*s,r=0;r<o;++r)a=i[r],a.x-=h,a.y-=l}return n.initialize=function(r){i=r},n.x=function(r){return arguments.length?(e=+r,n):e},n.y=function(r){return arguments.length?(t=+r,n):t},n.strength=function(r){return arguments.length?(s=+r,n):s},n}function Px(e){const t=+this._x.call(null,e),i=+this._y.call(null,e);return md(this.cover(t,i),t,i,e)}function md(e,t,i,s){if(isNaN(t)||isNaN(i))return e;var n,r=e._root,o={data:s},a=e._x0,h=e._y0,l=e._x1,c=e._y1,u,d,f,p,m,g,y,v;if(!r)return e._root=o,e;for(;r.length;)if((m=t>=(u=(a+l)/2))?a=u:l=u,(g=i>=(d=(h+c)/2))?h=d:c=d,n=r,!(r=r[y=g<<1|m]))return n[y]=o,e;if(f=+e._x.call(null,r.data),p=+e._y.call(null,r.data),t===f&&i===p)return o.next=r,n?n[y]=o:e._root=o,e;do n=n?n[y]=new Array(4):e._root=new Array(4),(m=t>=(u=(a+l)/2))?a=u:l=u,(g=i>=(d=(h+c)/2))?h=d:c=d;while((y=g<<1|m)===(v=(p>=d)<<1|f>=u));return n[v]=r,n[y]=o,e}function Mx(e){var t,i,s=e.length,n,r,o=new Array(s),a=new Array(s),h=1/0,l=1/0,c=-1/0,u=-1/0;for(i=0;i<s;++i)isNaN(n=+this._x.call(null,t=e[i]))||isNaN(r=+this._y.call(null,t))||(o[i]=n,a[i]=r,n<h&&(h=n),n>c&&(c=n),r<l&&(l=r),r>u&&(u=r));if(h>c||l>u)return this;for(this.cover(h,l).cover(c,u),i=0;i<s;++i)md(this,o[i],a[i],e[i]);return this}function Rx(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var i=this._x0,s=this._y0,n=this._x1,r=this._y1;if(isNaN(i))n=(i=Math.floor(e))+1,r=(s=Math.floor(t))+1;else{for(var o=n-i||1,a=this._root,h,l;i>e||e>=n||s>t||t>=r;)switch(l=(t<s)<<1|e<i,h=new Array(4),h[l]=a,a=h,o*=2,l){case 0:n=i+o,r=s+o;break;case 1:i=n-o,r=s+o;break;case 2:n=i+o,s=r-o;break;case 3:i=n-o,s=r-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=i,this._y0=s,this._x1=n,this._y1=r,this}function Dx(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Bx(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Zt(e,t,i,s,n){this.node=e,this.x0=t,this.y0=i,this.x1=s,this.y1=n}function Fx(e,t,i){var s,n=this._x0,r=this._y0,o,a,h,l,c=this._x1,u=this._y1,d=[],f=this._root,p,m;for(f&&d.push(new Zt(f,n,r,c,u)),i==null?i=1/0:(n=e-i,r=t-i,c=e+i,u=t+i,i*=i);p=d.pop();)if(!(!(f=p.node)||(o=p.x0)>c||(a=p.y0)>u||(h=p.x1)<n||(l=p.y1)<r))if(f.length){var g=(o+h)/2,y=(a+l)/2;d.push(new Zt(f[3],g,y,h,l),new Zt(f[2],o,y,g,l),new Zt(f[1],g,a,h,y),new Zt(f[0],o,a,g,y)),(m=(t>=y)<<1|e>=g)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-m],d[d.length-1-m]=p)}else{var v=e-+this._x.call(null,f.data),_=t-+this._y.call(null,f.data),x=v*v+_*_;if(x<i){var A=Math.sqrt(i=x);n=e-A,r=t-A,c=e+A,u=t+A,s=f.data}}return s}function Nx(e){if(isNaN(c=+this._x.call(null,e))||isNaN(u=+this._y.call(null,e)))return this;var t,i=this._root,s,n,r,o=this._x0,a=this._y0,h=this._x1,l=this._y1,c,u,d,f,p,m,g,y;if(!i)return this;if(i.length)for(;;){if((p=c>=(d=(o+h)/2))?o=d:h=d,(m=u>=(f=(a+l)/2))?a=f:l=f,t=i,!(i=i[g=m<<1|p]))return this;if(!i.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(s=t,y=g)}for(;i.data!==e;)if(n=i,!(i=i.next))return this;return(r=i.next)&&delete i.next,n?(r?n.next=r:delete n.next,this):t?(r?t[g]=r:delete t[g],(i=t[0]||t[1]||t[2]||t[3])&&i===(t[3]||t[2]||t[1]||t[0])&&!i.length&&(s?s[y]=i:this._root=i),this):(this._root=r,this)}function Ox(e){for(var t=0,i=e.length;t<i;++t)this.remove(e[t]);return this}function Lx(){return this._root}function kx(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Ux(e){var t=[],i,s=this._root,n,r,o,a,h;for(s&&t.push(new Zt(s,this._x0,this._y0,this._x1,this._y1));i=t.pop();)if(!e(s=i.node,r=i.x0,o=i.y0,a=i.x1,h=i.y1)&&s.length){var l=(r+a)/2,c=(o+h)/2;(n=s[3])&&t.push(new Zt(n,l,c,a,h)),(n=s[2])&&t.push(new Zt(n,r,c,l,h)),(n=s[1])&&t.push(new Zt(n,l,o,a,c)),(n=s[0])&&t.push(new Zt(n,r,o,l,c))}return this}function Hx(e){var t=[],i=[],s;for(this._root&&t.push(new Zt(this._root,this._x0,this._y0,this._x1,this._y1));s=t.pop();){var n=s.node;if(n.length){var r,o=s.x0,a=s.y0,h=s.x1,l=s.y1,c=(o+h)/2,u=(a+l)/2;(r=n[0])&&t.push(new Zt(r,o,a,c,u)),(r=n[1])&&t.push(new Zt(r,c,a,h,u)),(r=n[2])&&t.push(new Zt(r,o,u,c,l)),(r=n[3])&&t.push(new Zt(r,c,u,h,l))}i.push(s)}for(;s=i.pop();)e(s.node,s.x0,s.y0,s.x1,s.y1);return this}function Gx(e){return e[0]}function Wx(e){return arguments.length?(this._x=e,this):this._x}function Xx(e){return e[1]}function $x(e){return arguments.length?(this._y=e,this):this._y}function Dh(e,t,i){var s=new Bh(t??Gx,i??Xx,NaN,NaN,NaN,NaN);return e==null?s:s.addAll(e)}function Bh(e,t,i,s,n,r){this._x=e,this._y=t,this._x0=i,this._y0=s,this._x1=n,this._y1=r,this._root=void 0}function Ul(e){for(var t={data:e.data},i=t;e=e.next;)i=i.next={data:e.data};return t}var Jt=Dh.prototype=Bh.prototype;Jt.copy=function(){var e=new Bh(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,i,s;if(!t)return e;if(!t.length)return e._root=Ul(t),e;for(i=[{source:t,target:e._root=new Array(4)}];t=i.pop();)for(var n=0;n<4;++n)(s=t.source[n])&&(s.length?i.push({source:s,target:t.target[n]=new Array(4)}):t.target[n]=Ul(s));return e};Jt.add=Px;Jt.addAll=Mx;Jt.cover=Rx;Jt.data=Dx;Jt.extent=Bx;Jt.find=Fx;Jt.remove=Nx;Jt.removeAll=Ox;Jt.root=Lx;Jt.size=kx;Jt.visit=Ux;Jt.visitAfter=Hx;Jt.x=Wx;Jt.y=$x;function Hi(e){return function(){return e}}function pi(e){return(e()-.5)*1e-6}function zx(e){return e.x+e.vx}function Vx(e){return e.y+e.vy}function jx(e){var t,i,s,n=1,r=1;typeof e!="function"&&(e=Hi(e==null?1:+e));function o(){for(var l,c=t.length,u,d,f,p,m,g,y=0;y<r;++y)for(u=Dh(t,zx,Vx).visitAfter(a),l=0;l<c;++l)d=t[l],m=i[d.index],g=m*m,f=d.x+d.vx,p=d.y+d.vy,u.visit(v);function v(_,x,A,T,I){var S=_.data,G=_.r,H=m+G;if(S){if(S.index>d.index){var N=f-S.x-S.vx,$=p-S.y-S.vy,D=N*N+$*$;D<H*H&&(N===0&&(N=pi(s),D+=N*N),$===0&&($=pi(s),D+=$*$),D=(H-(D=Math.sqrt(D)))/D*n,d.vx+=(N*=D)*(H=(G*=G)/(g+G)),d.vy+=($*=D)*H,S.vx-=N*(H=1-H),S.vy-=$*H)}return}return x>f+H||T<f-H||A>p+H||I<p-H}}function a(l){if(l.data)return l.r=i[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function h(){if(t){var l,c=t.length,u;for(i=new Array(c),l=0;l<c;++l)u=t[l],i[u.index]=+e(u,l,t)}}return o.initialize=function(l,c){t=l,s=c,h()},o.iterations=function(l){return arguments.length?(r=+l,o):r},o.strength=function(l){return arguments.length?(n=+l,o):n},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Hi(+l),h(),o):e},o}function Yx(e){return e.index}function Hl(e,t){var i=e.get(t);if(!i)throw new Error("node not found: "+t);return i}function Kx(e){var t=Yx,i=u,s,n=Hi(30),r,o,a,h,l,c=1;e==null&&(e=[]);function u(g){return 1/Math.min(a[g.source.index],a[g.target.index])}function d(g){for(var y=0,v=e.length;y<c;++y)for(var _=0,x,A,T,I,S,G,H;_<v;++_)x=e[_],A=x.source,T=x.target,I=T.x+T.vx-A.x-A.vx||pi(l),S=T.y+T.vy-A.y-A.vy||pi(l),G=Math.sqrt(I*I+S*S),G=(G-r[_])/G*g*s[_],I*=G,S*=G,T.vx-=I*(H=h[_]),T.vy-=S*H,A.vx+=I*(H=1-H),A.vy+=S*H}function f(){if(o){var g,y=o.length,v=e.length,_=new Map(o.map((A,T)=>[t(A,T,o),A])),x;for(g=0,a=new Array(y);g<v;++g)x=e[g],x.index=g,typeof x.source!="object"&&(x.source=Hl(_,x.source)),typeof x.target!="object"&&(x.target=Hl(_,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(g=0,h=new Array(v);g<v;++g)x=e[g],h[g]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);s=new Array(v),p(),r=new Array(v),m()}}function p(){if(o)for(var g=0,y=e.length;g<y;++g)s[g]=+i(e[g],g,e)}function m(){if(o)for(var g=0,y=e.length;g<y;++g)r[g]=+n(e[g],g,e)}return d.initialize=function(g,y){o=g,l=y,f()},d.links=function(g){return arguments.length?(e=g,f(),d):e},d.id=function(g){return arguments.length?(t=g,d):t},d.iterations=function(g){return arguments.length?(c=+g,d):c},d.strength=function(g){return arguments.length?(i=typeof g=="function"?g:Hi(+g),p(),d):i},d.distance=function(g){return arguments.length?(n=typeof g=="function"?g:Hi(+g),m(),d):n},d}const qx=1664525,Zx=1013904223,Gl=4294967296;function Jx(){let e=1;return()=>(e=(qx*e+Zx)%Gl)/Gl}function Qx(e){return e.x}function ty(e){return e.y}var ey=10,iy=Math.PI*(3-Math.sqrt(5));function sy(e){var t,i=1,s=.001,n=1-Math.pow(s,1/300),r=0,o=.6,a=new Map,h=Ph(u),l=Eh("tick","end"),c=Jx();e==null&&(e=[]);function u(){d(),l.call("tick",t),i<s&&(h.stop(),l.call("end",t))}function d(m){var g,y=e.length,v;m===void 0&&(m=1);for(var _=0;_<m;++_)for(i+=(r-i)*n,a.forEach(function(x){x(i)}),g=0;g<y;++g)v=e[g],v.fx==null?v.x+=v.vx*=o:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=o:(v.y=v.fy,v.vy=0);return t}function f(){for(var m=0,g=e.length,y;m<g;++m){if(y=e[m],y.index=m,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=ey*Math.sqrt(.5+m),_=m*iy;y.x=v*Math.cos(_),y.y=v*Math.sin(_)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(m){return m.initialize&&m.initialize(e,c),m}return f(),t={tick:d,restart:function(){return h.restart(u),t},stop:function(){return h.stop(),t},nodes:function(m){return arguments.length?(e=m,f(),a.forEach(p),t):e},alpha:function(m){return arguments.length?(i=+m,t):i},alphaMin:function(m){return arguments.length?(s=+m,t):s},alphaDecay:function(m){return arguments.length?(n=+m,t):+n},alphaTarget:function(m){return arguments.length?(r=+m,t):r},velocityDecay:function(m){return arguments.length?(o=1-m,t):1-o},randomSource:function(m){return arguments.length?(c=m,a.forEach(p),t):c},force:function(m,g){return arguments.length>1?(g==null?a.delete(m):a.set(m,p(g)),t):a.get(m)},find:function(m,g,y){var v=0,_=e.length,x,A,T,I,S;for(y==null?y=1/0:y*=y,v=0;v<_;++v)I=e[v],x=m-I.x,A=g-I.y,T=x*x+A*A,T<y&&(S=I,y=T);return S},on:function(m,g){return arguments.length>1?(l.on(m,g),t):l.on(m)}}}function ny(){var e,t,i,s,n=Hi(-30),r,o=1,a=1/0,h=.81;function l(f){var p,m=e.length,g=Dh(e,Qx,ty).visitAfter(u);for(s=f,p=0;p<m;++p)t=e[p],g.visit(d)}function c(){if(e){var f,p=e.length,m;for(r=new Array(p),f=0;f<p;++f)m=e[f],r[m.index]=+n(m,f,e)}}function u(f){var p=0,m,g,y=0,v,_,x;if(f.length){for(v=_=x=0;x<4;++x)(m=f[x])&&(g=Math.abs(m.value))&&(p+=m.value,y+=g,v+=g*m.x,_+=g*m.y);f.x=v/y,f.y=_/y}else{m=f,m.x=m.data.x,m.y=m.data.y;do p+=r[m.data.index];while(m=m.next)}f.value=p}function d(f,p,m,g){if(!f.value)return!0;var y=f.x-t.x,v=f.y-t.y,_=g-p,x=y*y+v*v;if(_*_/h<x)return x<a&&(y===0&&(y=pi(i),x+=y*y),v===0&&(v=pi(i),x+=v*v),x<o&&(x=Math.sqrt(o*x)),t.vx+=y*f.value*s/x,t.vy+=v*f.value*s/x),!0;if(f.length||x>=a)return;(f.data!==t||f.next)&&(y===0&&(y=pi(i),x+=y*y),v===0&&(v=pi(i),x+=v*v),x<o&&(x=Math.sqrt(o*x)));do f.data!==t&&(_=r[f.data.index]*s/x,t.vx+=y*_,t.vy+=v*_);while(f=f.next)}return l.initialize=function(f,p){e=f,i=p,c()},l.strength=function(f){return arguments.length?(n=typeof f=="function"?f:Hi(+f),c(),l):n},l.distanceMin=function(f){return arguments.length?(o=f*f,l):Math.sqrt(o)},l.distanceMax=function(f){return arguments.length?(a=f*f,l):Math.sqrt(a)},l.theta=function(f){return arguments.length?(h=f*f,l):Math.sqrt(h)},l}function Vs(e,t,i){this.k=e,this.x=t,this.y=i}Vs.prototype={constructor:Vs,scale:function(e){return e===1?this:new Vs(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Vs(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Vs.prototype;var Vi=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(Vi||{}),Ir=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(Ir||{}),va=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(va||{}),nt=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(nt||{}),Ge=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(Ge||{}),U=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(U||{}),ds=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(ds||{}),et=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(et||{}),wa=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(wa||{}),ti=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(ti||{}),vi=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(vi||{}),ze=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(ze||{}),De=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(De||{}),ke=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(ke||{}),Fh=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(Fh||{}),he=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(he||{}),kt=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(kt||{}),Nt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Nt||{}),Xe=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Xe||{});const ry={createCanvas:(e,t)=>{const i=document.createElement("canvas");return i.width=e,i.height=t,i},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")},z={ADAPTER:ry,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var So=/iPhone/i,Wl=/iPod/i,Xl=/iPad/i,$l=/\biOS-universal(?:.+)Mac\b/i,Co=/\bAndroid(?:.+)Mobile\b/i,zl=/Android/i,Zi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ln=/Silk/i,Ke=/Windows Phone/i,Vl=/\bWindows(?:.+)ARM\b/i,jl=/BlackBerry/i,Yl=/BB10/i,Kl=/Opera Mini/i,ql=/\b(CriOS|Chrome)(?:.+)Mobile/i,Zl=/Mobile(?:.+)Firefox\b/i,Jl=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function oy(e){return function(t){return t.test(e)}}function Ql(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var i=t.userAgent,s=i.split("[FBAN");typeof s[1]<"u"&&(i=s[0]),s=i.split("Twitter"),typeof s[1]<"u"&&(i=s[0]);var n=oy(i),r={apple:{phone:n(So)&&!n(Ke),ipod:n(Wl),tablet:!n(So)&&(n(Xl)||Jl(t))&&!n(Ke),universal:n($l),device:(n(So)||n(Wl)||n(Xl)||n($l)||Jl(t))&&!n(Ke)},amazon:{phone:n(Zi),tablet:!n(Zi)&&n(Ln),device:n(Zi)||n(Ln)},android:{phone:!n(Ke)&&n(Zi)||!n(Ke)&&n(Co),tablet:!n(Ke)&&!n(Zi)&&!n(Co)&&(n(Ln)||n(zl)),device:!n(Ke)&&(n(Zi)||n(Ln)||n(Co)||n(zl))||n(/\bokhttp\b/i)},windows:{phone:n(Ke),tablet:n(Vl),device:n(Ke)||n(Vl)},other:{blackberry:n(jl),blackberry10:n(Yl),opera:n(Kl),firefox:n(Zl),chrome:n(ql),device:n(jl)||n(Yl)||n(Kl)||n(Zl)||n(ql)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}const ay=Ql.default??Ql,ei=ay(globalThis.navigator);z.RETINA_PREFIX=/@([0-9\.]+)x/;z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _d={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function n(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function r(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new n(c,u||h,d),p=i?i+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(i?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=i?i+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(l){var c=i?i+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,d,f,p){var m=i?i+l:l;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,v,_;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,u),!0;case 4:return g.fn.call(g.context,c,u,d),!0;case 5:return g.fn.call(g.context,c,u,d,f),!0;case 6:return g.fn.call(g.context,c,u,d,f,p),!0}for(_=1,v=new Array(y-1);_<y;_++)v[_-1]=arguments[_];g.fn.apply(g.context,v)}else{var x=g.length,A;for(_=0;_<x;_++)switch(g[_].once&&this.removeListener(l,g[_].fn,void 0,!0),y){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,c);break;case 3:g[_].fn.call(g[_].context,c,u);break;case 4:g[_].fn.call(g[_].context,c,u,d);break;default:if(!v)for(A=1,v=new Array(y-1);A<y;A++)v[A-1]=arguments[A];g[_].fn.apply(g[_].context,v)}}return!0},a.prototype.on=function(l,c,u){return r(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return r(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,d){var f=i?i+l:l;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==c||d&&!p[m].once||u&&p[m].context!==u)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=i?i+l:l,this._events[c]&&o(this,c)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,e.exports=a})(_d);var hy=_d.exports;const En=gd(hy);var Nh={exports:{}};Nh.exports=Qr;Nh.exports.default=Qr;function Qr(e,t,i){i=i||2;var s=t&&t.length,n=s?t[0]*i:e.length,r=xd(e,0,n,i,!0),o=[];if(!r||r.next===r.prev)return o;var a,h,l,c,u,d,f;if(s&&(r=fy(e,t,r,i)),e.length>80*i){a=l=e[0],h=c=e[1];for(var p=i;p<n;p+=i)u=e[p],d=e[p+1],u<a&&(a=u),d<h&&(h=d),u>l&&(l=u),d>c&&(c=d);f=Math.max(l-a,c-h),f=f!==0?32767/f:0}return mn(r,o,i,a,h,f,0),o}function xd(e,t,i,s,n){var r,o;if(n===Ea(e,t,i,s)>0)for(r=t;r<i;r+=s)o=tc(r,e[r],e[r+1],o);else for(r=i-s;r>=t;r-=s)o=tc(r,e[r],e[r+1],o);return o&&to(o,o.next)&&(_n(o),o=o.next),o}function Xi(e,t){if(!e)return e;t||(t=e);var i=e,s;do if(s=!1,!i.steiner&&(to(i,i.next)||It(i.prev,i,i.next)===0)){if(_n(i),i=t=i.prev,i===i.next)break;s=!0}else i=i.next;while(s||i!==t);return t}function mn(e,t,i,s,n,r,o){if(e){!o&&r&&xy(e,s,n,r);for(var a=e,h,l;e.prev!==e.next;){if(h=e.prev,l=e.next,r?cy(e,s,n,r):ly(e)){t.push(h.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),_n(e),e=l.next,a=l.next;continue}if(e=l,e===a){o?o===1?(e=uy(Xi(e),t,i),mn(e,t,i,s,n,r,2)):o===2&&dy(e,t,i,s,n,r):mn(Xi(e),t,i,s,n,r,1);break}}}}function ly(e){var t=e.prev,i=e,s=e.next;if(It(t,i,s)>=0)return!1;for(var n=t.x,r=i.x,o=s.x,a=t.y,h=i.y,l=s.y,c=n<r?n<o?n:o:r<o?r:o,u=a<h?a<l?a:l:h<l?h:l,d=n>r?n>o?n:o:r>o?r:o,f=a>h?a>l?a:l:h>l?h:l,p=s.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&os(n,a,r,h,o,l,p.x,p.y)&&It(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function cy(e,t,i,s){var n=e.prev,r=e,o=e.next;if(It(n,r,o)>=0)return!1;for(var a=n.x,h=r.x,l=o.x,c=n.y,u=r.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,p=c<u?c<d?c:d:u<d?u:d,m=a>h?a>l?a:l:h>l?h:l,g=c>u?c>d?c:d:u>d?u:d,y=ba(f,p,t,i,s),v=ba(m,g,t,i,s),_=e.prevZ,x=e.nextZ;_&&_.z>=y&&x&&x.z<=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==n&&_!==o&&os(a,c,h,u,l,d,_.x,_.y)&&It(_.prev,_,_.next)>=0||(_=_.prevZ,x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==n&&x!==o&&os(a,c,h,u,l,d,x.x,x.y)&&It(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==n&&_!==o&&os(a,c,h,u,l,d,_.x,_.y)&&It(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=v;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==n&&x!==o&&os(a,c,h,u,l,d,x.x,x.y)&&It(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function uy(e,t,i){var s=e;do{var n=s.prev,r=s.next.next;!to(n,r)&&yd(n,s,s.next,r)&&gn(n,r)&&gn(r,n)&&(t.push(n.i/i|0),t.push(s.i/i|0),t.push(r.i/i|0),_n(s),_n(s.next),s=e=r),s=s.next}while(s!==e);return Xi(s)}function dy(e,t,i,s,n,r){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&wy(o,a)){var h=vd(o,a);o=Xi(o,o.next),h=Xi(h,h.next),mn(o,t,i,s,n,r,0),mn(h,t,i,s,n,r,0);return}a=a.next}o=o.next}while(o!==e)}function fy(e,t,i,s){var n=[],r,o,a,h,l;for(r=0,o=t.length;r<o;r++)a=t[r]*s,h=r<o-1?t[r+1]*s:e.length,l=xd(e,a,h,s,!1),l===l.next&&(l.steiner=!0),n.push(vy(l));for(n.sort(py),r=0;r<n.length;r++)i=my(n[r],i);return i}function py(e,t){return e.x-t.x}function my(e,t){var i=gy(e,t);if(!i)return t;var s=vd(i,e);return Xi(s,s.next),Xi(i,i.next)}function gy(e,t){var i=t,s=e.x,n=e.y,r=-1/0,o;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var a=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=s&&a>r&&(r=a,o=i.x<i.next.x?i:i.next,a===s))return o}i=i.next}while(i!==t);if(!o)return null;var h=o,l=o.x,c=o.y,u=1/0,d;i=o;do s>=i.x&&i.x>=l&&s!==i.x&&os(n<c?s:r,n,l,c,n<c?r:s,n,i.x,i.y)&&(d=Math.abs(n-i.y)/(s-i.x),gn(i,e)&&(d<u||d===u&&(i.x>o.x||i.x===o.x&&_y(o,i)))&&(o=i,u=d)),i=i.next;while(i!==h);return o}function _y(e,t){return It(e.prev,e,t.prev)<0&&It(t.next,e,e.next)<0}function xy(e,t,i,s){var n=e;do n.z===0&&(n.z=ba(n.x,n.y,t,i,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,yy(n)}function yy(e){var t,i,s,n,r,o,a,h,l=1;do{for(i=e,e=null,r=null,o=0;i;){for(o++,s=i,a=0,t=0;t<l&&(a++,s=s.nextZ,!!s);t++);for(h=l;a>0||h>0&&s;)a!==0&&(h===0||!s||i.z<=s.z)?(n=i,i=i.nextZ,a--):(n=s,s=s.nextZ,h--),r?r.nextZ=n:e=n,n.prevZ=r,r=n;i=s}r.nextZ=null,l*=2}while(o>1);return e}function ba(e,t,i,s,n){return e=(e-i)*n|0,t=(t-s)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function vy(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function os(e,t,i,s,n,r,o,a){return(n-o)*(t-a)>=(e-o)*(r-a)&&(e-o)*(s-a)>=(i-o)*(t-a)&&(i-o)*(r-a)>=(n-o)*(s-a)}function wy(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!by(e,t)&&(gn(e,t)&&gn(t,e)&&Ty(e,t)&&(It(e.prev,e,t.prev)||It(e,t.prev,t))||to(e,t)&&It(e.prev,e,e.next)>0&&It(t.prev,t,t.next)>0)}function It(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function to(e,t){return e.x===t.x&&e.y===t.y}function yd(e,t,i,s){var n=Un(It(e,t,i)),r=Un(It(e,t,s)),o=Un(It(i,s,e)),a=Un(It(i,s,t));return!!(n!==r&&o!==a||n===0&&kn(e,i,t)||r===0&&kn(e,s,t)||o===0&&kn(i,e,s)||a===0&&kn(i,t,s))}function kn(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Un(e){return e>0?1:e<0?-1:0}function by(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&yd(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function gn(e,t){return It(e.prev,e,e.next)<0?It(e,t,e.next)>=0&&It(e,e.prev,t)>=0:It(e,t,e.prev)<0||It(e,e.next,t)<0}function Ty(e,t){var i=e,s=!1,n=(e.x+t.x)/2,r=(e.y+t.y)/2;do i.y>r!=i.next.y>r&&i.next.y!==i.y&&n<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next;while(i!==e);return s}function vd(e,t){var i=new Ta(e.i,e.x,e.y),s=new Ta(t.i,t.x,t.y),n=e.next,r=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,s.next=i,i.prev=s,r.next=s,s.prev=r,s}function tc(e,t,i,s){var n=new Ta(e,t,i);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function _n(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ta(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Qr.deviation=function(e,t,i,s){var n=t&&t.length,r=n?t[0]*i:e.length,o=Math.abs(Ea(e,0,r,i));if(n)for(var a=0,h=t.length;a<h;a++){var l=t[a]*i,c=a<h-1?t[a+1]*i:e.length;o-=Math.abs(Ea(e,l,c,i))}var u=0;for(a=0;a<s.length;a+=3){var d=s[a]*i,f=s[a+1]*i,p=s[a+2]*i;u+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function Ea(e,t,i,s){for(var n=0,r=t,o=i-s;r<i;r+=s)n+=(e[o]-e[r])*(e[r+1]+e[o+1]),o=r;return n}Qr.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},s=0,n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++)for(var o=0;o<t;o++)i.vertices.push(e[n][r][o]);n>0&&(s+=e[n-1].length,i.holes.push(s))}return i};var Ey=Nh.exports;const Ay=gd(Ey);var Pr={exports:{}};/*! https://mths.be/punycode v1.3.2 by @mathias */Pr.exports;(function(e,t){(function(i){var s=t&&!t.nodeType&&t,n=e&&!e.nodeType&&e,r=typeof Io=="object"&&Io;(r.global===r||r.window===r||r.self===r)&&(i=r);var o,a=2147483647,h=36,l=1,c=26,u=38,d=700,f=72,p=128,m="-",g=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=h-l,A=Math.floor,T=String.fromCharCode,I;function S(B){throw RangeError(_[B])}function G(B,J){for(var rt=B.length,mt=[];rt--;)mt[rt]=J(B[rt]);return mt}function H(B,J){var rt=B.split("@"),mt="";rt.length>1&&(mt=rt[0]+"@",B=rt[1]),B=B.replace(v,".");var yt=B.split("."),Dt=G(yt,J).join(".");return mt+Dt}function N(B){for(var J=[],rt=0,mt=B.length,yt,Dt;rt<mt;)yt=B.charCodeAt(rt++),yt>=55296&&yt<=56319&&rt<mt?(Dt=B.charCodeAt(rt++),(Dt&64512)==56320?J.push(((yt&1023)<<10)+(Dt&1023)+65536):(J.push(yt),rt--)):J.push(yt);return J}function $(B){return G(B,function(J){var rt="";return J>65535&&(J-=65536,rt+=T(J>>>10&1023|55296),J=56320|J&1023),rt+=T(J),rt}).join("")}function D(B){return B-48<10?B-22:B-65<26?B-65:B-97<26?B-97:h}function M(B,J){return B+22+75*(B<26)-((J!=0)<<5)}function ht(B,J,rt){var mt=0;for(B=rt?A(B/d):B>>1,B+=A(B/J);B>x*c>>1;mt+=h)B=A(B/x);return A(mt+(x+1)*B/(B+u))}function it(B){var J=[],rt=B.length,mt,yt=0,Dt=p,xt=f,St,Lt,Bt,Mt,vt,w,b,E,P;for(St=B.lastIndexOf(m),St<0&&(St=0),Lt=0;Lt<St;++Lt)B.charCodeAt(Lt)>=128&&S("not-basic"),J.push(B.charCodeAt(Lt));for(Bt=St>0?St+1:0;Bt<rt;){for(Mt=yt,vt=1,w=h;Bt>=rt&&S("invalid-input"),b=D(B.charCodeAt(Bt++)),(b>=h||b>A((a-yt)/vt))&&S("overflow"),yt+=b*vt,E=w<=xt?l:w>=xt+c?c:w-xt,!(b<E);w+=h)P=h-E,vt>A(a/P)&&S("overflow"),vt*=P;mt=J.length+1,xt=ht(yt-Mt,mt,Mt==0),A(yt/mt)>a-Dt&&S("overflow"),Dt+=A(yt/mt),yt%=mt,J.splice(yt++,0,Dt)}return $(J)}function O(B){var J,rt,mt,yt,Dt,xt,St,Lt,Bt,Mt,vt,w=[],b,E,P,R;for(B=N(B),b=B.length,J=p,rt=0,Dt=f,xt=0;xt<b;++xt)vt=B[xt],vt<128&&w.push(T(vt));for(mt=yt=w.length,yt&&w.push(m);mt<b;){for(St=a,xt=0;xt<b;++xt)vt=B[xt],vt>=J&&vt<St&&(St=vt);for(E=mt+1,St-J>A((a-rt)/E)&&S("overflow"),rt+=(St-J)*E,J=St,xt=0;xt<b;++xt)if(vt=B[xt],vt<J&&++rt>a&&S("overflow"),vt==J){for(Lt=rt,Bt=h;Mt=Bt<=Dt?l:Bt>=Dt+c?c:Bt-Dt,!(Lt<Mt);Bt+=h)R=Lt-Mt,P=h-Mt,w.push(T(M(Mt+R%P,0))),Lt=A(R/P);w.push(T(M(Lt,0))),Dt=ht(rt,E,mt==yt),rt=0,++mt}++rt,++J}return w.join("")}function Z(B){return H(B,function(J){return g.test(J)?it(J.slice(4).toLowerCase()):J})}function _t(B){return H(B,function(J){return y.test(J)?"xn--"+O(J):J})}if(o={version:"1.3.2",ucs2:{decode:N,encode:$},decode:it,encode:O,toASCII:_t,toUnicode:Z},s&&n)if(e.exports==s)n.exports=o;else for(I in o)o.hasOwnProperty(I)&&(s[I]=o[I]);else i.punycode=o})(Io)})(Pr,Pr.exports);var Sy=Pr.exports,Cy={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},xn={};function Iy(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Py=function(e,t,i,s){t=t||"&",i=i||"=";var n={};if(typeof e!="string"||e.length===0)return n;var r=/\+/g;e=e.split(t);var o=1e3;s&&typeof s.maxKeys=="number"&&(o=s.maxKeys);var a=e.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var l=e[h].replace(r,"%20"),c=l.indexOf(i),u,d,f,p;c>=0?(u=l.substr(0,c),d=l.substr(c+1)):(u=l,d=""),f=decodeURIComponent(u),p=decodeURIComponent(d),Iy(n,f)?Array.isArray(n[f])?n[f].push(p):n[f]=[n[f],p]:n[f]=p}return n},Ns=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},My=function(e,t,i,s){return t=t||"&",i=i||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(n){var r=encodeURIComponent(Ns(n))+i;return Array.isArray(e[n])?e[n].map(function(o){return r+encodeURIComponent(Ns(o))}).join(t):r+encodeURIComponent(Ns(e[n]))}).join(t):s?encodeURIComponent(Ns(s))+i+encodeURIComponent(Ns(e)):""};xn.decode=xn.parse=Py;xn.encode=xn.stringify=My;var Ry=Sy,Ue=Cy,Dy=eo,By=$y,Fy=Xy;function Ie(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Ny=/^([a-z0-9.+-]+:)/i,Oy=/:[0-9]*$/,Ly=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,ky=["<",">",'"',"`"," ","\r",`
`,"	"],Uy=["{","}","|","\\","^","`"].concat(ky),Aa=["'"].concat(Uy),ec=["%","/","?",";","#"].concat(Aa),ic=["/","?","#"],Hy=255,sc=/^[+a-z0-9A-Z_-]{0,63}$/,Gy=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wy={javascript:!0,"javascript:":!0},Sa={javascript:!0,"javascript:":!0},fs={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ca=xn;function eo(e,t,i){if(e&&Ue.isObject(e)&&e instanceof Ie)return e;var s=new Ie;return s.parse(e,t,i),s}Ie.prototype.parse=function(e,t,i){if(!Ue.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),n=s!==-1&&s<e.indexOf("#")?"?":"#",r=e.split(n),o=/\\/g;r[0]=r[0].replace(o,"/"),e=r.join(n);var a=e;if(a=a.trim(),!i&&e.split("#").length===1){var h=Ly.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=Ca.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=Ny.exec(a);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,a=a.substr(l.length)}if(i||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=a.substr(0,2)==="//";u&&!(l&&Sa[l])&&(a=a.substr(2),this.slashes=!0)}if(!Sa[l]&&(u||l&&!fs[l])){for(var d=-1,f=0;f<ic.length;f++){var p=a.indexOf(ic[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var m,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(m=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<ec.length;f++){var p=a.indexOf(ec[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var v=this.hostname.split(/\./),f=0,_=v.length;f<_;f++){var x=v[f];if(x&&!x.match(sc)){for(var A="",T=0,I=x.length;T<I;T++)x.charCodeAt(T)>127?A+="x":A+=x[T];if(!A.match(sc)){var S=v.slice(0,f),G=v.slice(f+1),H=x.match(Gy);H&&(S.push(H[1]),G.unshift(H[2])),G.length&&(a="/"+G.join(".")+a),this.hostname=S.join(".");break}}}this.hostname.length>Hy?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Ry.toASCII(this.hostname));var N=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+N,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Wy[c])for(var f=0,_=Aa.length;f<_;f++){var D=Aa[f];if(a.indexOf(D)!==-1){var M=encodeURIComponent(D);M===D&&(M=escape(D)),a=a.split(D).join(M)}}var ht=a.indexOf("#");ht!==-1&&(this.hash=a.substr(ht),a=a.slice(0,ht));var it=a.indexOf("?");if(it!==-1?(this.search=a.substr(it),this.query=a.substr(it+1),t&&(this.query=Ca.parse(this.query)),a=a.slice(0,it)):t&&(this.search="",this.query={}),a&&(this.pathname=a),fs[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",O=this.search||"";this.path=N+O}return this.href=this.format(),this};function Xy(e){return Ue.isString(e)&&(e=eo(e)),e instanceof Ie?e.format():Ie.prototype.format.call(e)}Ie.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",s=this.hash||"",n=!1,r="";this.host?n=e+this.host:this.hostname&&(n=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&Ue.isObject(this.query)&&Object.keys(this.query).length&&(r=Ca.stringify(this.query));var o=this.search||r&&"?"+r||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||fs[t])&&n!==!1?(n="//"+(n||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):n||(n=""),s&&s.charAt(0)!=="#"&&(s="#"+s),o&&o.charAt(0)!=="?"&&(o="?"+o),i=i.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+n+i+o+s};function $y(e,t){return eo(e,!1,!0).resolve(t)}Ie.prototype.resolve=function(e){return this.resolveObject(eo(e,!1,!0)).format()};Ie.prototype.resolveObject=function(e){if(Ue.isString(e)){var t=new Ie;t.parse(e,!1,!0),e=t}for(var i=new Ie,s=Object.keys(this),n=0;n<s.length;n++){var r=s[n];i[r]=this[r]}if(i.hash=e.hash,e.href==="")return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(i[h]=e[h])}return fs[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!fs[e.protocol]){for(var l=Object.keys(e),c=0;c<l.length;c++){var u=l[c];i[u]=e[u]}return i.href=i.format(),i}if(i.protocol=e.protocol,!e.host&&!Sa[e.protocol]){for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),i.pathname=_.join("/")}else i.pathname=e.pathname;if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var d=i.pathname||"",f=i.search||"";i.path=d+f}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var p=i.pathname&&i.pathname.charAt(0)==="/",m=e.host||e.pathname&&e.pathname.charAt(0)==="/",g=m||p||i.host&&e.pathname,y=g,v=i.pathname&&i.pathname.split("/")||[],_=e.pathname&&e.pathname.split("/")||[],x=i.protocol&&!fs[i.protocol];if(x&&(i.hostname="",i.port=null,i.host&&(v[0]===""?v[0]=i.host:v.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host=null),g=g&&(_[0]===""||v[0]==="")),m)i.host=e.host||e.host===""?e.host:i.host,i.hostname=e.hostname||e.hostname===""?e.hostname:i.hostname,i.search=e.search,i.query=e.query,v=_;else if(_.length)v||(v=[]),v.pop(),v=v.concat(_),i.search=e.search,i.query=e.query;else if(!Ue.isNullOrUndefined(e.search)){if(x){i.hostname=i.host=v.shift();var A=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;A&&(i.auth=A.shift(),i.host=i.hostname=A.shift())}return i.search=e.search,i.query=e.query,(!Ue.isNull(i.pathname)||!Ue.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!v.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var T=v.slice(-1)[0],I=(i.host||e.host||v.length>1)&&(T==="."||T==="..")||T==="",S=0,G=v.length;G>=0;G--)T=v[G],T==="."?v.splice(G,1):T===".."?(v.splice(G,1),S++):S&&(v.splice(G,1),S--);if(!g&&!y)for(;S--;S)v.unshift("..");g&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),I&&v.join("/").substr(-1)!=="/"&&v.push("");var H=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(x){i.hostname=i.host=H?"":v.length?v.shift():"";var A=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;A&&(i.auth=A.shift(),i.host=i.hostname=A.shift())}return g=g||i.host&&v.length,g&&!H&&v.unshift(""),v.length?i.pathname=v.join("/"):(i.pathname=null,i.path=null),(!Ue.isNull(i.pathname)||!Ue.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i};Ie.prototype.parseHost=function(){var e=this.host,t=Oy.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const zy={parse:Dy,format:Fy,resolve:By};function de(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Os(e){return e.split("?")[0].split("#")[0]}function Vy(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jy(e,t,i){return e.replace(new RegExp(Vy(t),"g"),i)}function Yy(e,t){let i="",s=0,n=-1,r=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||r===1))if(n!==a-1&&r===2){if(i.length<2||s!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){const h=i.lastIndexOf("/");if(h!==i.length-1){h===-1?(i="",s=0):(i=i.slice(0,h),s=i.length-1-i.lastIndexOf("/")),n=a,r=0;continue}}else if(i.length===2||i.length===1){i="",s=0,n=a,r=0;continue}}t&&(i.length>0?i+="/..":i="..",s=2)}else i.length>0?i+=`/${e.slice(n+1,a)}`:i=e.slice(n+1,a),s=a-n-1;n=a,r=0}else o===46&&r!==-1?++r:r=-1}return i}const Kt={toPosix(e){return jy(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){de(e),e=this.toPosix(e);let t="";const i=/^file:\/\/\//.exec(e),s=/^[^/:]+:\/\//.exec(e),n=/^[^/:]+:\//.exec(e);if(i||s||n){const r=(i==null?void 0:i[0])||(s==null?void 0:s[0])||(n==null?void 0:n[0]);t=r,e=e.slice(r.length)}return t},toAbsolute(e,t,i){if(this.isDataUrl(e))return e;const s=Os(this.toPosix(t??z.ADAPTER.getBaseUrl())),n=Os(this.toPosix(i??this.rootname(s)));return de(e),e=this.toPosix(e),e.startsWith("/")?Kt.join(n,e.slice(1)):this.isAbsolute(e)?e:this.join(s,e)},normalize(e){if(e=this.toPosix(e),de(e),e.length===0)return".";let t="";const i=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const s=e.endsWith("/");return e=Yy(e,!1),e.length>0&&s&&(e+="/"),i?`/${e}`:t+e},isAbsolute(e){return de(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let i=0;i<e.length;++i){const s=e[i];if(de(s),s.length>0)if(t===void 0)t=s;else{const n=e[i-1]??"";this.extname(n)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(de(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const i=t===47;let s=-1,n=!0;const r=this.getProtocol(e),o=e;e=e.slice(r.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!n){s=a;break}}else n=!1;return s===-1?i?"/":this.isUrl(o)?r+e:r:i&&s===1?"//":r+e.slice(0,s)},rootname(e){de(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const i=e.indexOf("/",t.length);i!==-1?t=e.slice(0,i):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){de(e),t&&de(t),e=Os(this.toPosix(e));let i=0,s=-1,n=!0,r;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(r=e.length-1;r>=0;--r){const h=e.charCodeAt(r);if(h===47){if(!n){i=r+1;break}}else a===-1&&(n=!1,a=r+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=r):(o=-1,s=a))}return i===s?s=a:s===-1&&(s=e.length),e.slice(i,s)}for(r=e.length-1;r>=0;--r)if(e.charCodeAt(r)===47){if(!n){i=r+1;break}}else s===-1&&(n=!1,s=r+1);return s===-1?"":e.slice(i,s)},extname(e){de(e),e=Os(this.toPosix(e));let t=-1,i=0,s=-1,n=!0,r=0;for(let o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);if(a===47){if(!n){i=o+1;break}continue}s===-1&&(n=!1,s=o+1),a===46?t===-1?t=o:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||s===-1||r===0||r===1&&t===s-1&&t===i+1?"":e.slice(t,s)},parse(e){de(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Os(this.toPosix(e));let i=e.charCodeAt(0);const s=this.isAbsolute(e);let n;t.root=this.rootname(e),s||this.hasProtocol(e)?n=1:n=0;let r=-1,o=0,a=-1,h=!0,l=e.length-1,c=0;for(;l>=n;--l){if(i=e.charCodeAt(l),i===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),i===46?r===-1?r=l:c!==1&&(c=1):r!==-1&&(c=-1)}return r===-1||a===-1||c===0||c===1&&r===a-1&&r===o+1?a!==-1&&(o===0&&s?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(o,a)):(o===0&&s?(t.name=e.slice(1,r),t.base=e.slice(1,a)):(t.name=e.slice(o,r),t.base=e.slice(o,a)),t.ext=e.slice(r,a)),t.dir=this.dirname(e),t},sep:"/",delimiter:":"},nc={};function ft(e,t,i=3){if(nc[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(s=s.split(`
`).splice(i).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(s))),nc[t]=!0}let Po;function Ky(){return typeof Po>"u"&&(Po=function(){var i;const t={stencil:!0,failIfMajorPerformanceCaveat:z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!z.ADAPTER.getWebGLRenderingContext())return!1;const s=z.ADAPTER.createCanvas();let n=s.getContext("webgl",t)||s.getContext("experimental-webgl",t);const r=!!((i=n==null?void 0:n.getContextAttributes())!=null&&i.stencil);if(n){const o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,r}catch{return!1}}()),Po}var qy={grad:.9,turn:360,rad:360/(2*Math.PI)},qe=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},Ut=function(e,t,i){return t===void 0&&(t=0),i===void 0&&(i=Math.pow(10,t)),Math.round(i*e)/i+0},le=function(e,t,i){return t===void 0&&(t=0),i===void 0&&(i=1),e>i?i:e>t?e:t},wd=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},rc=function(e){return{r:le(e.r,0,255),g:le(e.g,0,255),b:le(e.b,0,255),a:le(e.a)}},Mo=function(e){return{r:Ut(e.r),g:Ut(e.g),b:Ut(e.b),a:Ut(e.a,3)}},Zy=/^#([0-9a-f]{3,8})$/i,Hn=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},bd=function(e){var t=e.r,i=e.g,s=e.b,n=e.a,r=Math.max(t,i,s),o=r-Math.min(t,i,s),a=o?r===t?(i-s)/o:r===i?2+(s-t)/o:4+(t-i)/o:0;return{h:60*(a<0?a+6:a),s:r?o/r*100:0,v:r/255*100,a:n}},Td=function(e){var t=e.h,i=e.s,s=e.v,n=e.a;t=t/360*6,i/=100,s/=100;var r=Math.floor(t),o=s*(1-i),a=s*(1-(t-r)*i),h=s*(1-(1-t+r)*i),l=r%6;return{r:255*[s,a,o,o,h,s][l],g:255*[h,s,s,a,o,o][l],b:255*[o,o,h,s,s,a][l],a:n}},oc=function(e){return{h:wd(e.h),s:le(e.s,0,100),l:le(e.l,0,100),a:le(e.a)}},ac=function(e){return{h:Ut(e.h),s:Ut(e.s),l:Ut(e.l),a:Ut(e.a,3)}},hc=function(e){return Td((i=(t=e).s,{h:t.h,s:(i*=((s=t.l)<50?s:100-s)/100)>0?2*i/(s+i)*100:0,v:s+i,a:t.a}));var t,i,s},en=function(e){return{h:(t=bd(e)).h,s:(n=(200-(i=t.s))*(s=t.v)/100)>0&&n<200?i*s/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,i,s,n},Jy=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qy=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tv=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ev=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ia={string:[[function(e){var t=Zy.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?Ut(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?Ut(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=tv.exec(e)||ev.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:rc({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=Jy.exec(e)||Qy.exec(e);if(!t)return null;var i,s,n=oc({h:(i=t[1],s=t[2],s===void 0&&(s="deg"),Number(i)*(qy[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return hc(n)},"hsl"]],object:[[function(e){var t=e.r,i=e.g,s=e.b,n=e.a,r=n===void 0?1:n;return qe(t)&&qe(i)&&qe(s)?rc({r:Number(t),g:Number(i),b:Number(s),a:Number(r)}):null},"rgb"],[function(e){var t=e.h,i=e.s,s=e.l,n=e.a,r=n===void 0?1:n;if(!qe(t)||!qe(i)||!qe(s))return null;var o=oc({h:Number(t),s:Number(i),l:Number(s),a:Number(r)});return hc(o)},"hsl"],[function(e){var t=e.h,i=e.s,s=e.v,n=e.a,r=n===void 0?1:n;if(!qe(t)||!qe(i)||!qe(s))return null;var o=function(a){return{h:wd(a.h),s:le(a.s,0,100),v:le(a.v,0,100),a:le(a.a)}}({h:Number(t),s:Number(i),v:Number(s),a:Number(r)});return Td(o)},"hsv"]]},lc=function(e,t){for(var i=0;i<t.length;i++){var s=t[i][0](e);if(s)return[s,t[i][1]]}return[null,void 0]},iv=function(e){return typeof e=="string"?lc(e.trim(),Ia.string):typeof e=="object"&&e!==null?lc(e,Ia.object):[null,void 0]},Ro=function(e,t){var i=en(e);return{h:i.h,s:le(i.s+100*t,0,100),l:i.l,a:i.a}},Do=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},cc=function(e,t){var i=en(e);return{h:i.h,s:i.s,l:le(i.l+100*t,0,100),a:i.a}},Pa=function(){function e(t){this.parsed=iv(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return Ut(Do(this.rgba),2)},e.prototype.isDark=function(){return Do(this.rgba)<.5},e.prototype.isLight=function(){return Do(this.rgba)>=.5},e.prototype.toHex=function(){return t=Mo(this.rgba),i=t.r,s=t.g,n=t.b,o=(r=t.a)<1?Hn(Ut(255*r)):"","#"+Hn(i)+Hn(s)+Hn(n)+o;var t,i,s,n,r,o},e.prototype.toRgb=function(){return Mo(this.rgba)},e.prototype.toRgbString=function(){return t=Mo(this.rgba),i=t.r,s=t.g,n=t.b,(r=t.a)<1?"rgba("+i+", "+s+", "+n+", "+r+")":"rgb("+i+", "+s+", "+n+")";var t,i,s,n,r},e.prototype.toHsl=function(){return ac(en(this.rgba))},e.prototype.toHslString=function(){return t=ac(en(this.rgba)),i=t.h,s=t.s,n=t.l,(r=t.a)<1?"hsla("+i+", "+s+"%, "+n+"%, "+r+")":"hsl("+i+", "+s+"%, "+n+"%)";var t,i,s,n,r},e.prototype.toHsv=function(){return t=bd(this.rgba),{h:Ut(t.h),s:Ut(t.s),v:Ut(t.v),a:Ut(t.a,3)};var t},e.prototype.invert=function(){return Ne({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Ne(Ro(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ne(Ro(this.rgba,-t))},e.prototype.grayscale=function(){return Ne(Ro(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Ne(cc(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Ne(cc(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Ne({r:(i=this.rgba).r,g:i.g,b:i.b,a:t}):Ut(this.rgba.a,3);var i},e.prototype.hue=function(t){var i=en(this.rgba);return typeof t=="number"?Ne({h:t,s:i.s,l:i.l,a:i.a}):Ut(i.h)},e.prototype.isEqual=function(t){return this.toHex()===Ne(t).toHex()},e}(),Ne=function(e){return e instanceof Pa?e:new Pa(e)},uc=[],sv=function(e){e.forEach(function(t){uc.indexOf(t)<0&&(t(Pa,Ia),uc.push(t))})};function nv(e,t){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var n in i)s[i[n]]=n;var r={};e.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=s[this.toHex()];if(l)return l;if(o!=null&&o.closest){var c=this.toRgb(),u=1/0,d="black";if(!r.length)for(var f in i)r[f]=new e(i[f]).toRgb();for(var p in i){var m=(a=c,h=r[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));m<u&&(u=m,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":i[a];return h?new e(h).toRgb():null},"name"])}sv([nv]);const ps=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof ps)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((n,r)=>n===t[r]);if(e!==null&&t!==null){const n=Object.keys(e),r=Object.keys(t);return n.length!==r.length?!1:n.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,i,s]=this._components;return{r:e,g:t,b:i,a:s}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,s]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(s*255),e}toRgbArray(e){e=e??[];const[t,i,s]=this._components;return e[0]=t,e[1]=i,e[2]=s,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,s,n]=ps.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=s,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return t&&(i=i*e+.5|0,s=s*e+.5|0,n=n*e+.5|0),(e*255<<24)+(i<<16)+(s<<8)+n}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,i,s]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(s*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,i,s,n]=this._components;return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e}normalize(e){let t,i,s,n;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const r=e;t=(r>>16&255)/255,i=(r>>8&255)/255,s=(r&255)/255,n=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,s,n=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,s,n=255]=e,t/=255,i/=255,s/=255,n/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=ps.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const r=Ne(e);r.isValid()&&({r:t,g:i,b:s,a:n}=r.rgba,t/=255,i/=255,s/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=s,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((s,n)=>{e[n]=Math.min(Math.max(s,t),i)}),e)}};let bt=ps;bt.shared=new ps;bt.temp=new ps;bt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function rv(e){return ft("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),bt.shared.setValue(e).toHex()}function ov(e){return ft("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),bt.shared.setValue(e).toNumber()}function av(){const e=[],t=[];for(let s=0;s<32;s++)e[s]=s,t[s]=s;e[nt.NORMAL_NPM]=nt.NORMAL,e[nt.ADD_NPM]=nt.ADD,e[nt.SCREEN_NPM]=nt.SCREEN,t[nt.NORMAL]=nt.NORMAL_NPM,t[nt.ADD]=nt.ADD_NPM,t[nt.SCREEN]=nt.SCREEN_NPM;const i=[];return i.push(t),i.push(e),i}const Ed=av();function Ad(e,t){return Ed[t?1:0][e]}function hv(e,t=null){const i=e*6;if(t=t||new Uint16Array(i),t.length!==i)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${i}`);for(let s=0,n=0;s<i;s+=6,n+=4)t[s+0]=n+0,t[s+1]=n+1,t[s+2]=n+2,t[s+3]=n+0,t[s+4]=n+2,t[s+5]=n+3;return t}function Sd(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}function Mr(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function dc(e){return!(e&e-1)&&!!e}function fc(e){let t=(e>65535?1:0)<<4;e>>>=t;let i=(e>255?1:0)<<3;return e>>>=i,t|=i,i=(e>15?1:0)<<2,e>>>=i,t|=i,i=(e>3?1:0)<<1,e>>>=i,t|=i,t|e>>1}function ms(e,t,i){const s=e.length;let n;if(t>=s||i===0)return;i=t+i>s?s-t:i;const r=s-i;for(n=t;n<r;++n)e[n]=e[n+i];e.length=r}function mi(e){return e===0?0:e<0?-1:1}let lv=0;function $i(){return++lv}const Cd=class{constructor(e,t,i,s){this.left=e,this.top=t,this.right=i,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Ma=Cd;Ma.EMPTY=new Cd(0,0,0,0);const pc={},Oe=Object.create(null),li=Object.create(null);class cv{constructor(t,i,s){this._canvas=z.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||z.RESOLUTION,this.resize(t,i)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,i){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(i*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function mc(e,t,i){for(let s=0,n=4*i*t;s<t;++s,n+=4)if(e[n+3]!==0)return!1;return!0}function gc(e,t,i,s,n){const r=4*t;for(let o=s,a=s*r+4*i;o<=n;++o,a+=r)if(e[a+3]!==0)return!1;return!0}function uv(e){const{width:t,height:i}=e,s=e.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const r=s.getImageData(0,0,t,i).data;let o=0,a=0,h=t-1,l=i-1;for(;a<i&&mc(r,t,a);)++a;if(a===i)return Ma.EMPTY;for(;mc(r,t,l);)--l;for(;gc(r,t,o,a,l);)++o;for(;gc(r,t,h,a,l);)--h;return++h,++l,new Ma(o,a,h,l)}function dv(e){const t=uv(e),{width:i,height:s}=t;let n=null;if(!t.isEmpty()){const r=e.getContext("2d");if(r===null)throw new TypeError("Failed to get canvas 2D context");n=r.getImageData(t.left,t.top,i,s)}return{width:i,height:s,data:n}}let Gn;function fv(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Gn||(Gn=document.createElement("a")),Gn.href=e;const i=zy.parse(Gn.href),s=!i.port&&t.port===""||i.port===t.port;return i.hostname!==t.hostname||!s||i.protocol!==t.protocol?"anonymous":""}function bi(e,t=1){var s;const i=(s=z.RETINA_PREFIX)==null?void 0:s.exec(e);return i?parseFloat(i[1]):t}var V=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(V||{});const Ra=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},_c=(e,t)=>Ra(e).priority??t,q={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Ra).forEach(t=>{t.type.forEach(i=>{var s,n;return(n=(s=this._removeHandlers)[i])==null?void 0:n.call(s,t)})}),this},add(...e){return e.map(Ra).forEach(t=>{t.type.forEach(i=>{const s=this._addHandlers,n=this._queue;s[i]?s[i](t):(n[i]=n[i]||[],n[i].push(t))})}),this},handle(e,t,i){const s=this._addHandlers,n=this._removeHandlers;if(s[e]||n[e])throw new Error(`Extension type ${e} already has a handler`);s[e]=t,n[e]=i;const r=this._queue;return r[e]&&(r[e].forEach(o=>t(o)),delete r[e]),this},handleByMap(e,t){return this.handle(e,i=>{t[i.name]=i.ref},i=>{delete t[i.name]})},handleByList(e,t,i=-1){return this.handle(e,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((n,r)=>_c(r,i)-_c(n,i)))},s=>{const n=t.indexOf(s.ref);n!==-1&&t.splice(n,1)})}};class Da{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const pv=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function mv(e){let t="";for(let i=0;i<e;++i)i>0&&(t+=`
else `),i<e-1&&(t+=`if(test == ${i}.0){}`);return t}function gv(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=pv.replace(/%forloop%/gi,mv(e));if(t.shaderSource(i,s),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))e=e/2|0;else break}return e}const Bo=0,Fo=1,No=2,Oo=3,Lo=4,ko=5;class ai{constructor(){this.data=0,this.blendMode=nt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Bo)}set blend(t){!!(this.data&1<<Bo)!==t&&(this.data^=1<<Bo)}get offsets(){return!!(this.data&1<<Fo)}set offsets(t){!!(this.data&1<<Fo)!==t&&(this.data^=1<<Fo)}get culling(){return!!(this.data&1<<No)}set culling(t){!!(this.data&1<<No)!==t&&(this.data^=1<<No)}get depthTest(){return!!(this.data&1<<Oo)}set depthTest(t){!!(this.data&1<<Oo)!==t&&(this.data^=1<<Oo)}get depthMask(){return!!(this.data&1<<ko)}set depthMask(t){!!(this.data&1<<ko)!==t&&(this.data^=1<<ko)}get clockwiseFrontFace(){return!!(this.data&1<<Lo)}set clockwiseFrontFace(t){!!(this.data&1<<Lo)!==t&&(this.data^=1<<Lo)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==nt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new ai;return t.depthTest=!1,t.blend=!0,t}}const Ba=[];function Id(e,t){if(!e)return null;let i="";if(typeof e=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);s&&(i=s[1].toLowerCase())}for(let s=Ba.length-1;s>=0;--s){const n=Ba[s];if(n.test&&n.test(e,i))return new n(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Pe{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,i,s,n,r,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][l](t,i,s,n,r,o,a,h);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const i=this.items.indexOf(t);return i!==-1&&(this.ensureNonAliasedItems(),this.items.splice(i,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Pe.prototype,{dispatch:{value:Pe.prototype.emit},run:{value:Pe.prototype.emit}});class yn{constructor(t=0,i=0){this._width=t,this._height=i,this.destroyed=!1,this.internal=!1,this.onResize=new Pe("setRealSize"),this.onUpdate=new Pe("update"),this.onError=new Pe("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,i){(t!==this._width||i!==this._height)&&(this._width=t,this._height=i,this.onResize.emit(t,i))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,i,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,i){return!1}}class An extends yn{constructor(t,i){const{width:s,height:n}=i||{};if(!s||!n)throw new Error("BufferResource width or height invalid");super(s,n),this.data=t}upload(t,i,s){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===De.UNPACK);const r=i.realWidth,o=i.realHeight;return s.width===r&&s.height===o?n.texSubImage2D(i.target,0,0,0,r,o,i.format,s.type,this.data):(s.width=r,s.height=o,n.texImage2D(i.target,0,s.internalFormat,r,o,0,i.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const _v={scaleMode:ti.NEAREST,format:U.RGBA,alphaMode:De.NPM},ts=class extends En{constructor(e=null,t=null){super(),t=Object.assign({},ts.defaultOptions,t);const{alphaMode:i,mipmap:s,anisotropicLevel:n,scaleMode:r,width:o,height:a,wrapMode:h,format:l,type:c,target:u,resolution:d,resourceOptions:f}=t;e&&!(e instanceof yn)&&(e=Id(e,f),e.internal=!0),this.resolution=d||z.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=n,this._wrapMode=h,this._scaleMode=r,this.format=l,this.type=c,this.target=u,this.alphaMode=i,this.uid=$i(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,i=!0),i&&this.dirtyStyleId++,this}setSize(e,t,i){return i=i||this.resolution,this.setRealSize(e*i,t*i,i)}setRealSize(e,t,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=dc(this.realWidth)&&dc(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete li[this.cacheId],delete Oe[this.cacheId],this.cacheId=null),this.dispose(),ts.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,i=z.STRICT_TEXTURE_CACHE){const s=typeof e=="string";let n=null;if(s)n=e;else{if(!e._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${o}_${$i()}`}n=e._pixiId}let r=li[n];if(s&&i&&!r)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return r||(r=new ts(e,t),r.cacheId=n,ts.addToCache(r,n)),r}static fromBuffer(e,t,i,s){e=e||new Float32Array(t*i*4);const n=new An(e,{width:t,height:i}),r=e instanceof Float32Array?et.FLOAT:et.UNSIGNED_BYTE;return new ts(n,Object.assign({},_v,{type:r},s))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),li[t]&&li[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),li[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=li[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete li[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete li[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};let at=ts;at.defaultOptions={mipmap:ze.POW2,anisotropicLevel:0,scaleMode:ti.LINEAR,wrapMode:vi.CLAMP,alphaMode:De.UNPACK,target:ds.TEXTURE_2D,format:U.RGBA,type:et.UNSIGNED_BYTE};at._globalBatch=0;class Fa{constructor(){this.texArray=null,this.blend=0,this.type=Ge.TRIANGLES,this.start=0,this.size=0,this.data=null}}let xv=0;class Rt{constructor(t,i=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=i,this.id=xv++,this.disposeRunner=new Pe("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Xe.ELEMENT_ARRAY_BUFFER:Xe.ARRAY_BUFFER}get index(){return this.type===Xe.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Rt(t)}}class Rr{constructor(t,i=0,s=!1,n=et.FLOAT,r,o,a,h=1){this.buffer=t,this.size=i,this.normalized=s,this.type=n,this.stride=r,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,i,s,n,r){return new Rr(t,i,s,n,r)}}const yv={Float32Array,Uint32Array,Int32Array,Uint8Array};function vv(e,t){let i=0,s=0;const n={};for(let h=0;h<e.length;h++)s+=t[h],i+=e[h].length;const r=new ArrayBuffer(i*4);let o=null,a=0;for(let h=0;h<e.length;h++){const l=t[h],c=e[h],u=Sd(c);n[u]||(n[u]=new yv[u](r)),o=n[u];for(let d=0;d<c.length;d++){const f=(d/l|0)*s+a,p=d%l;o[f+p]=c[d]}a+=l}return new Float32Array(r)}const xc={5126:4,5123:2,5121:1};let wv=0;const bv={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Ti{constructor(t=[],i={}){this.buffers=t,this.indexBuffer=null,this.attributes=i,this.glVertexArrayObjects={},this.id=wv++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Pe("disposeGeometry"),this.refCount=0}addAttribute(t,i,s=0,n=!1,r,o,a,h=!1){if(!i)throw new Error("You must pass a buffer when creating an attribute");i instanceof Rt||(i instanceof Array&&(i=new Float32Array(i)),i=new Rt(i));const l=t.split("|");if(l.length>1){for(let u=0;u<l.length;u++)this.addAttribute(l[u],i,s,n,r);return this}let c=this.buffers.indexOf(i);return c===-1&&(this.buffers.push(i),c=this.buffers.length-1),this.attributes[t]=new Rr(c,s,n,r,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Rt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Rt(t)),t.type=Xe.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],i=[],s=new Rt;let n;for(n in this.attributes){const r=this.attributes[n],o=this.buffers[r.buffer];t.push(o.data),i.push(r.size*xc[r.type]/4),r.buffer=0}for(s.data=vv(t,i),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const i=this.attributes[t];return this.buffers[i.buffer].data.length/(i.stride/4||i.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Ti;for(let i=0;i<this.buffers.length;i++)t.buffers[i]=new Rt(this.buffers[i].data.slice(0));for(const i in this.attributes){const s=this.attributes[i];t.attributes[i]=new Rr(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Xe.ELEMENT_ARRAY_BUFFER),t}static merge(t){const i=new Ti,s=[],n=[],r=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)n[h]=n[h]||0,n[h]+=o.buffers[h].data.length,r[h]=0}for(let a=0;a<o.buffers.length;a++)s[a]=new bv[Sd(o.buffers[a].data)](n[a]),i.buffers[a]=new Rt(s[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h].set(o.buffers[h].data,r[h]),r[h]+=o.buffers[h].data.length}if(i.attributes=o.attributes,o.indexBuffer){i.indexBuffer=i.buffers[o.buffers.indexOf(o.indexBuffer)],i.indexBuffer.type=Xe.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(const u in o.attributes){const d=o.attributes[u];(d.buffer|0)===c&&(h+=d.size*xc[d.type]/4)}for(let u=0;u<t.length;u++){const d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)i.indexBuffer.data[f+l]+=a;a+=t[u].buffers[c].data.length/h,l+=d.length}}return i}}class Pd extends Ti{constructor(t=!1){super(),this._buffer=new Rt(null,t,!1),this._indexBuffer=new Rt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,et.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,et.FLOAT).addAttribute("aColor",this._buffer,4,!0,et.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,et.FLOAT).addIndex(this._indexBuffer)}}const Dr=Math.PI*2,Tv=180/Math.PI,Ev=Math.PI/180;var $t=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))($t||{});class st{constructor(t=0,i=0){this.x=0,this.y=0,this.x=t,this.y=i}clone(){return new st(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,i=t){return this.x=t,this.y=i,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Wn=[new st,new st,new st,new st];class lt{constructor(t=0,i=0,s=0,n=0){this.x=Number(t),this.y=Number(i),this.width=Number(s),this.height=Number(n),this.type=$t.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new lt(0,0,0,0)}clone(){return new lt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,i){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height}intersects(t,i){if(!i){const S=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=S)return!1;const H=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>H}const s=this.left,n=this.right,r=this.top,o=this.bottom;if(n<=s||o<=r)return!1;const a=Wn[0].set(t.left,t.top),h=Wn[1].set(t.left,t.bottom),l=Wn[2].set(t.right,t.top),c=Wn[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(i.a*i.d-i.b*i.c);if(u===0||(i.apply(a,a),i.apply(h,h),i.apply(l,l),i.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=s||Math.min(a.x,h.x,l.x,c.x)>=n||Math.max(a.y,h.y,l.y,c.y)<=r||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*s+f*r,m=d*n+f*r,g=d*s+f*o,y=d*n+f*o;if(Math.max(p,m,g,y)<=d*a.x+f*a.y||Math.min(p,m,g,y)>=d*c.x+f*c.y)return!1;const v=u*(a.y-l.y),_=u*(l.x-a.x),x=v*s+_*r,A=v*n+_*r,T=v*s+_*o,I=v*n+_*o;return!(Math.max(x,A,T,I)<=v*a.x+_*a.y||Math.min(x,A,T,I)>=v*c.x+_*c.y)}pad(t=0,i=t){return this.x-=t,this.y-=i,this.width+=t*2,this.height+=i*2,this}fit(t){const i=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=i,this.width=Math.max(s-i,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(t=1,i=.001){const s=Math.ceil((this.x+this.width-i)*t)/t,n=Math.ceil((this.y+this.height-i)*t)/t;return this.x=Math.floor((this.x+i)*t)/t,this.y=Math.floor((this.y+i)*t)/t,this.width=s-this.x,this.height=n-this.y,this}enlarge(t){const i=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=i,this.width=s-i,this.y=n,this.height=r-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class io{constructor(t=0,i=0,s=0){this.x=t,this.y=i,this.radius=s,this.type=$t.CIRC}clone(){return new io(this.x,this.y,this.radius)}contains(t,i){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-t,r=this.y-i;return n*=n,r*=r,n+r<=s}getBounds(){return new lt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Oh{constructor(t=0,i=0,s=0,n=0){this.x=t,this.y=i,this.width=s,this.height=n,this.type=$t.ELIP}clone(){return new Oh(this.x,this.y,this.width,this.height)}contains(t,i){if(this.width<=0||this.height<=0)return!1;let s=(t-this.x)/this.width,n=(i-this.y)/this.height;return s*=s,n*=n,s+n<=1}getBounds(){return new lt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class gs{constructor(...t){let i=Array.isArray(t[0])?t[0]:t;if(typeof i[0]!="number"){const s=[];for(let n=0,r=i.length;n<r;n++)s.push(i[n].x,i[n].y);i=s}this.points=i,this.type=$t.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),i=new gs(t);return i.closeStroke=this.closeStroke,i}contains(t,i){let s=!1;const n=this.points.length/2;for(let r=0,o=n-1;r<n;o=r++){const a=this.points[r*2],h=this.points[r*2+1],l=this.points[o*2],c=this.points[o*2+1];h>i!=c>i&&t<(l-a)*((i-h)/(c-h))+a&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,i)=>`${t}, ${i}`,"")}]`}}class Lh{constructor(t=0,i=0,s=0,n=0,r=20){this.x=t,this.y=i,this.width=s,this.height=n,this.radius=r,this.type=$t.RREC}clone(){return new Lh(this.x,this.y,this.width,this.height,this.radius)}contains(t,i){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(i>=this.y+s&&i<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let n=t-(this.x+s),r=i-(this.y+s);const o=s*s;if(n*n+r*r<=o||(n=t-(this.x+this.width-s),n*n+r*r<=o)||(r=i-(this.y+this.height-s),n*n+r*r<=o)||(n=t-(this.x+s),n*n+r*r<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class At{constructor(t=1,i=0,s=0,n=1,r=0,o=0){this.array=null,this.a=t,this.b=i,this.c=s,this.d=n,this.tx=r,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,i,s,n,r,o){return this.a=t,this.b=i,this.c=s,this.d=n,this.tx=r,this.ty=o,this}toArray(t,i){this.array||(this.array=new Float32Array(9));const s=i||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,i){i=i||new st;const s=t.x,n=t.y;return i.x=this.a*s+this.c*n+this.tx,i.y=this.b*s+this.d*n+this.ty,i}applyInverse(t,i){i=i||new st;const s=1/(this.a*this.d+this.c*-this.b),n=t.x,r=t.y;return i.x=this.d*s*n+-this.c*s*r+(this.ty*this.c-this.tx*this.d)*s,i.y=this.a*s*r+-this.b*s*n+(-this.ty*this.a+this.tx*this.b)*s,i}translate(t,i){return this.tx+=t,this.ty+=i,this}scale(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this}rotate(t){const i=Math.cos(t),s=Math.sin(t),n=this.a,r=this.c,o=this.tx;return this.a=n*i-this.b*s,this.b=n*s+this.b*i,this.c=r*i-this.d*s,this.d=r*s+this.d*i,this.tx=o*i-this.ty*s,this.ty=o*s+this.ty*i,this}append(t){const i=this.a,s=this.b,n=this.c,r=this.d;return this.a=t.a*i+t.b*n,this.b=t.a*s+t.b*r,this.c=t.c*i+t.d*n,this.d=t.c*s+t.d*r,this.tx=t.tx*i+t.ty*n+this.tx,this.ty=t.tx*s+t.ty*r+this.ty,this}setTransform(t,i,s,n,r,o,a,h,l){return this.a=Math.cos(a+l)*r,this.b=Math.sin(a+l)*r,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+n*this.c),this.ty=i-(s*this.b+n*this.d),this}prepend(t){const i=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,n=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this}decompose(t){const i=this.a,s=this.b,n=this.c,r=this.d,o=t.pivot,a=-Math.atan2(-n,r),h=Math.atan2(s,i),l=Math.abs(a+h);return l<1e-5||Math.abs(Dr-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(i*i+s*s),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx+(o.x*i+o.y*n),t.position.y=this.ty+(o.x*s+o.y*r),t}invert(){const t=this.a,i=this.b,s=this.c,n=this.d,r=this.tx,o=t*n-i*s;return this.a=n/o,this.b=-i/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-n*r)/o,this.ty=-(t*this.ty-i*r)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new At;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new At}static get TEMP_MATRIX(){return new At}}const Pi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ri=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Di=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Na=[],Md=[],Xn=Math.sign;function Av(){for(let e=0;e<16;e++){const t=[];Na.push(t);for(let i=0;i<16;i++){const s=Xn(Pi[e]*Pi[i]+Ri[e]*Mi[i]),n=Xn(Mi[e]*Pi[i]+Di[e]*Mi[i]),r=Xn(Pi[e]*Ri[i]+Ri[e]*Di[i]),o=Xn(Mi[e]*Ri[i]+Di[e]*Di[i]);for(let a=0;a<16;a++)if(Pi[a]===s&&Mi[a]===n&&Ri[a]===r&&Di[a]===o){t.push(a);break}}}for(let e=0;e<16;e++){const t=new At;t.set(Pi[e],Mi[e],Ri[e],Di[e],0,0),Md.push(t)}}Av();const Ct={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Pi[e],uY:e=>Mi[e],vX:e=>Ri[e],vY:e=>Di[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Na[e][t],sub:(e,t)=>Na[e][Ct.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?Ct.S:Ct.N:Math.abs(t)*2<=Math.abs(e)?e>0?Ct.E:Ct.W:t>0?e>0?Ct.SE:Ct.SW:e>0?Ct.NE:Ct.NW,matrixAppendRotationInv:(e,t,i=0,s=0)=>{const n=Md[Ct.inv(t)];n.tx=i,n.ty=s,e.append(n)}};class gi{constructor(t,i,s=0,n=0){this._x=s,this._y=n,this.cb=t,this.scope=i}clone(t=this.cb,i=this.scope){return new gi(t,i,this._x,this._y)}set(t=0,i=t){return(this._x!==t||this._y!==i)&&(this._x=t,this._y=i,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const Rd=class{constructor(){this.worldTransform=new At,this.localTransform=new At,this.position=new gi(this.onChange,this,0,0),this.scale=new gi(this.onChange,this,1,1),this.pivot=new gi(this.onChange,this,0,0),this.skew=new gi(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const i=e.worldTransform,s=this.worldTransform;s.a=t.a*i.a+t.b*i.c,s.b=t.a*i.b+t.b*i.d,s.c=t.c*i.a+t.d*i.c,s.d=t.c*i.b+t.d*i.d,s.tx=t.tx*i.a+t.ty*i.c+i.tx,s.ty=t.tx*i.b+t.ty*i.d+i.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};let kh=Rd;kh.IDENTITY=new Rd;var Sv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Cv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function yc(e,t,i){const s=e.createShader(t);return e.shaderSource(s,i),e.compileShader(s),s}function Uo(e){const t=new Array(e);for(let i=0;i<t.length;i++)t[i]=!1;return t}function Dd(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Uo(2*t);case"bvec3":return Uo(3*t);case"bvec4":return Uo(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const _s=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],Iv={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Pv={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Mv(e,t){var s;const i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const n in e.uniforms){const r=t[n];if(!r){(s=e.uniforms[n])!=null&&s.group&&(e.uniforms[n].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.${n}, syncData);
                    `));continue}const o=e.uniforms[n];let a=!1;for(let h=0;h<_s.length;h++)if(_s[h].test(r,o)){i.push(_s[h].code(n,o)),a=!0;break}if(!a){const l=(r.size===1&&!r.isArray?Iv:Pv)[r.type].replace("location",`ud["${n}"].location`);i.push(`
            cu = ud["${n}"];
            cv = cu.value;
            v = uv["${n}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",i.join(`
`))}const Bd={};let Ji=Bd;function Rv(){if(Ji===Bd||Ji!=null&&Ji.isContextLost()){const e=z.ADAPTER.createCanvas();let t;z.PREFER_ENV>=Vi.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Ji=t}return Ji}let $n;function Dv(){if(!$n){$n=he.MEDIUM;const e=Rv();e&&e.getShaderPrecisionFormat&&($n=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?he.HIGH:he.MEDIUM)}return $n}function vc(e,t){const i=e.getShaderSource(t).split(`
`).map((l,c)=>`${c}: ${l}`),s=e.getShaderInfoLog(t),n=s.split(`
`),r={},o=n.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!r[l]?(r[l]=!0,!0):!1),a=[""];o.forEach(l=>{i[l-1]=`%c${i[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=i.join(`
`);a[0]=h,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Bv(e,t,i,s){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||vc(e,i),e.getShaderParameter(s,e.COMPILE_STATUS)||vc(e,s),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}const Fv={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Fd(e){return Fv[e]}let zn=null;const wc={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Nd(e,t){if(!zn){const i=Object.keys(wc);zn={};for(let s=0;s<i.length;++s){const n=i[s];zn[e[n]]=wc[n]}}return zn[t]}function bc(e,t,i){if(e.substring(0,9)!=="precision"){let s=t;return t===he.HIGH&&i!==he.HIGH&&(s=he.MEDIUM),`precision ${s} float;
${e}`}else if(i!==he.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}let Ls;function Nv(){if(typeof Ls=="boolean")return Ls;try{Ls=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ls=!1}return Ls}let Ov=0;const Vn={},es=class{constructor(e,t,i="pixi-shader",s={}){this.extra={},this.id=Ov++,this.vertexSrc=e||es.defaultVertexSrc,this.fragmentSrc=t||es.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Vn[i]?(Vn[i]++,i+=`-${Vn[i]}`):Vn[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=bc(this.vertexSrc,es.defaultVertexPrecision,he.HIGH),this.fragmentSrc=bc(this.fragmentSrc,es.defaultFragmentPrecision,Dv())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Cv}static get defaultFragmentSrc(){return Sv}static from(e,t,i){const s=e+t;let n=pc[s];return n||(pc[s]=n=new es(e,t,i)),n}};let Ae=es;Ae.defaultVertexPrecision=he.HIGH;Ae.defaultFragmentPrecision=ei.apple.device?he.HIGH:he.MEDIUM;let Lv=0;class Me{constructor(t,i,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Lv++,this.static=!!i,this.ubo=!!s,t instanceof Rt?(this.buffer=t,this.buffer.type=Xe.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Rt(new Float32Array(1)),this.buffer.type=Xe.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,i,s){if(!this.ubo)this.uniforms[t]=new Me(i,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,i,s){return new Me(t,i,s)}static uboFrom(t,i){return new Me(t,i??!0,!0)}}class $e{constructor(t,i){this.uniformBindCount=0,this.program=t,i?i instanceof Me?this.uniformGroup=i:this.uniformGroup=new Me(i):this.uniformGroup=new Me({}),this.disposeRunner=new Pe("disposeShader")}checkUniformExists(t,i){if(i.uniforms[t])return!0;for(const s in i.uniforms){const n=i.uniforms[s];if(n.group&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,i,s){const n=Ae.from(t,i);return new $e(n,s)}}class kv{constructor(t,i){if(this.vertexSrc=t,this.fragTemplate=i,this.programCache={},this.defaultGroupCache={},!i.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!i.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let r=0;r<t;r++)s[r]=r;this.defaultGroupCache[t]=Me.from({uSamplers:s},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ae(this.vertexSrc,n)}const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new At,default:this.defaultGroupCache[t]};return new $e(this.programCache[t],i)}generateSampleSrc(t){let i="";i+=`
`,i+=`
`;for(let s=0;s<t;s++)s>0&&(i+=`
else `),s<t-1&&(i+=`if(vTextureId < ${s}.5)`),i+=`
{`,i+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,i+=`
}`;return i+=`
`,i+=`
`,i}}class Oa{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Uv(){return!ei.apple.device}function Hv(e){let t=!0;const i=z.ADAPTER.getNavigator();if(ei.tablet||ei.phone){if(ei.apple.device){const s=i.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(ei.android.device){const s=i.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?e:4}class so{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Gv=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Wv=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const pe=class extends so{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=Pd,this.vertexSize=6,this.state=ai.for2d(),this.size=pe.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Hv(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Uv(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return ft("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Wv}static get defaultFragmentTemplate(){return Gv}setShaderGenerator({vertex:e=pe.defaultVertexSrc,fragment:t=pe.defaultFragmentTemplate}={}){this.shaderGenerator=new kv(e,t)}contextChange(){const e=this.renderer.gl;z.PREFER_ENV===Vi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),pe.defaultMaxTextures),this.maxTextures=gv(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=pe,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new Fa);for(;t.length<s;)t.push(new Oa);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,i=pe._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,r=this.renderer.textureGC.count;let o=++at._globalBatch,a=0,h=i[0],l=0;s.copyBoundTextures(n,t);for(let c=0;c<this._bufferSize;++c){const u=e[c];e[c]=null,u._batchEnabled!==o&&(h.count>=t&&(s.boundArray(h,n,o,t),this.buildDrawCalls(h,l,c),l=c,h=i[++a],++o),u._batchEnabled=o,u.touched=r,h.elements[h.count++]=u)}h.count>0&&(s.boundArray(h,n,o,t),this.buildDrawCalls(h,l,this._bufferSize),++a,++o);for(let c=0;c<n.length;c++)n[c]=null;at._globalBatch=o}buildDrawCalls(e,t,i){const{_bufferedElements:s,_attributeBuffer:n,_indexBuffer:r,vertexSize:o}=this,a=pe._drawCallPool;let h=this._dcIndex,l=this._aIndex,c=this._iIndex,u=a[h];u.start=this._iIndex,u.texArray=e;for(let d=t;d<i;++d){const f=s[d],p=f._texture.baseTexture,m=Ed[p.alphaMode?1:0][f.blendMode];s[d]=null,t<d&&u.blend!==m&&(u.size=c-u.start,t=d,u=a[++h],u.texArray=e,u.start=c),this.packInterleavedGeometry(f,n,r,l,c),l+=f.vertexData.length/2*o,c+=f.indices.length,u.blend=m}t<i&&(u.size=c-u.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=c}bindAndClearTexArray(e){const t=this.renderer.texture;for(let i=0;i<e.count;i++)t.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:i}=this;pe.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:i}=this.renderer,s=pe._drawCallPool;let n=null;for(let r=0;r<e;r++){const{texArray:o,type:a,size:h,start:l,blend:c}=s[r];n!==o&&(n=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,i.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,l*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),pe.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Mr(Math.ceil(e/8)),i=fc(t),s=t*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._aBuffers[s];return n||(this._aBuffers[s]=n=new Da(s*this.vertexSize*4)),n}getIndexBuffer(e){const t=Mr(Math.ceil(e/12)),i=fc(t),s=t*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(s)),n}packInterleavedGeometry(e,t,i,s,n){const{uint32View:r,float32View:o}=t,a=s/this.vertexSize,h=e.uvs,l=e.indices,c=e.vertexData,u=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=bt.shared.setValue(e._tintRGB).toPremultiplied(d,e._texture.baseTexture.alphaMode>0);for(let p=0;p<c.length;p+=2)o[s++]=c[p],o[s++]=c[p+1],o[s++]=h[p],o[s++]=h[p+1],r[s++]=f,o[s++]=u;for(let p=0;p<l.length;p++)i[n++]=a+l[p]}};let ye=pe;ye.defaultBatchSize=4096;ye.extension={name:"batch",type:V.RendererPlugin};ye._drawCallPool=[];ye._textureArrayPool=[];q.add(ye);var Xv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,$v=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const js=class extends $e{constructor(e,t,i){const s=Ae.from(e||js.defaultVertexSrc,t||js.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=js.defaultResolution,this.multisample=js.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new ai}apply(e,t,i,s,n){e.applyFilter(this,t,i,s)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return $v}static get defaultFragmentSrc(){return Xv}};let zt=js;zt.defaultResolution=1;zt.defaultMultisample=Nt.NONE;class no{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new bt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:i,background:s,backgroundAlpha:n}=t,r=s??i;r!==void 0&&(this.color=r),this.alpha=n}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}no.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};no.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"background"};q.add(no);class Od{constructor(t){this.renderer=t,this.emptyRenderer=new so(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,i){const{boundTextures:s}=this.renderer.texture;for(let n=i-1;n>=0;--n)t[n]=s[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,i,s,n){const{elements:r,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const c=r[l],u=c._batchLocation;if(u>=0&&u<n&&i[u]===c){o[l]=u;continue}for(;h<n;){const d=i[h];if(d&&d._batchEnabled===s&&d._batchLocation===h){h++;continue}o[l]=h,c._batchLocation=h,i[h]=c;break}}}destroy(){this.renderer=null}}Od.extension={type:V.RendererSystem,name:"batch"};q.add(Od);let Tc=0;class ro{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Tc++}init(t){if(t.context)this.initFromContext(t.context);else{const i=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:i,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Tc++,this.renderer.runners.contextChange.emit(t);const i=this.renderer.view;i.addEventListener!==void 0&&(i.addEventListener("webglcontextlost",this.handleContextLost,!1),i.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const i=this.createContext(this.renderer.view,t);this.initFromContext(i)}createContext(t,i){let s;if(z.PREFER_ENV>=Vi.WEBGL2&&(s=t.getContext("webgl2",i)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",i)||t.getContext("experimental-webgl",i),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,i={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,i,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,i,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const i=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),i&&!i.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ro.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};ro.extension={type:V.RendererSystem,name:"context"};q.add(ro);class zv extends An{upload(t,i,s){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===De.UNPACK);const r=i.realWidth,o=i.realHeight;return s.width===r&&s.height===o?n.texSubImage2D(i.target,0,0,0,r,o,i.format,s.type,this.data):(s.width=r,s.height=o,n.texImage2D(i.target,0,s.internalFormat,r,o,0,i.format,s.type,this.data)),!0}}class La{constructor(t,i){this.width=Math.round(t||100),this.height=Math.round(i||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Pe("disposeFramebuffer"),this.multisample=Nt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,i){return this.colorTextures[t]=i||new at(null,{scaleMode:ti.NEAREST,resolution:1,mipmap:ze.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new at(new zv(null,{width:this.width,height:this.height}),{scaleMode:ti.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:ze.OFF,format:U.DEPTH_COMPONENT,type:et.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,i){if(t=Math.round(t),i=Math.round(i),!(t===this.width&&i===this.height)){this.width=t,this.height=i,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const n=this.colorTextures[s],r=n.resolution;n.setSize(t/r,i/r)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,i/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Ld extends at{constructor(t={}){if(typeof t=="number"){const i=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];t={width:i,height:s,scaleMode:n,resolution:r}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Nt.NONE),super(null,t),this.mipmap=ze.OFF,this.valid=!0,this._clear=new bt([0,0,0,0]),this.framebuffer=new La(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,i){this.framebuffer.resize(t*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Ei extends yn{constructor(t){const i=t,s=i.naturalWidth||i.videoWidth||i.width,n=i.naturalHeight||i.videoHeight||i.height;super(s,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,i,s){s===void 0&&!i.startsWith("data:")?t.crossOrigin=fv(i):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,i,s,n){const r=t.gl,o=i.realWidth,a=i.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===De.UNPACK),!this.noSubImage&&i.target===r.TEXTURE_2D&&s.width===o&&s.height===a?r.texSubImage2D(r.TEXTURE_2D,0,0,0,i.format,s.type,n):(s.width=o,s.height=a,r.texImage2D(i.target,0,s.internalFormat,i.format,s.type,n)),!0}update(){if(this.destroyed)return;const t=this.source,i=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(i,s),super.update()}dispose(){this.source=null}}class kd extends Ei{constructor(t,i){if(i=i||{},typeof t=="string"){const s=new Image;Ei.crossOrigin(s,t,i.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(i.createBitmap??z.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this.bitmap=null,this._load=null,i.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((i,s)=>{const n=this.source;this.url=n.src;const r=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?i(this.process()):i(this))};n.complete&&n.src?r():(n.onload=r,n.onerror=o=>{s(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const i=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(n=>n.blob()).then(n=>i(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===De.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,i,s){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,i,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,i,s,this.bitmap),!this.preserveBitmap){let n=!0;const r=i._glTextures;for(const o in r){const a=r[o];if(a!==s&&a.dirtyId!==i.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Ud{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,i,s){const n=i.width,r=i.height;if(s){const o=t.width/2/n,a=t.height/2/r,h=t.x/n+o,l=t.y/r+a;s=Ct.add(s,Ct.NW),this.x0=h+o*Ct.uX(s),this.y0=l+a*Ct.uY(s),s=Ct.add(s,2),this.x1=h+o*Ct.uX(s),this.y1=l+a*Ct.uY(s),s=Ct.add(s,2),this.x2=h+o*Ct.uX(s),this.y2=l+a*Ct.uY(s),s=Ct.add(s,2),this.x3=h+o*Ct.uX(s),this.y3=l+a*Ct.uY(s)}else this.x0=t.x/n,this.y0=t.y/r,this.x1=(t.x+t.width)/n,this.y1=t.y/r,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/r,this.x3=t.x/n,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const Ec=new Ud;function jn(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class K extends En{constructor(t,i,s,n,r,o,a){if(super(),this.noFrame=!1,i||(this.noFrame=!0,i=new lt(0,0,1,1)),t instanceof K&&(t=t.baseTexture),this.baseTexture=t,this._frame=i,this.trim=n,this.valid=!1,this._uvs=Ec,this.uvMatrix=null,this.orig=s||i,this._rotate=Number(r||0),r===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new st(o.x,o.y):new st(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=i:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:i}=this.baseTexture;i!=null&&i.url&&Oe[i.url]&&K.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,K.removeFromCache(this),this.textureCacheIds=null}clone(){var n;const t=this._frame.clone(),i=this._frame===this.orig?t:this.orig.clone(),s=new K(this.baseTexture,!this.noFrame&&t,i,(n=this.trim)==null?void 0:n.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===Ec&&(this._uvs=new Ud),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,i={},s=z.STRICT_TEXTURE_CACHE){const n=typeof t=="string";let r=null;if(n)r=t;else if(t instanceof at){if(!t.cacheId){const a=(i==null?void 0:i.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${$i()}`,at.addToCache(t,t.cacheId)}r=t.cacheId}else{if(!t._pixiId){const a=(i==null?void 0:i.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${$i()}`}r=t._pixiId}let o=Oe[r];if(n&&s&&!o)throw new Error(`The cacheId "${r}" does not exist in TextureCache.`);return!o&&!(t instanceof at)?(i.resolution||(i.resolution=bi(t)),o=new K(new at(t,i)),o.baseTexture.cacheId=r,at.addToCache(o.baseTexture,r),K.addToCache(o,r)):!o&&t instanceof at&&(o=new K(t),K.addToCache(o,r)),o}static fromURL(t,i){const s=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),n=K.from(t,Object.assign({resourceOptions:s},i),!1),r=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):r.load().then(()=>Promise.resolve(n))}static fromBuffer(t,i,s,n){return new K(at.fromBuffer(t,i,s,n))}static fromLoader(t,i,s,n){const r=new at(t,Object.assign({scaleMode:at.defaultOptions.scaleMode,resolution:bi(i)},n)),{resource:o}=r;o instanceof kd&&(o.url=i);const a=new K(r);return s||(s=i),at.addToCache(a.baseTexture,s),K.addToCache(a,s),s!==i&&(at.addToCache(a.baseTexture,i),K.addToCache(a,i)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,i){i&&(t.textureCacheIds.includes(i)||t.textureCacheIds.push(i),Oe[i]&&Oe[i]!==t&&console.warn(`Texture added to the cache with an id [${i}] that already had an entry`),Oe[i]=t)}static removeFromCache(t){if(typeof t=="string"){const i=Oe[t];if(i){const s=i.textureCacheIds.indexOf(t);return s>-1&&i.textureCacheIds.splice(s,1),delete Oe[t],i}}else if(t!=null&&t.textureCacheIds){for(let i=0;i<t.textureCacheIds.length;++i)Oe[t.textureCacheIds[i]]===t&&delete Oe[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:i,y:s,width:n,height:r}=t,o=i+n>this.baseTexture.width,a=s+r>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${i} + ${n} = ${i+n} > ${this.baseTexture.width}`,c=`Y: ${s} + ${r} = ${s+r} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${c}`)}this.valid=n&&r&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return K._EMPTY||(K._EMPTY=new K(new at),jn(K._EMPTY),jn(K._EMPTY.baseTexture)),K._EMPTY}static get WHITE(){if(!K._WHITE){const t=z.ADAPTER.createCanvas(16,16),i=t.getContext("2d");t.width=16,t.height=16,i.fillStyle="white",i.fillRect(0,0,16,16),K._WHITE=new K(at.from(t)),jn(K._WHITE),jn(K._WHITE.baseTexture)}return K._WHITE}}class ji extends K{constructor(t,i){super(t,i),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,i,s=!0){const n=this.baseTexture.resolution,r=Math.round(t*n)/n,o=Math.round(i*n)/n;this.valid=r>0&&o>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=o,s&&this.baseTexture.resize(r,o),this.updateUvs()}setResolution(t){const{baseTexture:i}=this;i.resolution!==t&&(i.setResolution(t),this.resize(i.width,i.height,!1))}static create(t){return new ji(new Ld(t))}}class Hd{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,i,s=Nt.NONE){const n=new Ld(Object.assign({width:t,height:i,resolution:1,multisample:s},this.textureOptions));return new ji(n)}getOptimalTexture(t,i,s=1,n=Nt.NONE){let r;t=Math.ceil(t*s-1e-6),i=Math.ceil(i*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||i!==this._pixelsHeight?(t=Mr(t),i=Mr(i),r=((t&65535)<<16|i&65535)>>>0,n>1&&(r+=n*4294967296)):r=n>1?-n:-1,this.texturePool[r]||(this.texturePool[r]=[]);let o=this.texturePool[r].pop();return o||(o=this.createTexture(t,i,n)),o.filterPoolKey=r,o.setResolution(s),o}getFilterTexture(t,i,s){const n=this.getOptimalTexture(t.width,t.height,i||t.resolution,s||Nt.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){const i=t.filterPoolKey;t.filterFrame=null,this.texturePool[i].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const i in this.texturePool){const s=this.texturePool[i];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const i in this.texturePool){if(!(Number(i)<0))continue;const s=this.texturePool[i];if(s)for(let n=0;n<s.length;n++)s[n].destroy(!0);this.texturePool[i]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Hd.SCREEN_KEY=-1;class Vv extends Ti{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Gd extends Ti{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Rt(this.vertices),this.uvBuffer=new Rt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,i){let s=0,n=0;return this.uvs[0]=s,this.uvs[1]=n,this.uvs[2]=s+i.width/t.width,this.uvs[3]=n,this.uvs[4]=s+i.width/t.width,this.uvs[5]=n+i.height/t.height,this.uvs[6]=s,this.uvs[7]=n+i.height/t.height,s=i.x,n=i.y,this.vertices[0]=s,this.vertices[1]=n,this.vertices[2]=s+i.width,this.vertices[3]=n,this.vertices[4]=s+i.width,this.vertices[5]=n+i.height,this.vertices[6]=s,this.vertices[7]=n+i.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class jv{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Nt.NONE,this.sourceFrame=new lt,this.destinationFrame=new lt,this.bindingSourceFrame=new lt,this.bindingDestinationFrame=new lt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Yn=[new st,new st,new st,new st],Ho=new At;class Wd{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Hd,this.statePool=[],this.quad=new Vv,this.quadUv=new Gd,this.tempRect=new lt,this.activeState={},this.globalUniforms=new Me({outputFrame:new lt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,i){const s=this.renderer,n=this.defaultFilterStack,r=this.statePool.pop()||new jv,o=this.renderer.renderTexture;let a=i[0].resolution,h=i[0].multisample,l=i[0].padding,c=i[0].autoFit,u=i[0].legacy??!0;for(let p=1;p<i.length;p++){const m=i[p];a=Math.min(a,m.resolution),h=Math.min(h,m.multisample),l=this.useMaxPadding?Math.max(l,m.padding):l+m.padding,c=c&&m.autoFit,u=u||(m.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(r),r.resolution=a,r.multisample=h,r.legacy=u,r.target=t,r.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),r.sourceFrame.pad(l);const d=this.tempRect.copyFrom(o.sourceFrame);s.projection.transform&&this.transformAABB(Ho.copyFrom(s.projection.transform).invert(),d),c?(r.sourceFrame.fit(d),(r.sourceFrame.width<=0||r.sourceFrame.height<=0)&&(r.sourceFrame.width=0,r.sourceFrame.height=0)):r.sourceFrame.intersects(d)||(r.sourceFrame.width=0,r.sourceFrame.height=0),this.roundFrame(r.sourceFrame,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),r.renderTexture=this.getOptimalFilterTexture(r.sourceFrame.width,r.sourceFrame.height,a,h),r.filters=i,r.destinationFrame.width=r.renderTexture.width,r.destinationFrame.height=r.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=r.sourceFrame.width,f.height=r.sourceFrame.height,r.renderTexture.filterFrame=r.sourceFrame,r.bindingSourceFrame.copyFrom(o.sourceFrame),r.bindingDestinationFrame.copyFrom(o.destinationFrame),r.transform=s.projection.transform,s.projection.transform=null,o.bind(r.renderTexture,r.sourceFrame,f),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,i=t.pop(),s=i.filters;this.activeState=i;const n=this.globalUniforms.uniforms;n.outputFrame=i.sourceFrame,n.resolution=i.resolution;const r=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(r[0]=i.destinationFrame.width,r[1]=i.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],o[0]=Math.round(r[0]*i.resolution),o[1]=Math.round(r[1]*i.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=i.sourceFrame.width*r[2]-.5*o[2],a[3]=i.sourceFrame.height*r[3]-.5*o[3],i.legacy){const l=n.filterArea;l[0]=i.destinationFrame.width,l[1]=i.destinationFrame.height,l[2]=i.sourceFrame.x,l[3]=i.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,i.renderTexture,h.renderTexture,ke.BLEND,i),this.returnFilterTexture(i.renderTexture);else{let l=i.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,i.resolution);c.filterFrame=l.filterFrame;let u=0;for(u=0;u<s.length-1;++u){u===1&&i.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,i.resolution),c.filterFrame=l.filterFrame),s[u].apply(this,l,c,ke.CLEAR,i);const d=l;l=c,c=d}s[u].apply(this,l,h.renderTexture,ke.BLEND,i),u>1&&i.multisample>1&&this.returnFilterTexture(i.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}i.clear(),this.statePool.push(i)}bindAndClear(t,i=ke.CLEAR){const{renderTexture:s,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,s.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const r=n.stateId&1||this.forceClear;(i===ke.CLEAR||i===ke.BLIT&&r)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,i,s,n){const r=this.renderer;r.state.set(t.state),this.bindAndClear(s,n),t.uniforms.uSampler=i,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(i._frame,i.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(Ge.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(Ge.TRIANGLE_STRIP))}calculateSpriteMatrix(t,i){const{sourceFrame:s,destinationFrame:n}=this.activeState,{orig:r}=i._texture,o=t.set(n.width,0,0,n.height,s.x,s.y),a=i.worldTransform.copyTo(At.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/r.width,1/r.height),o.translate(i.anchor.x,i.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,i,s=1,n=Nt.NONE){return this.texturePool.getOptimalTexture(t,i,s,n)}getFilterTexture(t,i,s){if(typeof t=="number"){const r=t;t=i,i=r}t=t||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(t.width,t.height,i||t.resolution,s||Nt.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,i){const s=Yn[0],n=Yn[1],r=Yn[2],o=Yn[3];s.set(i.left,i.top),n.set(i.left,i.bottom),r.set(i.right,i.top),o.set(i.right,i.bottom),t.apply(s,s),t.apply(n,n),t.apply(r,r),t.apply(o,o);const a=Math.min(s.x,n.x,r.x,o.x),h=Math.min(s.y,n.y,r.y,o.y),l=Math.max(s.x,n.x,r.x,o.x),c=Math.max(s.y,n.y,r.y,o.y);i.x=a,i.y=h,i.width=l-a,i.height=c-h}roundFrame(t,i,s,n,r){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(r){const{a:o,b:a,c:h,d:l}=r;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}r=r?Ho.copyFrom(r):Ho.identity(),r.translate(-s.x,-s.y).scale(n.width/s.width,n.height/s.height).translate(n.x,n.y),this.transformAABB(r,t),t.ceil(i),this.transformAABB(r.invert(),t)}}}Wd.extension={type:V.RendererSystem,name:"filter"};q.add(Wd);class Yv{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Nt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Kv=new lt;class Xd{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new La(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new lt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let i=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;z.PREFER_ENV===Vi.WEBGL_LEGACY&&(i=null,s=null),i?t.drawBuffers=n=>i.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,i,s=0){const{gl:n}=this;if(t){const r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=s),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),i){const o=i.width>>s,a=i.height>>s,h=o/i.width;this.setViewport(i.x*h,i.y*h,o,a)}else{const o=t.width>>s,a=t.height>>s;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),i?this.setViewport(i.x,i.y,i.width,i.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,i,s,n){const r=this.viewport;t=Math.round(t),i=Math.round(i),s=Math.round(s),n=Math.round(n),(r.width!==s||r.height!==n||r.x!==t||r.y!==i)&&(r.x=t,r.y=i,r.width=s,r.height=n,this.gl.viewport(t,i,s,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,i,s,n,r=va.COLOR|va.DEPTH){const{gl:o}=this;o.clearColor(t,i,s,n),o.clear(r)}initFramebuffer(t){const{gl:i}=this,s=new Yv(i.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:i}=this,s=t.glFramebuffers[this.CONTEXT_UID];s.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height));const n=t.colorTextures;let r=n.length;i.drawBuffers||(r=Math.min(r,1));for(let o=0;o<r;o++){const a=n[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&s.msaaBuffer&&(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,i){const{gl:s}=this,n=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures;let o=r.length;s.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||s.createRenderbuffer():n.msaaBuffer&&(s.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=r[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&n.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,n.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,n.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+h,l.target,c._glTextures[this.CONTEXT_UID].texture,i),a.push(s.COLOR_ATTACHMENT0+h))}if(a.length>1&&s.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,i)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,n.stencil),n.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,n.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,n.stencil)):n.stencil&&(s.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:i}=this;let s=Nt.NONE;if(t<=1||i===null)return s;for(let n=0;n<i.length;n++)if(i[n]<=t){s=i[n];break}return s===1&&(s=Nt.NONE),s}blit(t,i,s){const{current:n,renderer:r,gl:o,CONTEXT_UID:a}=this;if(r.context.webGLVersion!==2||!n)return;const h=n.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const c=n.colorTextures[0];if(!c)return;h.blitFramebuffer||(h.blitFramebuffer=new La(n.width,n.height),h.blitFramebuffer.addColorTexture(0,c)),t=h.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}i||(i=Kv,i.width=n.width,i.height=n.height),s||(s=i);const l=i.width===s.width&&i.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(i.left,i.top,i.right,i.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,i){const s=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),i||(n.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&n.deleteRenderbuffer(s.msaaBuffer),s.stencil&&n.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&this.disposeFramebuffer(s.blitFramebuffer,i)}disposeAll(t){const i=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<i.length;s++)this.disposeFramebuffer(i[s],t)}forceStencil(){const t=this.current;if(!t)return;const i=t.glFramebuffers[this.CONTEXT_UID];if(!i||i.stencil)return;t.stencil=!0;const s=t.width,n=t.height,r=this.gl,o=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,o),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,s,n):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,s,n),i.stencil=o,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new lt}destroy(){this.renderer=null}}Xd.extension={type:V.RendererSystem,name:"framebuffer"};q.add(Xd);const Go={5126:4,5123:2,5121:1};class $d{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,i.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;z.PREFER_ENV===Vi.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=n=>s.bindVertexArrayOES(n),t.deleteVertexArray=n=>s.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(i.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(n,r)=>s.vertexAttribDivisorANGLE(n,r),t.drawElementsInstanced=(n,r,o,a,h)=>s.drawElementsInstancedANGLE(n,r,o,a,h),t.drawArraysInstanced=(n,r,o,a)=>s.drawArraysInstancedANGLE(n,r,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=i.webGLVersion===2||!!i.extensions.uint32ElementIndex}bind(t,i){i=i||this.renderer.shader.shader;const{gl:s}=this;let n=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},r=!0);const o=n[i.program.id]||this.initGeometryVao(t,i,r);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?s.bindVertexArray(o):this.activateVao(t,i.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,i=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const n=t.buffers[s];i.update(n)}}checkCompatibility(t,i){const s=t.attributes,n=i.attributeData;for(const r in n)if(!s[r])throw new Error(`shader and geometry incompatible, geometry missing the "${r}" attribute`)}getSignature(t,i){const s=t.attributes,n=i.attributeData,r=["g",t.id];for(const o in s)n[o]&&r.push(o,n[o].location);return r.join("-")}initGeometryVao(t,i,s=!0){const n=this.gl,r=this.CONTEXT_UID,o=this.renderer.buffer,a=i.program;a.glPrograms[r]||this.renderer.shader.generateProgram(i),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let c=l[h];if(c)return l[a.id]=c,c;const u=t.buffers,d=t.attributes,f={},p={};for(const m in u)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*Go[d[m].type];for(const m in d){const g=d[m],y=g.size;g.stride===void 0&&(f[g.buffer]===y*Go[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=p[g.buffer],p[g.buffer]+=y*Go[g.type])}c=n.createVertexArray(),n.bindVertexArray(c);for(let m=0;m<u.length;m++){const g=u[m];o.bind(g),s&&g._glBuffers[r].refCount++}return this.activateVao(t,a),l[a.id]=c,l[h]=c,n.bindVertexArray(null),o.unbind(Xe.ARRAY_BUFFER),c}disposeGeometry(t,i){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,r=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!s){if(o)for(let h=0;h<r.length;h++){const l=r[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!i&&o.dispose(r[h],i))}if(!i){for(const h in s)if(h[0]==="g"){const l=s[h];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const i=Object.keys(this.managedGeometries);for(let s=0;s<i.length;s++)this.disposeGeometry(this.managedGeometries[i[s]],t)}activateVao(t,i){const s=this.gl,n=this.CONTEXT_UID,r=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);let h=null;for(const l in a){const c=a[l],u=o[c.buffer],d=u._glBuffers[n];if(i.attributeData[l]){h!==d&&(r.bind(u),h=d);const f=i.attributeData[l].location;if(s.enableVertexAttribArray(f),s.vertexAttribPointer(f,c.size,c.type||s.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)s.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,i,s,n){const{gl:r}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?r.UNSIGNED_SHORT:r.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?r.drawElementsInstanced(t,i||o.indexBuffer.data.length,h,(s||0)*a,n||1):r.drawElements(t,i||o.indexBuffer.data.length,h,(s||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?r.drawArraysInstanced(t,s,i||o.getSize(),n||1):r.drawArrays(t,s,i||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}$d.extension={type:V.RendererSystem,name:"geometry"};q.add($d);const Ac=new At;class zd{constructor(t,i){this._texture=t,this.mapCoord=new At,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof i>"u"?.5:i,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,i){i===void 0&&(i=t);const s=this.mapCoord;for(let n=0;n<t.length;n+=2){const r=t[n],o=t[n+1];i[n]=r*s.a+o*s.c+s.tx,i[n+1]=r*s.b+o*s.d+s.ty}return i}update(t){const i=this._texture;if(!i||!i.valid||!t&&this._textureID===i._updateID)return!1;this._textureID=i._updateID,this._updateID++;const s=i._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const n=i.orig,r=i.trim;r&&(Ac.set(n.width/r.width,0,0,n.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Ac));const o=i.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(i._frame.x+h+l)/o.width,a[1]=(i._frame.y+h+l)/o.height,a[2]=(i._frame.x+i._frame.width-h+l)/o.width,a[3]=(i._frame.y+i._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=i._frame.width===o.width&&i._frame.height===o.height&&i.rotate===0,!0}}var qv=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Zv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Jv extends zt{constructor(t,i,s){let n=null;typeof t!="string"&&i===void 0&&s===void 0&&(n=t,t=void 0,i=void 0,s=void 0),super(t||Zv,i||qv,s),this.maskSprite=n,this.maskMatrix=new At}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,i,s,n){const r=this._maskSprite,o=r._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new zd(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,i,s,n))}}class Qv{constructor(t=null){this.type=kt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=zt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=kt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Vd{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,i){let s=i;if(!s.isMaskData){const r=this.maskDataPool.pop()||new Qv;r.pooled=!0,r.maskObject=i,s=r}const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(n),s._colorMask=n?n._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==kt.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case kt.SCISSOR:this.renderer.scissor.push(s);break;case kt.STENCIL:this.renderer.stencil.push(s);break;case kt.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case kt.COLOR:this.pushColorMask(s);break}s.type===kt.SPRITE&&this.maskStack.push(s)}pop(t){const i=this.maskStack.pop();if(!(!i||i._target!==t)){if(i.enabled)switch(i.type){case kt.SCISSOR:this.renderer.scissor.pop(i);break;case kt.STENCIL:this.renderer.stencil.pop(i.maskObject);break;case kt.SPRITE:this.popSpriteMask(i);break;case kt.COLOR:this.popColorMask(i);break}if(i.reset(),i.pooled&&this.maskDataPool.push(i),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===kt.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const i=t.maskObject;i?i.isSprite?t.type=kt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=kt.SCISSOR:t.type=kt.STENCIL:t.type=kt.COLOR}pushSpriteMask(t){const{maskObject:i}=t,s=t._target;let n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Jv]));const r=this.renderer,o=r.renderTexture;let a,h;if(o.current){const c=o.current;a=t.resolution||c.resolution,h=t.multisample??c.multisample}else a=t.resolution||r.resolution,h=t.multisample??r.multisample;n[0].resolution=a,n[0].multisample=h,n[0].maskSprite=i;const l=s.filterArea;s.filterArea=i.getBounds(!0),r.filter.push(s,n),s.filterArea=l,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const i=t._colorMask,s=t._colorMask=i&t.colorMask;s!==i&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const i=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==i&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}Vd.extension={type:V.RendererSystem,name:"mask"};q.add(Vd);class jd{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:i}=this.renderer,s=this.getStackLength();this.maskStack=t;const n=this.getStackLength();n!==s&&(n===0?i.disable(this.glConst):(i.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Sc=new At,Cc=[],ur=class extends jd{constructor(e){super(e),this.glConst=z.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:i}=e,{renderer:s}=this,n=s.renderTexture,r=i.getBounds(!0,Cc.pop()??new lt);this.roundFrameToPixels(r,n.current?n.current.resolution:s.resolution,n.sourceFrame,n.destinationFrame,s.projection.transform),t&&r.fit(t),e._scissorRectLocal=r}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:i,c:s,d:n}=e;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||ur.isMatrixRotated(t.worldTransform)||ur.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,t,i,s,n){ur.isMatrixRotated(n)||(n=n?Sc.copyFrom(n):Sc.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(n,e),e.fit(s),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&Cc.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};let Yd=ur;Yd.extension={type:V.RendererSystem,name:"scissor"};q.add(Yd);class Kd extends jd{constructor(t){super(t),this.glConst=z.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const i=t.maskObject,{gl:s}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const r=t._colorMask;r!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,n,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,r!==0&&(t._colorMask=r,s.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}pop(t){const i=this.renderer.gl;if(this.getStackLength()===0)i.disable(i.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=s?s._colorMask:15;n!==0&&(s._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(s._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Kd.extension={type:V.RendererSystem,name:"stencil"};q.add(Kd);class qd{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ft("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return ft("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return ft("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const i in t)this.plugins[i]=new t[i](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}qd.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"_plugin"};q.add(qd);class Zd{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new At,this.transform=null}update(t,i,s,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=i||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,n),this.transform&&this.projectionMatrix.append(this.transform);const r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)}calculateProjection(t,i,s,n){const r=this.projectionMatrix,o=n?-1:1;r.identity(),r.a=1/i.width*2,r.d=o*(1/i.height*2),r.tx=-1-i.x*r.a,r.ty=-o-i.y*r.d}setTransform(t){}destroy(){this.renderer=null}}Zd.extension={type:V.RendererSystem,name:"projection"};q.add(Zd);const tw=new kh;class Jd{constructor(t){this.renderer=t,this._tempMatrix=new At}generateTexture(t,i){const{region:s,...n}=i||{},r=s||t.getLocalBounds(null,!0);r.width===0&&(r.width=1),r.height===0&&(r.height=1);const o=ji.create({width:r.width,height:r.height,...n});this._tempMatrix.tx=-r.x,this._tempMatrix.ty=-r.y;const a=t.transform;return t.transform=tw,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Jd.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"textureGenerator"};q.add(Jd);const Ci=new lt,ks=new lt;class Qd{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new lt,this.destinationFrame=new lt,this.viewportFrame=new lt}contextChange(){var i;const t=(i=this.renderer)==null?void 0:i.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,i,s){const n=this.renderer;this.current=t;let r,o,a;t?(r=t.baseTexture,a=r.resolution,i||(Ci.width=t.frame.width,Ci.height=t.frame.height,i=Ci),s||(ks.x=t.frame.x,ks.y=t.frame.y,ks.width=i.width,ks.height=i.height,s=ks),o=r.framebuffer):(a=n.resolution,i||(Ci.width=n._view.screen.width,Ci.height=n._view.screen.height,i=Ci),s||(s=Ci,s.width=i.width,s.height=i.height));const h=this.viewportFrame;h.x=s.x*a,h.y=s.y*a,h.width=s.width*a,h.height=s.height*a,t||(h.y=n.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(s,i,a,!o),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(i),this.destinationFrame.copyFrom(s)}clear(t,i){const s=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=bt.shared.setValue(t||s);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const r=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=r.width!==o.width||r.height!==o.height;if(a){let{x:h,y:l,width:c,height:u}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,u)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,i),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Qd.extension={type:V.RendererSystem,name:"renderTexture"};q.add(Qd);class ew{constructor(t,i){this.program=t,this.uniformData=i,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function iw(e,t){const i={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<s;n++){const r=t.getActiveAttrib(e,n);if(r.name.startsWith("gl_"))continue;const o=Nd(t,r.type),a={type:o,name:r.name,size:Fd(o),location:t.getAttribLocation(e,r.name)};i[r.name]=a}return i}function sw(e,t){const i={},s=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<s;n++){const r=t.getActiveUniform(e,n),o=r.name.replace(/\[.*?\]$/,""),a=!!r.name.match(/\[.*?\]$/),h=Nd(t,r.type);i[o]={name:o,index:n,type:h,size:r.size,isArray:a,value:Dd(h,r.size)}}return i}function nw(e,t){var h;const i=yc(e,e.VERTEX_SHADER,t.vertexSrc),s=yc(e,e.FRAGMENT_SHADER,t.fragmentSrc),n=e.createProgram();e.attachShader(n,i),e.attachShader(n,s);const r=(h=t.extra)==null?void 0:h.transformFeedbackVaryings;if(r&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(n,r.names,r.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||Bv(e,n,i,s),t.attributeData=iw(n,e),t.uniformData=sw(n,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((c,u)=>c>u?1:-1);for(let c=0;c<l.length;c++)t.attributeData[l[c]].location=c,e.bindAttribLocation(n,c,l[c]);e.linkProgram(n)}e.deleteShader(i),e.deleteShader(s);const o={};for(const l in t.uniformData){const c=t.uniformData[l];o[l]={location:e.getUniformLocation(n,l),value:Dd(c.type,c.size)}}return new ew(n,o)}function rw(e,t,i,s,n){i.buffer.update(n)}const ow={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},tf={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function aw(e){const t=e.map(r=>({data:r,offset:0,dataLen:0,dirty:0}));let i=0,s=0,n=0;for(let r=0;r<t.length;r++){const o=t[r];if(i=tf[o.data.type],o.data.size>1&&(i=Math.max(i,16)*o.data.size),o.dataLen=i,s%i!==0&&s<16){const a=s%i%16;s+=a,n+=a}s+i>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=i,s=i):(o.offset=n,s+=i,n+=i)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function hw(e,t){const i=[];for(const s in e)t[s]&&i.push(t[s]);return i.sort((s,n)=>s.index-n.index),i}function lw(e,t){if(!e.autoManage)return{size:0,syncFunc:rw};const i=hw(e.uniforms,t),{uboElements:s,size:n}=aw(i),r=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<s.length;o++){const a=s[o],h=e.uniforms[a.data.name],l=a.data.name;let c=!1;for(let u=0;u<_s.length;u++){const d=_s[u];if(d.codeUbo&&d.test(a.data,h)){r.push(`offset = ${a.offset/4};`,_s[u].codeUbo(a.data.name,h)),c=!0;break}}if(!c)if(a.data.size>1){const u=Fd(a.data.type),d=Math.max(tf[a.data.type]/16,1),f=u/d,p=(4-f%4)%4;r.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const u=ow[a.data.type];r.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${u};
                `)}}return r.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",r.join(`
`))}}let cw=0;const Kn={textureCount:0,uboCount:0};class ef{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=cw++}systemCheck(){if(!Nv())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,i){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,n=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(n.program)),i||(Kn.textureCount=0,Kn.uboCount=0,this.syncUniformGroup(t.uniformGroup,Kn)),n}setUniforms(t){const i=this.shader.program,s=i.glPrograms[this.renderer.CONTEXT_UID];i.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,i){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,i))}syncUniforms(t,i,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(i.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const i=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[i]||(this.cache[i]=Mv(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[i],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,i){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const n=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,i);t.buffer.update(),n(s.uniformData,t.uniforms,this.renderer,Kn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[i])}createSyncBufferGroup(t,i,s){const{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);const r=this.gl.getUniformBlockIndex(i.program,s);i.uniformBufferBindings[s]=this.shader.uniformBindCount,n.uniformBlockBinding(i.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=lw(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return i.uniformGroups[t.id]=a.syncFunc,i.uniformGroups[t.id]}getSignature(t,i,s){const n=t.uniforms,r=[`${s}-`];for(const o in n)r.push(o),i[o]&&r.push(i[o].type);return r.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const i=this.gl,s=t.program,n=nw(i,s);return s.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ef.extension={type:V.RendererSystem,name:"shader"};q.add(ef);class oo{constructor(t){this.renderer=t}run(t){const{renderer:i}=this;i.runners.init.emit(i.options),t.hello&&console.log(`PixiJS 7.2.4 - ${i.rendererLogId} - https://pixijs.com`),i.resize(i.screen.width,i.screen.height)}destroy(){}}oo.defaultOptions={hello:!1};oo.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"startup"};q.add(oo);function uw(e,t=[]){return t[nt.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.ADD]=[e.ONE,e.ONE],t[nt.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.NONE]=[0,0],t[nt.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[nt.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[nt.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[nt.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[nt.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[nt.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[nt.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[nt.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[nt.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[nt.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[nt.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}const dw=0,fw=1,pw=2,mw=3,gw=4,_w=5,ka=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=nt.NONE,this._blendEq=!1,this.map=[],this.map[dw]=this.setBlend,this.map[fw]=this.setOffset,this.map[pw]=this.setCullFace,this.map[mw]=this.setDepthTest,this.map[gw]=this.setFrontFace,this.map[_w]=this.setDepthMask,this.checks=[],this.defaultState=new ai,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=uw(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(ka.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(ka.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let sf=ka;sf.extension={type:V.RendererSystem,name:"state"};q.add(sf);class xw extends En{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const i=(t.priority??[]).filter(n=>t.systems[n]),s=[...i,...Object.keys(t.systems).filter(n=>!i.includes(n))];for(const n of s)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(i=>{this.runners[i]=new Pe(i)})}addSystem(t,i){const s=new t(this);if(this[i])throw new Error(`Whoops! The name "${i}" is already in use`);this[i]=s,this._systemsHash[i]=s;for(const n in this.runners)this.runners[n].add(s);return this}emitWithCustomOptions(t,i){const s=Object.keys(this._systemsHash);t.items.forEach(n=>{const r=s.find(o=>this._systemsHash[o]===n);n[t.name](i[r])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const dr=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=dr.defaultMaxIdle,this.checkCountMax=dr.defaultCheckCountMax,this.mode=dr.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Fh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let i=!1;for(let s=0;s<t.length;s++){const n=t[s];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[s]=null,i=!0)}if(i){let s=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[s++]=t[n]);t.length=s}}unload(e){const t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(let s=e.children.length-1;s>=0;s--)this.unload(e.children[s])}destroy(){this.renderer=null}};let ve=dr;ve.defaultMode=Fh.AUTO;ve.defaultMaxIdle=60*60;ve.defaultCheckCountMax=60*10;ve.extension={type:V.RendererSystem,name:"textureGC"};q.add(ve);class Wo{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=et.UNSIGNED_BYTE,this.internalFormat=U.RGBA,this.samplerType=0}}function yw(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[et.UNSIGNED_BYTE]:{[U.RGBA]:e.RGBA8,[U.RGB]:e.RGB8,[U.RG]:e.RG8,[U.RED]:e.R8,[U.RGBA_INTEGER]:e.RGBA8UI,[U.RGB_INTEGER]:e.RGB8UI,[U.RG_INTEGER]:e.RG8UI,[U.RED_INTEGER]:e.R8UI,[U.ALPHA]:e.ALPHA,[U.LUMINANCE]:e.LUMINANCE,[U.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[et.BYTE]:{[U.RGBA]:e.RGBA8_SNORM,[U.RGB]:e.RGB8_SNORM,[U.RG]:e.RG8_SNORM,[U.RED]:e.R8_SNORM,[U.RGBA_INTEGER]:e.RGBA8I,[U.RGB_INTEGER]:e.RGB8I,[U.RG_INTEGER]:e.RG8I,[U.RED_INTEGER]:e.R8I},[et.UNSIGNED_SHORT]:{[U.RGBA_INTEGER]:e.RGBA16UI,[U.RGB_INTEGER]:e.RGB16UI,[U.RG_INTEGER]:e.RG16UI,[U.RED_INTEGER]:e.R16UI,[U.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[et.SHORT]:{[U.RGBA_INTEGER]:e.RGBA16I,[U.RGB_INTEGER]:e.RGB16I,[U.RG_INTEGER]:e.RG16I,[U.RED_INTEGER]:e.R16I},[et.UNSIGNED_INT]:{[U.RGBA_INTEGER]:e.RGBA32UI,[U.RGB_INTEGER]:e.RGB32UI,[U.RG_INTEGER]:e.RG32UI,[U.RED_INTEGER]:e.R32UI,[U.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[et.INT]:{[U.RGBA_INTEGER]:e.RGBA32I,[U.RGB_INTEGER]:e.RGB32I,[U.RG_INTEGER]:e.RG32I,[U.RED_INTEGER]:e.R32I},[et.FLOAT]:{[U.RGBA]:e.RGBA32F,[U.RGB]:e.RGB32F,[U.RG]:e.RG32F,[U.RED]:e.R32F,[U.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[et.HALF_FLOAT]:{[U.RGBA]:e.RGBA16F,[U.RGB]:e.RGB16F,[U.RG]:e.RG16F,[U.RED]:e.R16F},[et.UNSIGNED_SHORT_5_6_5]:{[U.RGB]:e.RGB565},[et.UNSIGNED_SHORT_4_4_4_4]:{[U.RGBA]:e.RGBA4},[et.UNSIGNED_SHORT_5_5_5_1]:{[U.RGBA]:e.RGB5_A1},[et.UNSIGNED_INT_2_10_10_10_REV]:{[U.RGBA]:e.RGB10_A2,[U.RGBA_INTEGER]:e.RGB10_A2UI},[et.UNSIGNED_INT_10F_11F_11F_REV]:{[U.RGB]:e.R11F_G11F_B10F},[et.UNSIGNED_INT_5_9_9_9_REV]:{[U.RGB]:e.RGB9_E5},[et.UNSIGNED_INT_24_8]:{[U.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[et.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[U.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[et.UNSIGNED_BYTE]:{[U.RGBA]:e.RGBA,[U.RGB]:e.RGB,[U.ALPHA]:e.ALPHA,[U.LUMINANCE]:e.LUMINANCE,[U.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[et.UNSIGNED_SHORT_5_6_5]:{[U.RGB]:e.RGB},[et.UNSIGNED_SHORT_4_4_4_4]:{[U.RGBA]:e.RGBA},[et.UNSIGNED_SHORT_5_5_5_1]:{[U.RGBA]:e.RGBA}},t}class nf{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new at,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=yw(t);const i=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=i;for(let n=0;n<i;n++)this.boundTextures[n]=null;this.emptyTextures={};const s=new Wo(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Wo(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,i=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[i]!==t&&(this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),s.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[i]=t}else this.currentLocation!==i&&(this.currentLocation=i,s.activeTexture(s.TEXTURE0+i)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[i]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:i,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<s.length;n++)s[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<s.length;n++)s[n]===t&&(this.currentLocation!==n&&(i.activeTexture(i.TEXTURE0+n),this.currentLocation=n),i.bindTexture(t.target,this.emptyTextures[t.target].texture),s[n]=null)}ensureSamplerType(t){const{boundTextures:i,hasIntegerTextures:s,CONTEXT_UID:n}=this;if(s)for(let r=t-1;r>=0;--r){const o=i[r];o&&o._glTextures[n].samplerType!==wa.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const i=new Wo(this.gl.createTexture());return i.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=i,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),i}initTextureType(t,i){var s;i.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,this.webGLVersion===2&&t.type===et.HALF_FLOAT?i.type=this.gl.HALF_FLOAT:i.type=t.type}updateTexture(t){var n;const i=t._glTextures[this.CONTEXT_UID];if(!i)return;const s=this.renderer;if(this.initTextureType(t,i),(n=t.resource)!=null&&n.upload(s,t,i))i.samplerType!==wa.FLOAT&&(this.hasIntegerTextures=!0);else{const r=t.realWidth,o=t.realHeight,a=s.gl;(i.width!==r||i.height!==o||i.dirtyId<0)&&(i.width=r,i.height=o,a.texImage2D(t.target,0,i.internalFormat,r,o,0,t.format,i.type,null))}t.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(t),i.dirtyId=t.dirtyId}destroyTexture(t,i){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!i)){const n=this.managedTextures.indexOf(t);n!==-1&&ms(this.managedTextures,n,1)}}updateTextureStyle(t){var s;const i=t._glTextures[this.CONTEXT_UID];i&&((t.mipmap===ze.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?i.mipmap=!1:i.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?i.wrapMode=vi.CLAMP:i.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,i)||this.setStyle(t,i),i.dirtyStyleId=t.dirtyStyleId)}setStyle(t,i){const s=this.gl;if(i.mipmap&&t.mipmap!==ze.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,i.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,i.wrapMode),i.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===ti.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===ti.LINEAR){const r=Math.min(t.anisotropicLevel,s.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===ti.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===ti.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}nf.extension={type:V.RendererSystem,name:"texture"};q.add(nf);class rf{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:i,CONTEXT_UID:s}=this,n=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,i){const{gl:s,renderer:n}=this;i&&n.shader.bind(i),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:i,renderer:s,CONTEXT_UID:n}=this,r=i.createTransformFeedback();t._glTransformFeedbacks[n]=r,i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,r);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(s.buffer.update(a),a._glBuffers[n].refCount++,i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[n].buffer||null))}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),r}disposeTransformFeedback(t,i){const s=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);const r=this.renderer.buffer;if(r)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!i&&r.dispose(a,i))}s&&(i||n.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}rf.extension={type:V.RendererSystem,name:"transformFeedback"};q.add(rf);class ao{constructor(t){this.renderer=t}init(t){this.screen=new lt(0,0,t.width,t.height),this.element=t.view||z.ADAPTER.createCanvas(),this.resolution=t.resolution||z.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,i){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(i*this.resolution);const s=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=s,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",s,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var i;t&&((i=this.element.parentNode)==null||i.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ao.defaultOptions={width:800,height:600,resolution:z.RESOLUTION,autoDensity:!1};ao.extension={type:[V.RendererSystem,V.CanvasRendererSystem],name:"_view"};q.add(ao);z.PREFER_ENV=Vi.WEBGL2;z.STRICT_TEXTURE_CACHE=!1;z.RENDER_OPTIONS={...ro.defaultOptions,...no.defaultOptions,...ao.defaultOptions,...oo.defaultOptions};Object.defineProperties(z,{WRAP_MODE:{get(){return at.defaultOptions.wrapMode},set(e){ft("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),at.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return at.defaultOptions.scaleMode},set(e){ft("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),at.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return at.defaultOptions.mipmap},set(e){ft("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),at.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return at.defaultOptions.anisotropicLevel},set(e){ft("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),at.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return ft("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),zt.defaultResolution},set(e){zt.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return ft("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),zt.defaultMultisample},set(e){zt.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return ye.defaultMaxTextures},set(e){ft("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ye.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return ye.defaultBatchSize},set(e){ft("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ye.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return ye.canUploadSameBuffer},set(e){ft("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ye.canUploadSameBuffer=e}},GC_MODE:{get(){return ve.defaultMode},set(e){ft("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ve.defaultMode=e}},GC_MAX_IDLE:{get(){return ve.defaultMaxIdle},set(e){ft("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ve.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return ve.defaultCheckCountMax},set(e){ft("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ve.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return Ae.defaultVertexPrecision},set(e){ft("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ae.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return Ae.defaultFragmentPrecision},set(e){ft("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ae.defaultFragmentPrecision=e}}});var zi=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(zi||{});class Xo{constructor(t,i=null,s=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=i,this.priority=s,this.once=n}match(t,i=null){return this.fn===t&&this.context===i}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const i=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const i=this.next;return this.next=t?null:i,this.previous=null,i}}const ne=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Xo(null,null,1/0),this.deltaMS=1/ne.targetFPMS,this.elapsedMS=1/ne.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=zi.NORMAL){return this._addListener(new Xo(e,t,i))}addOnce(e,t,i=zi.NORMAL){return this._addListener(new Xo(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ne.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,ne.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ne._shared){const e=ne._shared=new ne;e.autoStart=!0,e._protected=!0}return ne._shared}static get system(){if(!ne._system){const e=ne._system=new ne;e.autoStart=!0,e._protected=!0}return ne._system}};let Gt=ne;Gt.targetFPMS=.06;Object.defineProperties(z,{TARGET_FPMS:{get(){return Gt.targetFPMS},set(e){ft("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Gt.targetFPMS=e}}});class of{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,zi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Gt.shared:new Gt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}of.extension=V.Application;q.add(of);const af=[];q.handleByList(V.Renderer,af);function vw(e){for(const t of af)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var ww=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,bw=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Tw=ww,hf=bw;class lf{constructor(t){this.renderer=t}contextChange(t){let i;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),i=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),i=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}i>=Nt.HIGH?this.multisample=Nt.HIGH:i>=Nt.MEDIUM?this.multisample=Nt.MEDIUM:i>=Nt.LOW?this.multisample=Nt.LOW:this.multisample=Nt.NONE}destroy(){}}lf.extension={type:V.RendererSystem,name:"_multisample"};q.add(lf);class Ew{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class cf{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:i,CONTEXT_UID:s}=this,n=t._glBuffers[s]||this.createGLBuffer(t);i.bindBuffer(t.type,n.buffer)}unbind(t){const{gl:i}=this;i.bindBuffer(t,null)}bindBufferBase(t,i){const{gl:s,CONTEXT_UID:n}=this;if(this.boundBufferBases[i]!==t){const r=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[i]=t,s.bindBufferBase(s.UNIFORM_BUFFER,i,r.buffer)}}bindBufferRange(t,i,s){const{gl:n,CONTEXT_UID:r}=this;s=s||0;const o=t._glBuffers[r]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,i||0,o.buffer,s*256,256)}update(t){const{gl:i,CONTEXT_UID:s}=this,n=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,i.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)i.bufferSubData(t.type,0,t.data);else{const r=t.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,i.bufferData(t.type,t.data,r)}}dispose(t,i){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),s&&(i||n.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const i=Object.keys(this.managedBuffers);for(let s=0;s<i.length;s++)this.dispose(this.managedBuffers[i[s]],t)}createGLBuffer(t){const{CONTEXT_UID:i,gl:s}=this;return t._glBuffers[i]=new Ew(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[i]}}cf.extension={type:V.RendererSystem,name:"buffer"};q.add(cf);class uf{constructor(t){this.renderer=t}render(t,i){const s=this.renderer;let n,r,o,a;if(i&&(n=i.renderTexture,r=i.clear,o=i.transform,a=i.skipUpdateTransform),this.renderingToScreen=!n,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=o,!s.context.isLost){if(n||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}s.renderTexture.bind(n),s.batch.currentRenderer.start(),(r??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),n&&(i.blit&&s.framebuffer.blit(),n.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}uf.extension={type:V.RendererSystem,name:"objectRenderer"};q.add(uf);const Ua=class extends xw{constructor(e){super(),this.type=Ir.WEBGL,e=Object.assign({},z.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Me({projectionMatrix:new At},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ua.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(ft("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Ua.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:Ky()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ft("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ft("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ft("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ft("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){ft("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return ft("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){ft("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return ft("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};let Ms=Ua;Ms.extension={type:V.Renderer,priority:1};Ms.__plugins={};Ms.__systems={};q.handleByMap(V.RendererPlugin,Ms.__plugins);q.handleByMap(V.RendererSystem,Ms.__systems);q.add(Ms);class df extends yn{constructor(t,i){const{width:s,height:n}=i||{};super(s,n),this.items=[],this.itemDirtyIds=[];for(let r=0;r<t;r++){const o=new at;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,i){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof yn?this.addResourceAt(t[s],s):this.addResourceAt(Id(t[s],i),s))}dispose(){for(let t=0,i=this.length;t<i;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,i){if(!this.items[i])throw new Error(`Index ${i} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[i].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=t,this.items[i].on("update",t.update,t)}unbind(t){super.unbind(t);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",t.update,t)}load(){if(this._load)return this._load;const i=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(i).then(()=>{const{realWidth:s,realHeight:n}=this.items[0];return this.resize(s,n),Promise.resolve(this)}),this._load}}class Aw extends df{constructor(t,i){const{width:s,height:n}=i||{};let r,o;Array.isArray(t)?(r=t,o=t.length):o=t,super(o,{width:s,height:n}),r&&this.initFromArray(r,i)}addBaseTextureAt(t,i){if(t.resource)this.addResourceAt(t.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=ds.TEXTURE_2D_ARRAY}upload(t,i,s){const{length:n,itemDirtyIds:r,items:o}=this,{gl:a}=t;s.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,n,0,i.format,s.type,null);for(let h=0;h<n;h++){const l=o[h];r[h]<l.dirtyId&&(r[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,i.format,s.type,l.resource.source))}return!0}}class Sw extends Ei{constructor(t){super(t)}static test(t){const{OffscreenCanvas:i}=globalThis;return i&&t instanceof i?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Ys=class extends df{constructor(e,t){const{width:i,height:s,autoLoad:n,linkBaseTexture:r}=t||{};if(e&&e.length!==Ys.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:s});for(let o=0;o<Ys.SIDES;o++)this.items[o].target=ds.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=r!==!1,e&&this.initFromArray(e,t),n!==!1&&this.load()}bind(e){super.bind(e),e.target=ds.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=ds.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,i){const s=this.itemDirtyIds;for(let n=0;n<Ys.SIDES;n++){const r=this.items[n];(s[n]<r.dirtyId||i.dirtyId<t.dirtyId)&&(r.valid&&r.resource?(r.resource.upload(e,r,i),s[n]=r.dirtyId):s[n]<-1&&(e.gl.texImage2D(r.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),s[n]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Ys.SIDES}};let ff=Ys;ff.SIDES=6;class as extends Ei{constructor(t,i){i=i||{};let s,n;typeof t=="string"?(s=as.EMPTY,n=t):(s=t,n=null),super(s),this.url=n,this.crossOrigin=i.crossOrigin??!0,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this._load=null,i.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,i)=>{if(this.url===null){t(this);return}try{const s=await z.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await s.blob();if(this.destroyed)return;const r=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===De.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=r,this.update(),t(this)}catch(s){if(this.destroyed)return;i(s),this.onError.emit(s)}}),this._load)}upload(t,i,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),super.upload(t,i,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return as._EMPTY=as._EMPTY??z.ADAPTER.createCanvas(0,0),as._EMPTY}}const fr=class extends Ei{constructor(e,t){t=t||{},super(z.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},fr.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Ei.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,i=e.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=t*this.scale,n=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*t,n=this._overrideHeight||this._overrideWidth/t*i),s=Math.round(s),n=Math.round(n);const r=this.source;r.width=s,r.height=n,r._pixiId=`canvas_${$i()}`,r.getContext("2d").drawImage(e,0,0,t,i,0,0,s,n),this._resolve(),this._resolve=null}}static getSize(e){const t=fr.SVG_SIZE.exec(e),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&fr.SVG_XML.test(e)}};let vn=fr;vn.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;vn.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Ha=class extends Ei{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);const s=e[0].src||e[0];Ei.crossOrigin(i,s,t.crossorigin);for(let n=0;n<e.length;++n){const r=document.createElement("source");let{src:o,mime:a}=e[n];o=o||e[n];const h=o.split("?").shift().toLowerCase(),l=h.slice(h.lastIndexOf(".")+1);a=a||Ha.MIME_TYPES[l]||`video/${l}`,r.src=o,r.type=a,i.appendChild(r)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){const t=Gt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Gt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Gt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(Gt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Gt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Gt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Ha.TYPES.includes(t)}};let Uh=Ha;Uh.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Uh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ba.push(as,kd,Sw,Uh,vn,An,ff,Aw);class Br{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?lt.EMPTY:(t=t||new lt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,i){const{a:s,b:n,c:r,d:o,tx:a,ty:h}=t,l=s*i.x+r*i.y+a,c=n*i.x+o*i.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let i=this.minX,s=this.minY,n=this.maxX,r=this.maxY,o=t[0],a=t[1];i=o<i?o:i,s=a<s?a:s,n=o>n?o:n,r=a>r?a:r,o=t[2],a=t[3],i=o<i?o:i,s=a<s?a:s,n=o>n?o:n,r=a>r?a:r,o=t[4],a=t[5],i=o<i?o:i,s=a<s?a:s,n=o>n?o:n,r=a>r?a:r,o=t[6],a=t[7],i=o<i?o:i,s=a<s?a:s,n=o>n?o:n,r=a>r?a:r,this.minX=i,this.minY=s,this.maxX=n,this.maxY=r}addFrame(t,i,s,n,r){this.addFrameMatrix(t.worldTransform,i,s,n,r)}addFrameMatrix(t,i,s,n,r){const o=t.a,a=t.b,h=t.c,l=t.d,c=t.tx,u=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=o*i+h*s+c,y=a*i+l*s+u;d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*n+h*s+c,y=a*n+l*s+u,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*i+h*r+c,y=a*i+l*r+u,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*n+h*r+c,y=a*n+l*r+u,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(t,i,s){let n=this.minX,r=this.minY,o=this.maxX,a=this.maxY;for(let h=i;h<s;h+=2){const l=t[h],c=t[h+1];n=l<n?l:n,r=c<r?c:r,o=l>o?l:o,a=c>a?c:a}this.minX=n,this.minY=r,this.maxX=o,this.maxY=a}addVertices(t,i,s,n){this.addVerticesMatrix(t.worldTransform,i,s,n)}addVerticesMatrix(t,i,s,n,r=0,o=r){const a=t.a,h=t.b,l=t.c,c=t.d,u=t.tx,d=t.ty;let f=this.minX,p=this.minY,m=this.maxX,g=this.maxY;for(let y=s;y<n;y+=2){const v=i[y],_=i[y+1],x=a*v+l*_+u,A=c*_+h*v+d;f=Math.min(f,x-r),m=Math.max(m,x+r),p=Math.min(p,A-o),g=Math.max(g,A+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=g}addBounds(t){const i=this.minX,s=this.minY,n=this.maxX,r=this.maxY;this.minX=t.minX<i?t.minX:i,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>r?t.maxY:r}addBoundsMask(t,i){const s=t.minX>i.minX?t.minX:i.minX,n=t.minY>i.minY?t.minY:i.minY,r=t.maxX<i.maxX?t.maxX:i.maxX,o=t.maxY<i.maxY?t.maxY:i.maxY;if(s<=r&&n<=o){const a=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=s<a?s:a,this.minY=n<h?n:h,this.maxX=r>l?r:l,this.maxY=o>c?o:c}}addBoundsMatrix(t,i){this.addFrameMatrix(i,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,i){const s=t.minX>i.x?t.minX:i.x,n=t.minY>i.y?t.minY:i.y,r=t.maxX<i.x+i.width?t.maxX:i.x+i.width,o=t.maxY<i.y+i.height?t.maxY:i.y+i.height;if(s<=r&&n<=o){const a=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=s<a?s:a,this.minY=n<h?n:h,this.maxX=r>l?r:l,this.maxY=o>c?o:c}}pad(t=0,i=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=i,this.maxY+=i)}addFramePad(t,i,s,n,r,o){t-=r,i-=o,s+=r,n+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<i?this.minY:i,this.maxY=this.maxY>n?this.maxY:n}}class Pt extends En{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new kh,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Br,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const i=Object.keys(t);for(let s=0;s<i.length;++s){const n=i[s];Object.defineProperty(Pt.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,i){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new lt),i=this._boundsRect),this._bounds.getRectangle(i)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new lt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Br);const i=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,r=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=s,this.transform=i,this._bounds=n,this._bounds.updateID+=this._boundsID-r,o}toGlobal(t,i,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,i)}toLocal(t,i,s,n){return i&&(t=i.toGlobal(t,s,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,s)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,i=0,s=1,n=1,r=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=i,this.scale.x=s||1,this.scale.y=n||1,this.rotation=r,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Cw),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Tv}set angle(t){this.transform.rotation=t*Ev}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount--,i._maskRefCount===0&&(i.renderable=!0,i.isMask=!1))}if(this._mask=t,this._mask){const i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount===0&&(i.renderable=!1,i.isMask=!0),i._maskRefCount++)}}}}class Cw extends Pt{constructor(){super(...arguments),this.sortDirty=null}}Pt.prototype.displayObjectUpdateTransform=Pt.prototype.updateTransform;const Iw=new At;function Pw(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const Ga=class extends Pt{constructor(){super(),this.children=[],this.sortableChildren=Ga.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),s=this.getChildIndex(t);this.children[i]=t,this.children[s]=e,this.onChildrenChange(i<s?i:s)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);ms(this.children,i,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],i=this.children.indexOf(t);if(i===-1)return null;t.parent=null,t.transform._parentID=-1,ms(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,ms(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const i=e,s=t,n=s-i;let r;if(n>0&&n<=s){r=this.children.splice(i,n);for(let o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let o=0;o<r.length;++o)r[o].emit("removed",this),this.emit("childRemoved",r[o],this,o);return r}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,i=this.children.length;t<i;++t){const s=this.children[t];s._lastSortedIndex=t,!e&&s.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Pw),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const i=this.children[e];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(t._bounds,i._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const i=super.getLocalBounds(e);if(!t)for(let s=0,n=this.children.length;s<n;++s){const r=this.children[s];r.visible&&r.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==Ga.prototype._render&&(i=this.getBounds(!0));const n=e.projection.transform;if(n&&(s?(s=Iw.copyFrom(s),s.prepend(n)):s=n),i&&t.intersects(i,s))this._render(e);else if(this.cullArea)return;for(let r=0,o=this.children.length;r<o;++r){const a=this.children[r],h=a.cullable;a.cullable=h||!this.cullArea,a.render(e),a.cullable=h}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(e)}}renderAdvanced(e){var n,r,o;const t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}const s=t&&((n=this._enabledFilters)==null?void 0:n.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==kt.NONE));if(s&&e.batch.flush(),t&&((r=this._enabledFilters)!=null&&r.length)&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let a=0,h=this.children.length;a<h;++a)this.children[a].render(e)}s&&e.batch.flush(),i&&e.mask.pop(this),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,i=this.removeChildren(0,this.children.length);if(t)for(let s=0;s<i.length;++s)i[s].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};let ae=Ga;ae.defaultSortableChildren=!1;ae.prototype.containerUpdateTransform=ae.prototype.updateTransform;Object.defineProperties(z,{SORTABLE_CHILDREN:{get(){return ae.defaultSortableChildren},set(e){ft("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ae.defaultSortableChildren=e}}});const Us=new st,Mw=new Uint16Array([0,1,2,0,2,3]);class Rs extends ae{constructor(t){super(),this._anchor=new gi(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new bt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=nt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||K.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Mw,this.pluginName="batch",this.isSprite=!0,this._roundPixels=z.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=mi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=mi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const i=this.transform.worldTransform,s=i.a,n=i.b,r=i.c,o=i.d,a=i.tx,h=i.ty,l=this.vertexData,c=t.trim,u=t.orig,d=this._anchor;let f=0,p=0,m=0,g=0;if(c?(p=c.x-d._x*u.width,f=p+c.width,g=c.y-d._y*u.height,m=g+c.height):(p=-d._x*u.width,f=p+u.width,g=-d._y*u.height,m=g+u.height),l[0]=s*p+r*g+a,l[1]=o*g+n*p+h,l[2]=s*f+r*g+a,l[3]=o*g+n*f+h,l[4]=s*f+r*m+a,l[5]=o*m+n*f+h,l[6]=s*p+r*m+a,l[7]=o*m+n*p+h,this._roundPixels){const y=z.RESOLUTION;for(let v=0;v<l.length;++v)l[v]=Math.round(l[v]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,i=this.vertexTrimmedData,s=t.orig,n=this._anchor,r=this.transform.worldTransform,o=r.a,a=r.b,h=r.c,l=r.d,c=r.tx,u=r.ty,d=-n._x*s.width,f=d+s.width,p=-n._y*s.height,m=p+s.height;i[0]=o*d+h*p+c,i[1]=l*p+a*d+u,i[2]=o*f+h*p+c,i[3]=l*p+a*f+u,i[4]=o*f+h*m+c,i[5]=l*m+a*f+u,i[6]=o*d+h*m+c,i[7]=l*m+a*d+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,i=this._texture.orig;!t||t.width===i.width&&t.height===i.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Br),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new lt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Us);const i=this._texture.orig.width,s=this._texture.orig.height,n=-i*this.anchor.x;let r=0;return Us.x>=n&&Us.x<n+i&&(r=-s*this.anchor.y,Us.y>=r&&Us.y<r+s)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!s)}this._texture=null}static from(t,i){const s=t instanceof K?t:K.from(t,i);return new Rs(s)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const i=mi(this.scale.x)||1;this.scale.x=i*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const i=mi(this.scale.y)||1;this.scale.y=i*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||K.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const pf=new At;Pt.prototype._cacheAsBitmap=!1;Pt.prototype._cacheData=null;Pt.prototype._cacheAsBitmapResolution=null;Pt.prototype._cacheAsBitmapMultisample=null;class Rw{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Pt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new Rw),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Pt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Pt.prototype._initCachedDisplayObject=function(t){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const i=this.alpha;this.alpha=1,t.batch.flush();const s=this.getLocalBounds(null,!0).clone();if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;s.pad(p)}s.ceil(z.RESOLUTION);const n=t.renderTexture.current,r=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,h=ji.create({width:s.width,height:s.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),l=`cacheAsBitmap_${$i()}`;this._cacheData.textureCacheId=l,at.addToCache(h.baseTexture,l),K.addToCache(h,l);const c=this.transform.localTransform.copyTo(pf).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:h,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(n,r,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const u=new Rs(h);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(s.x/s.width),u.anchor.y=-(s.y/s.height),u.alpha=i,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};Pt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Pt.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const i=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,r=t._projTransform;i.ceil(z.RESOLUTION);const o=ji.create({width:i.width,height:i.height}),a=`cacheAsBitmap_${$i()}`;this._cacheData.textureCacheId=a,at.addToCache(o.baseTexture,a),K.addToCache(o,a);const h=pf;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=i.x,h.ty-=i.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:h,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const l=new Rs(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(i.x/i.width),l.anchor.y=-(i.y/i.height),l.alpha=s,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)};Pt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Pt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Pt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,at.removeFromCache(this._cacheData.textureCacheId),K.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Pt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Pt.prototype.name=null;ae.prototype.getChildByName=function(t,i){for(let s=0,n=this.children.length;s<n;s++)if(this.children[s].name===t)return this.children[s];if(i)for(let s=0,n=this.children.length;s<n;s++){const r=this.children[s];if(!r.getChildByName)continue;const o=r.getChildByName(t,!0);if(o)return o}return null};Pt.prototype.getGlobalPosition=function(t=new st,i=!1){return this.parent?this.parent.toGlobal(this.position,t,i):(t.x=this.position.x,t.y=this.position.y),t};var Dw=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class Bw extends zt{constructor(t=1){super(Tw,Dw,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const Fw={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Nw=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Ow(e){const t=Fw[e],i=t.length;let s=Nw,n="";const r="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<e;a++){let h=r.replace("%index%",a.toString());o=a,a>=i&&(o=e-a-1),h=h.replace("%value%",t[o].toString()),n+=h,n+=`
`}return s=s.replace("%blur%",n),s=s.replace("%size%",e.toString()),s}const Lw=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function kw(e,t){const i=Math.ceil(e/2);let s=Lw,n="",r;t?r="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":r="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<e;o++){let a=r.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(i-1)}.0`),n+=a,n+=`
`}return s=s.replace("%blur%",n),s=s.replace("%size%",e.toString()),s}class Wa extends zt{constructor(t,i=8,s=4,n=zt.defaultResolution,r=5){const o=kw(r,t),a=Ow(r);super(o,a),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=s,this.blur=i}apply(t,i,s,n){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/i.width):this.uniforms.strength=1/s.height*(s.height/i.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/i.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/i.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,i,s,n);else{const r=t.getFilterTexture(),o=t.renderer;let a=i,h=r;this.state.blend=!1,t.applyFilter(this,a,h,ke.CLEAR);for(let l=1;l<this.passes-1;l++){t.bindAndClear(a,ke.BLIT),this.uniforms.uSampler=h;const c=h;h=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,s,n),t.returnFilterTexture(r)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class Uw extends zt{constructor(t=8,i=4,s=zt.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Wa(!0,t,i,s,n),this.blurYFilter=new Wa(!1,t,i,s,n),this.resolution=s,this.quality=i,this.blur=t,this.repeatEdgePixels=!1}apply(t,i,s,n){const r=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(r&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,i,a,ke.CLEAR),this.blurYFilter.apply(t,a,s,n),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,i,s,n):this.blurXFilter.apply(t,i,s,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var Hw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Xa extends zt{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(hf,Hw,t),this.alpha=1}_loadMatrix(t,i=!1){let s=t;i&&(this._multiply(s,this.uniforms.m,t),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(t,i,s){return t[0]=i[0]*s[0]+i[1]*s[5]+i[2]*s[10]+i[3]*s[15],t[1]=i[0]*s[1]+i[1]*s[6]+i[2]*s[11]+i[3]*s[16],t[2]=i[0]*s[2]+i[1]*s[7]+i[2]*s[12]+i[3]*s[17],t[3]=i[0]*s[3]+i[1]*s[8]+i[2]*s[13]+i[3]*s[18],t[4]=i[0]*s[4]+i[1]*s[9]+i[2]*s[14]+i[3]*s[19]+i[4],t[5]=i[5]*s[0]+i[6]*s[5]+i[7]*s[10]+i[8]*s[15],t[6]=i[5]*s[1]+i[6]*s[6]+i[7]*s[11]+i[8]*s[16],t[7]=i[5]*s[2]+i[6]*s[7]+i[7]*s[12]+i[8]*s[17],t[8]=i[5]*s[3]+i[6]*s[8]+i[7]*s[13]+i[8]*s[18],t[9]=i[5]*s[4]+i[6]*s[9]+i[7]*s[14]+i[8]*s[19]+i[9],t[10]=i[10]*s[0]+i[11]*s[5]+i[12]*s[10]+i[13]*s[15],t[11]=i[10]*s[1]+i[11]*s[6]+i[12]*s[11]+i[13]*s[16],t[12]=i[10]*s[2]+i[11]*s[7]+i[12]*s[12]+i[13]*s[17],t[13]=i[10]*s[3]+i[11]*s[8]+i[12]*s[13]+i[13]*s[18],t[14]=i[10]*s[4]+i[11]*s[9]+i[12]*s[14]+i[13]*s[19]+i[14],t[15]=i[15]*s[0]+i[16]*s[5]+i[17]*s[10]+i[18]*s[15],t[16]=i[15]*s[1]+i[16]*s[6]+i[17]*s[11]+i[18]*s[16],t[17]=i[15]*s[2]+i[16]*s[7]+i[17]*s[12]+i[18]*s[17],t[18]=i[15]*s[3]+i[16]*s[8]+i[17]*s[13]+i[18]*s[18],t[19]=i[15]*s[4]+i[16]*s[9]+i[17]*s[14]+i[18]*s[19]+i[19],t}_colorMatrix(t){const i=new Float32Array(t);return i[4]/=255,i[9]/=255,i[14]/=255,i[19]/=255,i}brightness(t,i){const s=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(s,i)}tint(t,i){const[s,n,r]=bt.shared.setValue(t).toArray(),o=[s,0,0,0,0,0,n,0,0,0,0,0,r,0,0,0,0,0,1,0];this._loadMatrix(o,i)}greyscale(t,i){const s=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(s,i)}blackAndWhite(t){const i=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(i,t)}hue(t,i){t=(t||0)/180*Math.PI;const s=Math.cos(t),n=Math.sin(t),r=Math.sqrt,o=1/3,a=r(o),h=s+(1-s)*o,l=o*(1-s)-a*n,c=o*(1-s)+a*n,u=o*(1-s)+a*n,d=s+o*(1-s),f=o*(1-s)-a*n,p=o*(1-s)-a*n,m=o*(1-s)+a*n,g=s+o*(1-s),y=[h,l,c,0,0,u,d,f,0,0,p,m,g,0,0,0,0,0,1,0];this._loadMatrix(y,i)}contrast(t,i){const s=(t||0)+1,n=-.5*(s-1),r=[s,0,0,0,n,0,s,0,0,n,0,0,s,0,n,0,0,0,1,0];this._loadMatrix(r,i)}saturate(t=0,i){const s=t*2/3+1,n=(s-1)*-.5,r=[s,n,n,0,0,n,s,n,0,0,n,n,s,0,0,0,0,0,1,0];this._loadMatrix(r,i)}desaturate(){this.saturate(-1)}negative(t){const i=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(i,t)}sepia(t){const i=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(i,t)}technicolor(t){const i=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(i,t)}polaroid(t){const i=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(i,t)}toBGR(t){const i=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(i,t)}kodachrome(t){const i=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(i,t)}browni(t){const i=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(i,t)}vintage(t){const i=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(i,t)}colorTone(t,i,s,n,r){t=t||.2,i=i||.15,s=s||16770432,n=n||3375104;const o=bt.shared,[a,h,l]=o.setValue(s).toArray(),[c,u,d]=o.setValue(n).toArray(),f=[.3,.59,.11,0,0,a,h,l,t,0,c,u,d,i,0,a-c,h-u,l-d,0,0];this._loadMatrix(f,r)}night(t,i){t=t||.1;const s=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(s,i)}predator(t,i){const s=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(s,i)}lsd(t){const i=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(i,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Xa.prototype.grayscale=Xa.prototype.greyscale;var Gw=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,Ww=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class Xw extends zt{constructor(t,i){const s=new At;t.renderable=!1,super(Ww,Gw,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=s,i==null&&(i=20),this.scale=new st(i,i)}apply(t,i,s,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const r=this.maskSprite.worldTransform,o=Math.sqrt(r.a*r.a+r.b*r.b),a=Math.sqrt(r.c*r.c+r.d*r.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=r.a/o,this.uniforms.rotation[1]=r.b/o,this.uniforms.rotation[2]=r.c/a,this.uniforms.rotation[3]=r.d/a),t.applyFilter(this,i,s,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var $w=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,zw=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Vw extends zt{constructor(){super(zw,$w)}}var jw=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class Yw extends zt{constructor(t=.5,i=Math.random()){super(hf,jw,{uNoise:0,uSeed:0}),this.noise=t,this.seed=i}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Ic={AlphaFilter:Bw,BlurFilter:Uw,BlurFilterPass:Wa,ColorMatrixFilter:Xa,DisplacementFilter:Xw,FXAAFilter:Vw,NoiseFilter:Yw};Object.entries(Ic).forEach(([e,t])=>{Object.defineProperty(Ic,e,{get(){return ft("7.1.0",`filters.${e} has moved to ${e}`),t}})});class Kw{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(Gt.system.add(this.tickerUpdate,this,zi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Gt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const fi=new Kw;class Sn{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Sn.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new st,this.page=new st,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,i,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,i,s,n,r){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Fr extends Sn{constructor(){super(...arguments),this.client=new st,this.movement=new st,this.offset=new st,this.global=new st,this.screen=new st}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,i,s){return t.worldTransform.applyInverse(s||this.global,i)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,i,s,n,r,o,a,h,l,c,u,d,f,p,m){throw new Error("Method not implemented.")}}class me extends Fr{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Es extends Fr{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Es.DOM_DELTA_PIXEL=0;Es.DOM_DELTA_LINE=1;Es.DOM_DELTA_PAGE=2;const qw=2048,Zw=new st,$o=new st;class Jw{constructor(t){this.dispatch=new En,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,i){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:i,priority:0}),this.mappingTable[t].sort((s,n)=>s.priority-n.priority)}dispatchEvent(t,i){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,i),this.dispatch.emit(i||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const i=this.mappingTable[t.type];if(i)for(let s=0,n=i.length;s<n;s++)i[s].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,i){fi.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[n](this.rootTarget,this.rootTarget.eventMode,Zw.set(t,i),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,i){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,r=s.length-1;n<r;n++)if(t.currentTarget=s[n],this.notifyTarget(t,i),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,i),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=s.length-2;n>=0;n--)if(t.currentTarget=s[n],this.notifyTarget(t,i),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,i,s=this._allInteractiveElements){if(s.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const n=Array.isArray(i)?i:[i];for(let r=s.length-1;r>=0;r--)n.forEach(o=>{t.currentTarget=s[r],this.notifyTarget(t,o)})}propagationPath(t){const i=[t];for(let s=0;s<qw&&t!==this.rootTarget;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");i.push(t.parent),t=t.parent}return i.reverse(),i}hitTestMoveRecursive(t,i,s,n,r,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||i==="dynamic")&&(fi.pauseUpdate=!1),t.interactiveChildren&&t.children){const c=t.children;for(let u=c.length-1;u>=0;u--){const d=c[u],f=this.hitTestMoveRecursive(d,this._isInteractive(i)?i:d.eventMode,s,n,r,o||r(t,s));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const h=this._isInteractive(i),l=t.isInteractive();return l&&l&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!r(t,s)&&n(t,s)?l?[t]:[]:null}hitTestRecursive(t,i,s,n,r){if(this._interactivePrune(t)||r(t,s))return null;if((t.eventMode==="dynamic"||i==="dynamic")&&(fi.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const c=h[l],u=this.hitTestRecursive(c,this._isInteractive(i)?i:c.eventMode,s,n,r);if(u){if(u.length>0&&!u[u.length-1].parent)continue;const d=t.isInteractive();return(u.length>0||d)&&u.push(t),u}}}const o=this._isInteractive(i),a=t.isInteractive();return o&&n(t,s)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,i){var s;if(t.hitArea&&(t.worldTransform.applyInverse(i,$o),!t.hitArea.contains($o.x,$o.y)))return!0;if(t._mask){const n=t._mask.isMaskData?t._mask.maskObject:t._mask;if(n&&!((s=n.containsPoint)!=null&&s.call(n,i)))return!0}return!1}hitTestFn(t,i){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(i):!1}notifyTarget(t,i){var r,o;i=i??t.type;const s=`on${i}`;(o=(r=t.currentTarget)[s])==null||o.call(r,t);const n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${i}capture`:i;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,i)}mapPointerDown(t){if(!(t instanceof me)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerdown"),i.pointerType==="touch")this.dispatchEvent(i,"touchstart");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const n=i.button===2;this.dispatchEvent(i,n?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=i.composedPath(),this.freeEvent(i)}mapPointerMove(t){var h,l;if(!(t instanceof me)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const i=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const s=i.pointerType==="mouse"||i.pointerType==="pen",n=this.trackingData(t.pointerId),r=this.findMountedTarget(n.overTargets);if(((h=n.overTargets)==null?void 0:h.length)>0&&r!==i.target){const c=t.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(t,c,r);if(this.dispatchEvent(u,"pointerout"),s&&this.dispatchEvent(u,"mouseout"),!i.composedPath().includes(r)){const d=this.createPointerEvent(t,"pointerleave",r);for(d.eventPhase=d.AT_TARGET;d.target&&!i.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),s&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(u)}if(r!==i.target){const c=t.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(i,c);this.dispatchEvent(u,"pointerover"),s&&this.dispatchEvent(u,"mouseover");let d=r==null?void 0:r.parent;for(;d&&d!==this.rootTarget.parent&&d!==i.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const p=this.clonePointerEvent(i,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==r&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),s&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(u)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(i,"pointermove"),a&&o.push("globalpointermove"),i.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),a&&o.push("globaltouchmove")),s&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(l=i.target)==null?void 0:l.cursor),o.length>0&&this.all(i,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=i.composedPath(),this.freeEvent(i)}mapPointerOver(t){var o;if(!(t instanceof me)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(t.pointerId),s=this.createPointerEvent(t),n=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),n&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(o=s.target)==null?void 0:o.cursor);const r=this.clonePointerEvent(s,"pointerenter");for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),n&&this.notifyTarget(r,"mouseenter"),r.target=r.target.parent;i.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(r)}mapPointerOut(t){if(!(t instanceof me)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(t.pointerId);if(i.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(i.overTargets),r=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(r),s&&this.dispatchEvent(r,"mouseout");const o=this.createPointerEvent(t,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;i.overTargets=null,this.freeEvent(r),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof me)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.dispatchEvent(s,a?"rightup":"mouseup")}const n=this.trackingData(t.pointerId),r=this.findMountedTarget(n.pressTargetsByButton[t.button]);let o=r;if(r&&!s.composedPath().includes(r)){let a=r;for(;a&&!s.composedPath().includes(a);){if(s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const h=s.button===2;this.notifyTarget(s,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete n.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(s,"click");a.target=o,a.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:i});const h=n.clicksByButton[t.button];if(h.target===a.target&&i-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=i,a.detail=h.clickCount,a.pointerType==="mouse"){const l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof me)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(t.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(s){let r=s;for(;r;)n.currentTarget=r,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),r=r.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof Es)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const i=this.createWheelEvent(t);this.dispatchEvent(i),this.freeEvent(i)}findMountedTarget(t){if(!t)return null;let i=t[0];for(let s=1;s<t.length&&t[s].parent===i;s++)i=t[s];return i}createPointerEvent(t,i,s){const n=this.allocateEvent(me);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=s??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof i=="string"&&(n.type=i),n}createWheelEvent(t){const i=this.allocateEvent(Es);return this.copyWheelData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=this.hitTest(i.global.x,i.global.y),i}clonePointerEvent(t,i){const s=this.allocateEvent(me);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=i??s.type,s}copyWheelData(t,i){i.deltaMode=t.deltaMode,i.deltaX=t.deltaX,i.deltaY=t.deltaY,i.deltaZ=t.deltaZ}copyPointerData(t,i){t instanceof me&&i instanceof me&&(i.pointerId=t.pointerId,i.width=t.width,i.height=t.height,i.isPrimary=t.isPrimary,i.pointerType=t.pointerType,i.pressure=t.pressure,i.tangentialPressure=t.tangentialPressure,i.tiltX=t.tiltX,i.tiltY=t.tiltY,i.twist=t.twist)}copyMouseData(t,i){t instanceof Fr&&i instanceof Fr&&(i.altKey=t.altKey,i.button=t.button,i.buttons=t.buttons,i.client.copyFrom(t.client),i.ctrlKey=t.ctrlKey,i.metaKey=t.metaKey,i.movement.copyFrom(t.movement),i.screen.copyFrom(t.screen),i.shiftKey=t.shiftKey,i.global.copyFrom(t.global))}copyData(t,i){i.isTrusted=t.isTrusted,i.srcElement=t.srcElement,i.timeStamp=performance.now(),i.type=t.type,i.detail=t.detail,i.view=t.view,i.which=t.which,i.layer.copyFrom(t.layer),i.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const i=this.eventPool.get(t).pop()||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=null,i.target=null,i}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),this.eventPool.get(i).push(t)}notifyListeners(t,i){const s=t.currentTarget._events[i];if(s&&t.currentTarget.isInteractive())if("fn"in s)s.once&&t.currentTarget.removeListener(i,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let n=0,r=s.length;n<r&&!t.propagationImmediatelyStopped;n++)s[n].once&&t.currentTarget.removeListener(i,s[n].fn,void 0,!0),s[n].fn.call(s[n].context,t)}}const Qw=1,tb={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},$a=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new Jw(null),fi.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new me(null),this.rootWheelEvent=new Es(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...$a.defaultEventFeatures},{set:(t,i,s)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),t[i]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:i}=this.renderer;this.setTargetElement(t),this.resolution=i,$a._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let i=0,s=t.length;i<s;i++){const n=t[i],r=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;fi.pointerMoved();const t=this.normalizeToPointerData(e);for(let i=0,s=t.length;i<s;i++){const n=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",s=this.normalizeToPointerData(e);for(let n=0,r=s.length;n<r;n++){const o=this.bootstrapEvent(this.rootPointerEvent,s[n]);o.type+=i,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;const t=this.normalizeToPointerData(e);for(let i=0,s=t.length;i<s;i++){const n=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,fi.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;fi.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;fi.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,i){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const n=1/this.resolution;e.x=(t-s.left)*(this.domElement.width/s.width)*n,e.y=(i-s.top)*(this.domElement.height/s.height)*n}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,s=e.changedTouches.length;i<s;i++){const n=e.changedTouches[i];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const i=e;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=Qw),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=tb[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};let wn=$a;wn.extension={name:"events",type:[V.RendererSystem,V.CanvasRendererSystem]};wn.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};q.add(wn);function Pc(e){return e==="dynamic"||e==="static"}const eb={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Pc(wn.defaultEventMode)},set interactive(e){ft("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??wn.defaultEventMode},set eventMode(e){this._internalInteractive=Pc(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,i){const s=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,n=typeof t=="function"?void 0:t;e=s?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,n)},removeEventListener(e,t,i){const s=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,n=typeof t=="function"?void 0:t;e=s?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof Sn))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Pt.mixin(eb);const ib={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Pt.mixin(ib);const sb=9,qn=100,nb=0,rb=0,Mc=2,Rc=1,ob=-1e3,ab=-1e3,hb=2;class mf{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(ei.tablet||ei.phone)&&this.createTouchHook();const i=document.createElement("div");i.style.width=`${qn}px`,i.style.height=`${qn}px`,i.style.position="absolute",i.style.top=`${nb}px`,i.style.left=`${rb}px`,i.style.zIndex=Mc.toString(),this.div=i,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${Rc}px`,t.style.height=`${Rc}px`,t.style.position="absolute",t.style.top=`${ob}px`,t.style.left=`${ab}px`,t.style.zIndex=hb.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const i=t.children;if(i)for(let s=0;s<i.length;s++)this.updateAccessibleObjects(i[s])}update(){const t=performance.now();if(ei.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:i,y:s,width:n,height:r}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,l=n/o*h,c=r/a*h;let u=this.div;u.style.left=`${i}px`,u.style.top=`${s}px`,u.style.width=`${o}px`,u.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,ms(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{u=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(u.style.left=`${(m.tx+p.x*m.a)*l}px`,u.style.top=`${(m.ty+p.y*m.d)*c}px`,u.style.width=`${p.width*m.a*l}px`,u.style.height=`${p.height*m.d*c}px`):(p=f.getBounds(),this.capHitArea(p),u.style.left=`${p.x*l}px`,u.style.top=`${p.y*c}px`,u.style.width=`${p.width*l}px`,u.style.height=`${p.height*c}px`,u.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(u.title=f.accessibleTitle),u.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&u.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==u.title||f.tabIndex!==u.tabIndex)&&(u.title=f.accessibleTitle,u.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:i,height:s}=this.renderer;t.x+t.width>i&&(t.width=i-t.x),t.y+t.height>s&&(t.height=s-t.y)}addChild(t){let i=this.pool.pop();i||(i=document.createElement("button"),i.style.width=`${qn}px`,i.style.height=`${qn}px`,i.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",i.style.position="absolute",i.style.zIndex=Mc.toString(),i.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?i.setAttribute("aria-live","off"):i.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?i.setAttribute("aria-relevant","additions"):i.setAttribute("aria-relevant","text"),i.addEventListener("click",this._onClick.bind(this)),i.addEventListener("focus",this._onFocus.bind(this)),i.addEventListener("focusout",this._onFocusOut.bind(this))),i.style.pointerEvents=t.accessiblePointerEvents,i.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?i.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(i.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&i.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(i),t._accessibleActive=!0,t._accessibleDiv=i,i.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,i){const{displayObject:s}=t.target,n=this.renderer.events.rootBoundary,r=Object.assign(new Sn(n),{target:s});n.rootTarget=this.renderer.lastObjectRendered,i.forEach(o=>n.dispatchEvent(r,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===sb&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}mf.extension={name:"accessibility",type:[V.RendererPlugin,V.CanvasRendererPlugin]};q.add(mf);const za=class{constructor(e){this.stage=new ae,e=Object.assign({forceCanvas:!1},e),this.renderer=vw(e),za._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){const i=za._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};let Hh=za;Hh._plugins=[];q.handleByList(V.Application,Hh._plugins);class gf{static init(t){Object.defineProperty(this,"resizeTo",{set(i){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let i,s;if(this._resizeTo===globalThis.window)i=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:r}=this._resizeTo;i=n,s=r}this.renderer.resize(i,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}gf.extension=V.Application;q.add(gf);const Dc={loader:V.LoadParser,resolver:V.ResolveParser,cache:V.CacheParser,detection:V.DetectionParser};q.handle(V.Asset,e=>{const t=e.ref;Object.entries(Dc).filter(([i])=>!!t[i]).forEach(([i,s])=>q.add(Object.assign(t[i],{extension:t[i].extension??s})))},e=>{const t=e.ref;Object.keys(Dc).filter(i=>!!t[i]).forEach(i=>q.remove(t[i]))});class lb{constructor(t,i=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=i}add(t){t.forEach(i=>{this._assetList.push(i)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],i=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<i;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Cn(e,t){if(Array.isArray(t)){for(const i of t)if(e.startsWith(`data:${i}`))return!0;return!1}return e.startsWith(`data:${t}`)}function Yi(e,t){const i=e.split("?")[0],s=Kt.extname(i).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const ii=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(i=>typeof i=="string"?t(i):i):e),Va=(e,t)=>{const i=t.split("?")[1];return i&&(e+=`?${i}`),e};function _f(e,t,i,s,n){const r=t[i];for(let o=0;o<r.length;o++){const a=r[o];i<t.length-1?_f(e.replace(s[i],a),t,i+1,s,n):n.push(e.replace(s[i],a))}}function cb(e){const t=/\{(.*?)\}/g,i=e.match(t),s=[];if(i){const n=[];i.forEach(r=>{const o=r.substring(1,r.length-1).split(",");n.push(o)}),_f(e,n,0,i,s)}else s.push(e);return s}const Nr=e=>!Array.isArray(e);class ub{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const i=this._cache.get(t);return i||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),i}set(t,i){const s=ii(t);let n;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(i)){n=h.getCacheableAssets(s,i);break}}n||(n={},s.forEach(a=>{n[a]=i}));const r=Object.keys(n),o={cacheKeys:r,keys:s};if(s.forEach(a=>{this._cacheMap.set(a,o)}),r.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==i&&console.warn("[Cache] already has key:",a),this._cache.set(a,n[a])}),i instanceof K){const a=i;s.forEach(h=>{a.baseTexture!==K.EMPTY.baseTexture&&at.addToCache(a.baseTexture,h),K.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const i=this._cacheMap.get(t);i.cacheKeys.forEach(n=>{this._cache.delete(n)}),i.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const Hs=new ub;class db{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,i,s)=>(this._parsersValidated=!1,t[i]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,i){const s={promise:null,parser:null};return s.promise=(async()=>{var o,a;let n=null,r=null;if(i.loadParser&&(r=this._parserHash[i.loadParser],r||console.warn(`[Assets] specified load parser "${i.loadParser}" not found while loading ${t}`)),!r){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,i,this))){r=l;break}}if(!r)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await r.load(t,i,this),s.parser=r;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,n,i,this))&&(n=await l.parse(n,i,this)||n,s.parser=l)}return n})(),s}async load(t,i){this._parsersValidated||this._validateParsers();let s=0;const n={},r=Nr(t),o=ii(t,l=>({src:l})),a=o.length,h=o.map(async l=>{const c=Kt.toAbsolute(l.src);if(!n[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),n[l.src]=await this.promiseCache[c].promise,i&&i(++s/a)}catch(u){throw delete this.promiseCache[c],delete n[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),r?n[o[0].src]:n}async unload(t){const s=ii(t,n=>({src:n})).map(async n=>{var a,h;const r=Kt.toAbsolute(n.src),o=this.promiseCache[r];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,n,this),delete this.promiseCache[r]}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,i)=>(t[i.name]&&console.warn(`[Assets] loadParser name conflict "${i.name}"`),{...t,[i.name]:i}),{})}}var je=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(je||{});const fb=".json",pb="application/json",mb={extension:{type:V.LoadParser,priority:je.Low},name:"loadJson",test(e){return Cn(e,pb)||Yi(e,fb)},async load(e){return await(await z.ADAPTER.fetch(e)).json()}};q.add(mb);const gb=".txt",_b="text/plain",xb={name:"loadTxt",extension:{type:V.LoadParser,priority:je.Low},test(e){return Cn(e,_b)||Yi(e,gb)},async load(e){return await(await z.ADAPTER.fetch(e)).text()}};q.add(xb);const yb=["normal","bold","100","200","300","400","500","600","700","800","900"],vb=[".ttf",".otf",".woff",".woff2"],wb=["font/ttf","font/otf","font/woff","font/woff2"],bb=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Tb(e){const t=Kt.extname(e),n=Kt.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let r=n.length>0;for(const a of n)if(!a.match(bb)){r=!1;break}let o=n.join(" ");return r||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const Eb={extension:{type:V.LoadParser,priority:je.Low},name:"loadWebFont",test(e){return Cn(e,wb)||Yi(e,vb)},async load(e,t){var s,n,r;const i=z.ADAPTER.getFontFaceSet();if(i){const o=[],a=((s=t.data)==null?void 0:s.family)??Tb(e),h=((r=(n=t.data)==null?void 0:n.weights)==null?void 0:r.filter(c=>yb.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],d=new FontFace(a,`url(${encodeURI(e)})`,{...l,weight:u});await d.load(),i.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>z.ADAPTER.getFontFaceSet().delete(t))}};q.add(Eb);let Bc=0,zo;const Ab="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Sb={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Ab}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Cb={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Vo;class Ib{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const i=URL.createObjectURL(new Blob([Sb.code],{type:"application/javascript"})),s=new Worker(i);s.addEventListener("message",n=>{s.terminate(),URL.revokeObjectURL(i),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){zo===void 0&&(zo=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<zo&&(Vo||(Vo=URL.createObjectURL(new Blob([Cb.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Vo),t.addEventListener("message",i=>{this.complete(i.data),this.returnWorker(i.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,i){await this._initWorkers();const s=new Promise((n,r)=>{this.queue.push({id:t,arguments:i,resolve:n,reject:r})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const i=this.queue.pop(),s=i.id;this.resolveHash[Bc]={resolve:i.resolve,reject:i.reject},t.postMessage({data:i.arguments,uuid:Bc++,id:s})}}const Fc=new Ib;function ho(e,t,i){const s=new K(e);return s.baseTexture.on("dispose",()=>{delete t.promiseCache[i]}),s}const Pb=[".jpeg",".jpg",".png",".webp",".avif"],Mb=["image/jpeg","image/png","image/webp","image/avif"];async function Rb(e){const t=await z.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const i=await t.blob();return await createImageBitmap(i)}const lo={name:"loadTextures",extension:{type:V.LoadParser,priority:je.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return Cn(e,Mb)||Yi(e,Pb)},async load(e,t,i){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Fc.isImageBitmapSupported()?s=await Fc.loadImageBitmap(e):s=await Rb(e):s=await new Promise(r=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=e,s.complete?r(s):s.onload=()=>{r(s)}});const n=new at(s,{resolution:bi(e),...t.data});return n.resource.src=e,ho(n,i,e)},unload(e){e.destroy(!0)}};q.add(lo);const Db=".svg",Bb="image/svg+xml",Fb={extension:{type:V.LoadParser,priority:je.High},name:"loadSVG",test(e){return Cn(e,Bb)||Yi(e,Db)},async testParse(e){return vn.test(e)},async parse(e,t,i){var o;const s=new vn(e,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions);await s.load();const n=new at(s,{resolution:bi(e),...t==null?void 0:t.data});return n.resource.src=e,ho(n,i,e)},async load(e,t){return(await z.ADAPTER.fetch(e)).text()},unload:lo.unload};q.add(Fb);class Nb{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,i)=>`${t}${this._bundleIdConnector}${i}`,extractAssetIdFromBundle:(t,i)=>i.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(i=>{this._preferredOrder.push(i),i.priority||(i.priority=Object.keys(i.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const i=t;this._defaultSearchParams=Object.keys(i).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(i[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(i=>{this.addBundle(i.name,i.assets)})}addBundle(t,i){const s=[];Array.isArray(i)?i.forEach(n=>{if(typeof n.name=="string"){const r=this._createBundleAssetId(t,n.name);s.push(r),this.add([n.name,r],n.srcs,n.data)}else{const r=n.name.map(o=>this._createBundleAssetId(t,o));r.forEach(o=>{s.push(o)}),this.add([...n.name,...r],n.srcs)}}):Object.keys(i).forEach(n=>{s.push(this._createBundleAssetId(t,n)),this.add([n,this._createBundleAssetId(t,n)],i[n])}),this._bundles[t]=s}add(t,i,s){const n=ii(t);n.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(i)||(typeof i=="string"?i=cb(i):i=[i]);const r=i.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let l=0;l<this._parsers.length;l++){const c=this._parsers[l];if(c.test(o)){a=c.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=n),(this._basePath||this._rootPath)&&(a.src=Kt.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??s,a});n.forEach(o=>{this._assetMap[o]=r})}resolveBundle(t){const i=Nr(t);t=ii(t);const s={};return t.forEach(n=>{const r=this._bundles[n];if(r){const o=this.resolve(r),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(n,h)]=l}s[n]=a}}),i?s[t[0]]:s}resolveUrl(t){const i=this.resolve(t);if(typeof t!="string"){const s={};for(const n in i)s[n]=i[n].src;return s}return i.src}resolve(t){const i=Nr(t);t=ii(t);const s={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let r=this._assetMap[n];const o=this._getPreferredOrder(r),a=r[0];o==null||o.priority.forEach(h=>{o.params[h].forEach(l=>{const c=r.filter(u=>u[h]?u[h]===l:!1);c.length&&(r=c)})}),this._resolverHash[n]=r[0]??a}else{let r=n;(this._basePath||this._rootPath)&&(r=Kt.toAbsolute(r,this._basePath,this._rootPath)),r=this._appendDefaultSearchParams(r),this._resolverHash[n]={src:r}}s[n]=this._resolverHash[n]}),i?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let i=0;i<t.length;i++){const s=t[0],n=this._preferredOrder.find(r=>r.params.format.includes(s.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const i=/\?/.test(t)?"&":"?";return`${t}${i}${this._defaultSearchParams}`}}class Ob{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Nb,this.loader=new db,this.cache=Hs,this._backgroundLoader=new lb(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const i=((r=t.texturePreference)==null?void 0:r.resolution)??1,s=typeof i=="number"?[i]:i;let n=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;n=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(n=await l.remove(n))}else for(const h of this._detections)await h.test()&&(n=await h.add(n));this.resolver.prefer({params:{format:n,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t,i,s){this.resolver.add(t,i,s)}async load(t,i){this._initialized||await this.init();const s=Nr(t),n=ii(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),r=this.resolver.resolve(n),o=await this._mapLoadToResolve(r,i);return s?o[n[0]]:o}addBundle(t,i){this.resolver.addBundle(t,i)}async loadBundle(t,i){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const n=this.resolver.resolveBundle(t),r={},o=Object.keys(n);let a=0,h=0;const l=()=>{i==null||i(++a/h)},c=o.map(u=>{const d=n[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{r[u]=f})});return await Promise.all(c),s?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const i=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(i))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const i=this.resolver.resolveBundle(t);Object.values(i).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Hs.get(t);const i={};for(let s=0;s<t.length;s++)i[s]=Hs.get(t[s]);return i}async _mapLoadToResolve(t,i){const s=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;const r=await this.loader.load(s,i);this._backgroundLoader.active=!0;const o={};return s.forEach((a,h)=>{const l=r[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[n[h]]=l,Hs.set(c,l)}),o}async unload(t){this._initialized||await this.init();const i=ii(t).map(n=>typeof n!="string"?n.src:n),s=this.resolver.resolve(i);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=ii(t);const i=this.resolver.resolveBundle(t),s=Object.keys(i).map(n=>this._unloadFromResolved(i[n]));await Promise.all(s)}async _unloadFromResolved(t){const i=Object.values(t);i.forEach(s=>{Hs.remove(s.src)}),await this.loader.unload(i)}get detections(){return this._detections}get preferWorkers(){return lo.config.preferWorkers}set preferWorkers(t){ft("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(i=>{i.config&&Object.keys(i.config).filter(s=>s in t).forEach(s=>{i.config[s]=t[s]})})}}const Zn=new Ob;q.handleByList(V.LoadParser,Zn.loader.parsers).handleByList(V.ResolveParser,Zn.resolver.parsers).handleByList(V.CacheParser,Zn.cache.parsers).handleByList(V.DetectionParser,Zn.detections);const Lb={extension:V.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof K),getCacheableAssets:(e,t)=>{const i={};return e.forEach(s=>{t.forEach((n,r)=>{i[s+(r===0?"":r+1)]=n})}),i}};q.add(Lb);const kb={extension:{type:V.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await z.ADAPTER.fetch(e).then(i=>i.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};q.add(kb);const Ub={extension:{type:V.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await z.ADAPTER.fetch(e).then(i=>i.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};q.add(Ub);const Nc=["png","jpg","jpeg"],Hb={extension:{type:V.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...Nc],remove:async e=>e.filter(t=>!Nc.includes(t))};q.add(Hb);const Gb={extension:V.ResolveParser,test:lo.test,parse:e=>{var t;return{resolution:parseFloat(((t=z.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:e.split(".").pop(),src:e}}};q.add(Gb);var re=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(re||{});const Or={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let Ze,is;function Oc(){is={s3tc:Ze.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ze.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Ze.getExtension("WEBGL_compressed_texture_etc"),etc1:Ze.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Ze.getExtension("WEBGL_compressed_texture_pvrtc")||Ze.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Ze.getExtension("WEBGL_compressed_texture_atc"),astc:Ze.getExtension("WEBGL_compressed_texture_astc")}}const Wb={extension:{type:V.DetectionParser,priority:2},test:async()=>{const t=z.ADAPTER.createCanvas().getContext("webgl");return t?(Ze=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{is||Oc();const t=[];for(const i in is)is[i]&&t.push(i);return[...t,...e]},remove:async e=>(is||Oc(),e.filter(t=>!(t in is)))};q.add(Wb);class Xb extends An{constructor(t,i={width:1,height:1,autoLoad:!0}){let s,n;typeof t=="string"?(s=t,n=new Uint8Array):(s=null,n=t),super(n,i),this.origin=s,this.buffer=n?new Da(n):null,this._load=null,this.loaded=!1,this.origin!==null&&i.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Da(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Gi extends Xb{constructor(t,i){super(t,i),this.format=i.format,this.levels=i.levels||1,this._width=i.width,this._height=i.height,this._extension=Gi._formatToExtension(this.format),(i.levelBuffers||this.buffer)&&(this._levelBuffers=i.levelBuffers||Gi._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,i,s){const n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){const{levelID:h,levelWidth:l,levelHeight:c,levelBuffer:u}=this._levelBuffers[o];n.compressedTexImage2D(n.TEXTURE_2D,h,this.format,l,c,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Gi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,i,s,n,r,o,a){const h=new Array(s);let l=t.byteOffset,c=o,u=a,d=c+n-1&~(n-1),f=u+r-1&~(r-1),p=d*f*Or[i];for(let m=0;m<s;m++)h[m]={levelID:m,levelWidth:s>1?c:d,levelHeight:s>1?u:f,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,c=c>>1||1,u=u>>1||1,d=c+n-1&~(n-1),f=u+r-1&~(r-1),p=d*f*Or[i];return h}}const jo=4,Jn=124,$b=32,Lc=20,zb=542327876,Qn={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Vb={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},tr={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},jb=1,Yb=2,Kb=4,qb=64,Zb=512,Jb=131072,Qb=827611204,t1=861165636,e1=894720068,i1=808540228,s1=4,n1={[Qb]:re.COMPRESSED_RGBA_S3TC_DXT1_EXT,[t1]:re.COMPRESSED_RGBA_S3TC_DXT3_EXT,[e1]:re.COMPRESSED_RGBA_S3TC_DXT5_EXT},r1={[70]:re.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:re.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:re.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:re.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:re.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:re.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:re.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:re.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:re.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function o1(e){const t=new Uint32Array(e);if(t[0]!==zb)throw new Error("Invalid DDS file magic word");const s=new Uint32Array(e,0,Jn/Uint32Array.BYTES_PER_ELEMENT),n=s[Qn.HEIGHT],r=s[Qn.WIDTH],o=s[Qn.MIPMAP_COUNT],a=new Uint32Array(e,Qn.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,$b/Uint32Array.BYTES_PER_ELEMENT),h=a[jb];if(h&Kb){const l=a[Vb.FOURCC];if(l!==i1){const _=n1[l],x=jo+Jn,A=new Uint8Array(e,x);return[new Gi(A,{format:_,width:r,height:n,levels:o})]}const c=jo+Jn,u=new Uint32Array(t.buffer,c,Lc/Uint32Array.BYTES_PER_ELEMENT),d=u[tr.DXGI_FORMAT],f=u[tr.RESOURCE_DIMENSION],p=u[tr.MISC_FLAG],m=u[tr.ARRAY_SIZE],g=r1[d];if(g===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(p===s1)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const y=new Array,v=jo+Jn+Lc;if(m===1)y.push(new Uint8Array(e,v));else{const _=Or[g];let x=0,A=r,T=n;for(let S=0;S<o;S++){const G=Math.max(1,A+3&-4),H=Math.max(1,T+3&-4),N=G*H*_;x+=N,A=A>>>1,T=T>>>1}let I=v;for(let S=0;S<m;S++)y.push(new Uint8Array(e,I,x)),I+=x}return y.map(_=>new Gi(_,{format:g,width:r,height:n,levels:o}))}throw h&qb?new Error("DDSParser does not support uncompressed texture data."):h&Zb?new Error("DDSParser does not supported YUV uncompressed texture data."):h&Jb?new Error("DDSParser does not support single-channel (lumninance) texture data!"):h&Yb?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const kc=[171,75,84,88,32,49,49,187,13,10,26,10],a1=67305985,fe={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},ja=64,Uc={[et.UNSIGNED_BYTE]:1,[et.UNSIGNED_SHORT]:2,[et.INT]:4,[et.UNSIGNED_INT]:4,[et.FLOAT]:4,[et.HALF_FLOAT]:8},h1={[U.RGBA]:4,[U.RGB]:3,[U.RG]:2,[U.RED]:1,[U.LUMINANCE]:1,[U.LUMINANCE_ALPHA]:2,[U.ALPHA]:1},l1={[et.UNSIGNED_SHORT_4_4_4_4]:2,[et.UNSIGNED_SHORT_5_5_5_1]:2,[et.UNSIGNED_SHORT_5_6_5]:2};function c1(e,t,i=!1){const s=new DataView(t);if(!u1(e,s))return null;const n=s.getUint32(fe.ENDIANNESS,!0)===a1,r=s.getUint32(fe.GL_TYPE,n),o=s.getUint32(fe.GL_FORMAT,n),a=s.getUint32(fe.GL_INTERNAL_FORMAT,n),h=s.getUint32(fe.PIXEL_WIDTH,n),l=s.getUint32(fe.PIXEL_HEIGHT,n)||1,c=s.getUint32(fe.PIXEL_DEPTH,n)||1,u=s.getUint32(fe.NUMBER_OF_ARRAY_ELEMENTS,n)||1,d=s.getUint32(fe.NUMBER_OF_FACES,n),f=s.getUint32(fe.NUMBER_OF_MIPMAP_LEVELS,n),p=s.getUint32(fe.BYTES_OF_KEY_VALUE_DATA,n);if(l===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");const m=4,g=4,y=h+3&-4,v=l+3&-4,_=new Array(u);let x=h*l;r===0&&(x=y*v);let A;if(r!==0?Uc[r]?A=Uc[r]*h1[o]:A=l1[r]:A=Or[a],A===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const T=i?f1(s,p,n):null;let S=x*A,G=h,H=l,N=y,$=v,D=ja+p;for(let M=0;M<f;M++){const ht=s.getUint32(D,n);let it=D+4;for(let O=0;O<u;O++){let Z=_[O];Z||(Z=_[O]=new Array(f)),Z[M]={levelID:M,levelWidth:f>1||r!==0?G:N,levelHeight:f>1||r!==0?H:$,levelBuffer:new Uint8Array(t,it,S)},it+=S}D+=ht+4,D=D%4!==0?D+4-D%4:D,G=G>>1||1,H=H>>1||1,N=G+m-1&~(m-1),$=H+g-1&~(g-1),S=N*$*A}return r!==0?{uncompressed:_.map(M=>{let ht=M[0].levelBuffer,it=!1;return r===et.FLOAT?ht=new Float32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4):r===et.UNSIGNED_INT?(it=!0,ht=new Uint32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4)):r===et.INT&&(it=!0,ht=new Int32Array(M[0].levelBuffer.buffer,M[0].levelBuffer.byteOffset,M[0].levelBuffer.byteLength/4)),{resource:new An(ht,{width:M[0].levelWidth,height:M[0].levelHeight}),type:r,format:it?d1(o):o}}),kvData:T}:{compressed:_.map(M=>new Gi(null,{format:a,width:h,height:l,levels:f,levelBuffers:M})),kvData:T}}function u1(e,t){for(let i=0;i<kc.length;i++)if(t.getUint8(i)!==kc[i])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function d1(e){switch(e){case U.RGBA:return U.RGBA_INTEGER;case U.RGB:return U.RGB_INTEGER;case U.RG:return U.RG_INTEGER;case U.RED:return U.RED_INTEGER;default:return e}}function f1(e,t,i){const s=new Map;let n=0;for(;n<t;){const r=e.getUint32(ja+n,i),o=ja+n+4,a=3-(r+3)%4;if(r===0||r>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<r&&e.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=new TextDecoder().decode(new Uint8Array(e.buffer,o,h)),c=new DataView(e.buffer,o+h+1,r-h-1);s.set(l,c),n+=4+r+a}return s}const p1={extension:{type:V.LoadParser,priority:je.High},name:"loadDDS",test(e){return Yi(e,".dds")},async load(e,t,i){const n=await(await z.ADAPTER.fetch(e)).arrayBuffer(),o=o1(n).map(a=>{const h=new at(a,{mipmap:ze.OFF,alphaMode:De.NO_PREMULTIPLIED_ALPHA,resolution:bi(e),...t.data});return ho(h,i,e)});return o.length===1?o[0]:o},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};q.add(p1);const m1={extension:{type:V.LoadParser,priority:je.High},name:"loadKTX",test(e){return Yi(e,".ktx")},async load(e,t,i){const n=await(await z.ADAPTER.fetch(e)).arrayBuffer(),{compressed:r,uncompressed:o,kvData:a}=c1(e,n),h=r??o,l={mipmap:ze.OFF,alphaMode:De.NO_PREMULTIPLIED_ALPHA,resolution:bi(e),...t.data},c=h.map(u=>{h===o&&Object.assign(l,{type:u.type,format:u.format});const d=new at(u,l);return d.ktxKeyValueData=a,ho(d,i,e)});return c.length===1?c[0]:c},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};q.add(m1);const g1={extension:V.ResolveParser,test:e=>{const i=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(i)},parse:e=>{var s,n;if(e.split("?")[0].split(".").pop()==="ktx"){const r=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(r.some(o=>e.endsWith(o)))return{resolution:parseFloat(((s=z.RETINA_PREFIX.exec(e))==null?void 0:s[1])??"1"),format:r.find(o=>e.endsWith(o)),src:e}}return{resolution:parseFloat(((n=z.RETINA_PREFIX.exec(e))==null?void 0:n[1])??"1"),format:e.split(".").pop(),src:e}}};q.add(g1);const _1=new lt,x1=4,Ks=class{constructor(e){this.renderer=e}async image(e,t,i){const s=new Image;return s.src=await this.base64(e,t,i),s}async base64(e,t,i){const s=this.canvas(e);if(s.toBlob!==void 0)return new Promise((n,r)=>{s.toBlob(o=>{if(!o){r(new Error("ICanvas.toBlob failed!"));return}const a=new FileReader;a.onload=()=>n(a.result),a.onerror=r,a.readAsDataURL(o)},t,i)});if(s.toDataURL!==void 0)return s.toDataURL(t,i);if(s.convertToBlob!==void 0){const n=await s.convertToBlob({type:t,quality:i});return new Promise((r,o)=>{const a=new FileReader;a.onload=()=>r(a.result),a.onerror=o,a.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:i,width:s,height:n,flipY:r}=this._rawPixels(e,t);r&&Ks._flipY(i,s,n),Ks._unpremultiplyAlpha(i);const o=new cv(s,n,1),a=new ImageData(new Uint8ClampedArray(i.buffer),s,n);return o.context.putImageData(a,0,0),o.canvas}pixels(e,t){const{pixels:i,width:s,height:n,flipY:r}=this._rawPixels(e,t);return r&&Ks._flipY(i,s,n),Ks._unpremultiplyAlpha(i),i}_rawPixels(e,t){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let s,n=!1,r,o=!1;if(e&&(e instanceof ji?r=e:(r=i.generateTexture(e,{resolution:i.resolution,multisample:i.multisample}),o=!0)),r){if(s=r.baseTexture.resolution,t=t??r.frame,n=!1,!o){i.renderTexture.bind(r);const u=r.framebuffer.glFramebuffers[i.CONTEXT_UID];u.blitFramebuffer&&i.framebuffer.bind(u.blitFramebuffer)}}else s=i.resolution,t||(t=_1,t.width=i.width/s,t.height=i.height/s),n=!0,i.renderTexture.bind();const a=Math.round(t.width*s),h=Math.round(t.height*s),l=new Uint8Array(x1*a*h),c=i.gl;return c.readPixels(Math.round(t.x*s),Math.round(t.y*s),a,h,c.RGBA,c.UNSIGNED_BYTE,l),o&&(r==null||r.destroy(!0)),{pixels:l,width:a,height:h,flipY:n}}destroy(){this.renderer=null}static _flipY(e,t,i){const s=t<<2,n=i>>1,r=new Uint8Array(s);for(let o=0;o<n;o++){const a=o*s,h=(i-o-1)*s;r.set(e.subarray(a,a+s)),e.copyWithin(a,h,h+s),e.set(r,h)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let i=0;i<t;i+=4){const s=e[i+3];if(s!==0){const n=255.001/s;e[i]=e[i]*n+.5,e[i+1]=e[i+1]*n+.5,e[i+2]=e[i+2]*n+.5}}}};let xf=Ks;xf.extension={name:"extract",type:V.RendererSystem};q.add(xf);const Lr={build(e){const t=e.points;let i,s,n,r,o,a;if(e.type===$t.CIRC){const p=e.shape;i=p.x,s=p.y,o=a=p.radius,n=r=0}else if(e.type===$t.ELIP){const p=e.shape;i=p.x,s=p.y,o=p.width,a=p.height,n=r=0}else{const p=e.shape,m=p.width/2,g=p.height/2;i=p.x+m,s=p.y+g,o=a=Math.max(0,Math.min(p.radius,Math.min(m,g))),n=m-o,r=g-a}if(!(o>=0&&a>=0&&n>=0&&r>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(n?4:0)+(r?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=i+n,t[1]=t[3]=s+r,t[2]=t[4]=i-n,t[5]=t[7]=s-r;return}let c=0,u=h*4+(n?2:0)+2,d=u,f=l;{const p=n+o,m=r,g=i+p,y=i-p,v=s+m;if(t[c++]=g,t[c++]=v,t[--u]=v,t[--u]=y,r){const _=s-m;t[d++]=y,t[d++]=_,t[--f]=_,t[--f]=g}}for(let p=1;p<h;p++){const m=Math.PI/2*(p/h),g=n+Math.cos(m)*o,y=r+Math.sin(m)*a,v=i+g,_=i-g,x=s+y,A=s-y;t[c++]=v,t[c++]=x,t[--u]=x,t[--u]=_,t[d++]=_,t[d++]=A,t[--f]=A,t[--f]=v}{const p=n,m=r+a,g=i+p,y=i-p,v=s+m,_=s-m;t[c++]=g,t[c++]=v,t[--f]=_,t[--f]=g,n&&(t[c++]=y,t[c++]=v,t[--f]=_,t[--f]=y)}},triangulate(e,t){const i=e.points,s=t.points,n=t.indices;if(i.length===0)return;let r=s.length/2;const o=r;let a,h;if(e.type!==$t.RREC){const c=e.shape;a=c.x,h=c.y}else{const c=e.shape;a=c.x+c.width/2,h=c.y+c.height/2}const l=e.matrix;s.push(e.matrix?l.a*a+l.c*h+l.tx:a,e.matrix?l.b*a+l.d*h+l.ty:h),r++,s.push(i[0],i[1]);for(let c=2;c<i.length;c+=2)s.push(i[c],i[c+1]),n.push(r++,o,r);n.push(o+1,o,r)}};function Hc(e,t=!1){const i=e.length;if(i<6)return;let s=0;for(let n=0,r=e[i-2],o=e[i-1];n<i;n+=2){const a=e[n],h=e[n+1];s+=(a-r)*(h+o),r=a,o=h}if(!t&&s>0||t&&s<=0){const n=i/2;for(let r=n+n%2;r<i;r+=2){const o=i-r-2,a=i-r-1,h=r,l=r+1;[e[o],e[h]]=[e[h],e[o]],[e[a],e[l]]=[e[l],e[a]]}}}const yf={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let i=e.points;const s=e.holes,n=t.points,r=t.indices;if(i.length>=6){Hc(i,!1);const o=[];for(let l=0;l<s.length;l++){const c=s[l];Hc(c.points,!0),o.push(i.length/2),i=i.concat(c.points)}const a=Ay(i,o,2);if(!a)return;const h=n.length/2;for(let l=0;l<a.length;l+=3)r.push(a[l]+h),r.push(a[l+1]+h),r.push(a[l+2]+h);for(let l=0;l<i.length;l++)n.push(i[l])}}},y1={build(e){const t=e.shape,i=t.x,s=t.y,n=t.width,r=t.height,o=e.points;o.length=0,n>=0&&r>=0&&o.push(i,s,i+n,s,i+n,s+r,i,s+r)},triangulate(e,t){const i=e.points,s=t.points;if(i.length===0)return;const n=s.length/2;s.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},v1={build(e){Lr.build(e)},triangulate(e,t){Lr.triangulate(e,t)}};var xe=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(xe||{}),Oi=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(Oi||{});const As={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let i=Math.ceil(e/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};class Gc{static curveTo(t,i,s,n,r,o){const a=o[o.length-2],l=o[o.length-1]-i,c=a-t,u=n-i,d=s-t,f=Math.abs(l*d-c*u);if(f<1e-8||r===0)return(o[o.length-2]!==t||o[o.length-1]!==i)&&o.push(t,i),null;const p=l*l+c*c,m=u*u+d*d,g=l*u+c*d,y=r*Math.sqrt(p)/f,v=r*Math.sqrt(m)/f,_=y*g/p,x=v*g/m,A=y*d+v*c,T=y*u+v*l,I=c*(v+_),S=l*(v+_),G=d*(y+x),H=u*(y+x),N=Math.atan2(S-T,I-A),$=Math.atan2(H-T,G-A);return{cx:A+t,cy:T+i,radius:r,startAngle:N,endAngle:$,anticlockwise:c*u>d*l}}static arc(t,i,s,n,r,o,a,h,l){const c=a-o,u=As._segmentsCount(Math.abs(c)*r,Math.ceil(Math.abs(c)/Dr)*40),d=c/(u*2),f=d*2,p=Math.cos(d),m=Math.sin(d),g=u-1,y=g%1/g;for(let v=0;v<=g;++v){const _=v+y*v,x=d+o+f*_,A=Math.cos(x),T=-Math.sin(x);l.push((p*A+m*T)*r+s,(p*-T+m*A)*r+n)}}}class w1{constructor(){this.reset()}begin(t,i,s){this.reset(),this.style=t,this.start=i,this.attribStart=s}end(t,i){this.attribSize=i-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Gh{static curveLength(t,i,s,n,r,o,a,h){let c=0,u=0,d=0,f=0,p=0,m=0,g=0,y=0,v=0,_=0,x=0,A=t,T=i;for(let I=1;I<=10;++I)u=I/10,d=u*u,f=d*u,p=1-u,m=p*p,g=m*p,y=g*t+3*m*u*s+3*p*d*r+f*a,v=g*i+3*m*u*n+3*p*d*o+f*h,_=A-y,x=T-v,A=y,T=v,c+=Math.sqrt(_*_+x*x);return c}static curveTo(t,i,s,n,r,o,a){const h=a[a.length-2],l=a[a.length-1];a.length-=2;const c=As._segmentsCount(Gh.curveLength(h,l,t,i,s,n,r,o));let u=0,d=0,f=0,p=0,m=0;a.push(h,l);for(let g=1,y=0;g<=c;++g)y=g/c,u=1-y,d=u*u,f=d*u,p=y*y,m=p*y,a.push(f*h+3*d*y*t+3*u*p*s+m*r,f*l+3*d*y*i+3*u*p*n+m*o)}}function Wc(e,t,i,s,n,r,o,a){const h=e-i*n,l=t-s*n,c=e+i*r,u=t+s*r;let d,f;o?(d=s,f=-i):(d=-s,f=i);const p=h+d,m=l+f,g=c+d,y=u+f;return a.push(p,m,g,y),2}function Ii(e,t,i,s,n,r,o,a){const h=i-e,l=s-t;let c=Math.atan2(h,l),u=Math.atan2(n-e,r-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c;const f=u-c,p=Math.abs(f),m=Math.sqrt(h*h+l*l),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(e,t,i,s);for(let v=1,_=d;v<g;v++,_+=y)o.push(e,t,e+Math.sin(_)*m,t+Math.cos(_)*m);o.push(e,t,n,r)}else{o.push(i,s,e,t);for(let v=1,_=d;v<g;v++,_+=y)o.push(e+Math.sin(_)*m,t+Math.cos(_)*m,e,t);o.push(n,r,e,t)}return g*2}function b1(e,t){const i=e.shape;let s=e.points||i.points.slice();const n=t.closePointEps;if(s.length===0)return;const r=e.lineStyle,o=new st(s[0],s[1]),a=new st(s[s.length-2],s[s.length-1]),h=i.type!==$t.POLY||i.closeStroke,l=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){s=s.slice(),l&&(s.pop(),s.pop(),a.set(s[s.length-2],s[s.length-1]));const O=(o.x+a.x)*.5,Z=(a.y+o.y)*.5;s.unshift(O,Z),s.push(O,Z)}const c=t.points,u=s.length/2;let d=s.length;const f=c.length/2,p=r.width/2,m=p*p,g=r.miterLimit*r.miterLimit;let y=s[0],v=s[1],_=s[2],x=s[3],A=0,T=0,I=-(v-x),S=y-_,G=0,H=0,N=Math.sqrt(I*I+S*S);I/=N,S/=N,I*=p,S*=p;const $=r.alignment,D=(1-$)*2,M=$*2;h||(r.cap===Oi.ROUND?d+=Ii(y-I*(D-M)*.5,v-S*(D-M)*.5,y-I*D,v-S*D,y+I*M,v+S*M,c,!0)+2:r.cap===Oi.SQUARE&&(d+=Wc(y,v,I,S,D,M,!0,c))),c.push(y-I*D,v-S*D,y+I*M,v+S*M);for(let O=1;O<u-1;++O){y=s[(O-1)*2],v=s[(O-1)*2+1],_=s[O*2],x=s[O*2+1],A=s[(O+1)*2],T=s[(O+1)*2+1],I=-(v-x),S=y-_,N=Math.sqrt(I*I+S*S),I/=N,S/=N,I*=p,S*=p,G=-(x-T),H=_-A,N=Math.sqrt(G*G+H*H),G/=N,H/=N,G*=p,H*=p;const Z=_-y,_t=v-x,B=_-A,J=T-x,rt=Z*B+_t*J,mt=_t*B-J*Z,yt=mt<0;if(Math.abs(mt)<.001*Math.abs(rt)){c.push(_-I*D,x-S*D,_+I*M,x+S*M),rt>=0&&(r.join===xe.ROUND?d+=Ii(_,x,_-I*D,x-S*D,_-G*D,x-H*D,c,!1)+4:d+=2,c.push(_-G*M,x-H*M,_+G*D,x+H*D));continue}const Dt=(-I+y)*(-S+x)-(-I+_)*(-S+v),xt=(-G+A)*(-H+x)-(-G+_)*(-H+T),St=(Z*xt-B*Dt)/mt,Lt=(J*Dt-_t*xt)/mt,Bt=(St-_)*(St-_)+(Lt-x)*(Lt-x),Mt=_+(St-_)*D,vt=x+(Lt-x)*D,w=_-(St-_)*M,b=x-(Lt-x)*M,E=Math.min(Z*Z+_t*_t,B*B+J*J),P=yt?D:M,R=E+P*P*m,L=Bt<=R;let X=r.join;if(X===xe.MITER&&Bt/m>g&&(X=xe.BEVEL),L)switch(X){case xe.MITER:{c.push(Mt,vt,w,b);break}case xe.BEVEL:{yt?c.push(Mt,vt,_+I*M,x+S*M,Mt,vt,_+G*M,x+H*M):c.push(_-I*D,x-S*D,w,b,_-G*D,x-H*D,w,b),d+=2;break}case xe.ROUND:{yt?(c.push(Mt,vt,_+I*M,x+S*M),d+=Ii(_,x,_+I*M,x+S*M,_+G*M,x+H*M,c,!0)+4,c.push(Mt,vt,_+G*M,x+H*M)):(c.push(_-I*D,x-S*D,w,b),d+=Ii(_,x,_-I*D,x-S*D,_-G*D,x-H*D,c,!1)+4,c.push(_-G*D,x-H*D,w,b));break}}else{switch(c.push(_-I*D,x-S*D,_+I*M,x+S*M),X){case xe.MITER:{yt?c.push(w,b,w,b):c.push(Mt,vt,Mt,vt),d+=2;break}case xe.ROUND:{yt?d+=Ii(_,x,_+I*M,x+S*M,_+G*M,x+H*M,c,!0)+2:d+=Ii(_,x,_-I*D,x-S*D,_-G*D,x-H*D,c,!1)+2;break}}c.push(_-G*D,x-H*D,_+G*M,x+H*M),d+=2}}y=s[(u-2)*2],v=s[(u-2)*2+1],_=s[(u-1)*2],x=s[(u-1)*2+1],I=-(v-x),S=y-_,N=Math.sqrt(I*I+S*S),I/=N,S/=N,I*=p,S*=p,c.push(_-I*D,x-S*D,_+I*M,x+S*M),h||(r.cap===Oi.ROUND?d+=Ii(_-I*(D-M)*.5,x-S*(D-M)*.5,_-I*D,x-S*D,_+I*M,x+S*M,c,!1)+2:r.cap===Oi.SQUARE&&(d+=Wc(_,x,I,S,D,M,!1,c)));const ht=t.indices,it=As.epsilon*As.epsilon;for(let O=f;O<d+f-2;++O)y=c[O*2],v=c[O*2+1],_=c[(O+1)*2],x=c[(O+1)*2+1],A=c[(O+2)*2],T=c[(O+2)*2+1],!(Math.abs(y*(x-T)+_*(T-v)+A*(v-x))<it)&&ht.push(O,O+1,O+2)}function T1(e,t){let i=0;const s=e.shape,n=e.points||s.points,r=s.type!==$t.POLY||s.closeStroke;if(n.length===0)return;const o=t.points,a=t.indices,h=n.length/2,l=o.length/2;let c=l;for(o.push(n[0],n[1]),i=1;i<h;i++)o.push(n[i*2],n[i*2+1]),a.push(c,c+1),c++;r&&a.push(c,l)}function Xc(e,t){e.lineStyle.native?T1(e,t):b1(e,t)}class Wh{static curveLength(t,i,s,n,r,o){const a=t-2*s+r,h=i-2*n+o,l=2*s-2*t,c=2*n-2*i,u=4*(a*a+h*h),d=4*(a*l+h*c),f=l*l+c*c,p=2*Math.sqrt(u+d+f),m=Math.sqrt(u),g=2*u*m,y=2*Math.sqrt(f),v=d/m;return(g*p+m*d*(p-y)+(4*f*u-d*d)*Math.log((2*m+v+p)/(v+y)))/(4*g)}static curveTo(t,i,s,n,r){const o=r[r.length-2],a=r[r.length-1],h=As._segmentsCount(Wh.curveLength(o,a,t,i,s,n));let l=0,c=0;for(let u=1;u<=h;++u){const d=u/h;l=o+(t-o)*d,c=a+(i-a)*d,r.push(l+(t+(s-t)*d-l)*d,c+(i+(n-i)*d-c)*d)}}}const Yo={[$t.POLY]:yf,[$t.CIRC]:Lr,[$t.ELIP]:Lr,[$t.RECT]:y1,[$t.RREC]:v1},$c=[],er=[];class kr{constructor(t,i=null,s=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=i,this.matrix=n,this.type=t.type}clone(){return new kr(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Qi=new st,vf=class extends Pd{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Br,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),er.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),$c.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,i=null,s=null){const n=new kr(e,t,i,s);return this.graphicsData.push(n),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const i=new kr(e,null,null,t),s=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=s.lineStyle,s.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let i=0;i<t.length;++i){const s=t[i];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(e,Qi):Qi.copyFrom(e),s.shape.contains(Qi.x,Qi.y))){let n=!1;if(s.holes){for(let r=0;r<s.holes.length;r++)if(s.holes[r].shape.contains(Qi.x,Qi.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;const h=t[a],l=h.fillStyle,c=h.lineStyle;Yo[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(l.visible||c.visible)&&this.processHoles(h.holes);for(let d=0;d<2;d++){const f=d===0?l:c;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,g=this.points.length/2;p.wrapMode=vi.REPEAT,d===0?this.processFill(h):this.processLine(h);const y=this.points.length/2-g;y!==0&&(i&&!this._compareStyles(s,f)&&(i.end(m,g),i=null),i||(i=$c.pop()||new w1,i.begin(f,m,g),this.batches.push(i),s=f),this.addUvs(this.points,e,f.texture,g,y,f.matrix))}}const n=this.indices.length,r=this.points.length/2;if(i&&i.end(n,r),this.batches.length===0){this.batchable=!0;return}const o=r>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const i=this.graphicsData[e],s=i.fillStyle,n=i.lineStyle;if(s&&!s.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,i=e.length;t<i;t++){const s=e[t];for(let n=0;n<s.size;n++){const r=s.start+n;this.indicesUint16[r]=this.indicesUint16[r]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<vf.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++at._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),er.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,i=this.textureIds;let s=er.pop();s||(s=new Fa,s.texArray=new Oa),s.texArray.count=0,s.start=0,s.size=0,s.type=Ge.TRIANGLES;let n=0,r=null,o=0,a=!1,h=Ge.TRIANGLES,l=0;this.drawCalls.push(s);for(let c=0;c<this.batches.length;c++){const u=this.batches[c],d=8,f=u.style,p=f.texture.baseTexture;a!==!!f.native&&(a=!!f.native,h=a?Ge.LINES:Ge.TRIANGLES,r=null,n=d,e++),r!==p&&(r=p,p._batchEnabled!==e&&(n===d&&(e++,n=0,s.size>0&&(s=er.pop(),s||(s=new Fa,s.texArray=new Oa),this.drawCalls.push(s)),s.start=l,s.size=0,s.texArray.count=0,s.type=h),p.touched=1,p._batchEnabled=e,p._batchLocation=n,p.wrapMode=vi.REPEAT,s.texArray.elements[s.texArray.count++]=p,n++)),s.size+=u.size,l+=u.size,o=p._batchLocation,this.addColors(t,f.color,f.alpha,u.attribSize,u.attribStart),this.addTextureIds(i,o,u.attribSize,u.attribStart)}at._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,i=this.colors,s=this.textureIds,n=new ArrayBuffer(e.length*3*4),r=new Float32Array(n),o=new Uint32Array(n);let a=0;for(let h=0;h<e.length/2;h++)r[a++]=e[h*2],r[a++]=e[h*2+1],r[a++]=t[h*2],r[a++]=t[h*2+1],o[a++]=i[h],r[a++]=s[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?yf.triangulate(e,this):Yo[e.type].triangulate(e,this)}processLine(e){Xc(e,this);for(let t=0;t<e.holes.length;t++)Xc(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const i=e[t];Yo[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let i=0;i<e.length/2;i++){const s=e[i*2],n=e[i*2+1];e[i*2]=t.a*s+t.c*n+t.tx,e[i*2+1]=t.b*s+t.d*n+t.ty}}addColors(e,t,i,s,n=0){const r=bt.shared.setValue(t).toLittleEndianNumber(),o=bt.shared.setValue(r).toPremultiplied(i);e.length=Math.max(e.length,n+s);for(let a=0;a<s;a++)e[n+a]=o}addTextureIds(e,t,i,s=0){e.length=Math.max(e.length,s+i);for(let n=0;n<i;n++)e[s+n]=t}addUvs(e,t,i,s,n,r=null){let o=0;const a=t.length,h=i.frame;for(;o<n;){let c=e[(s+o)*2],u=e[(s+o)*2+1];if(r){const d=r.a*c+r.c*u+r.tx;u=r.b*c+r.d*u+r.ty,c=d}o++,t.push(c/h.width,u/h.height)}const l=i.baseTexture;(h.width<l.width||h.height<l.height)&&this.adjustUvs(t,i,a,n)}adjustUvs(e,t,i,s){const n=t.baseTexture,r=1e-6,o=i+s*2,a=t.frame,h=a.width/n.width,l=a.height/n.height;let c=a.x/a.width,u=a.y/a.height,d=Math.floor(e[i]+r),f=Math.floor(e[i+1]+r);for(let p=i+2;p<o;p+=2)d=Math.min(d,Math.floor(e[p]+r)),f=Math.min(f,Math.floor(e[p+1]+r));c-=d,u-=f;for(let p=i;p<o;p+=2)e[p]=(e[p]+c)*h,e[p+1]=(e[p+1]+u)*l}};let wf=vf;wf.BATCHABLE_SIZE=100;class co{constructor(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new co;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Xh extends co{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Oi.BUTT,this.join=xe.MITER,this.miterLimit=10}clone(){const t=new Xh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const Ko={},pr=class extends ae{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new co,this._lineStyle=new Xh,this._matrix=null,this._holeMode=!1,this.state=ai.for2d(),this._geometry=e||new wf,this._geometry.refCount++,this._transformID=-1,this._tintColor=new bt(16777215),this.blendMode=nt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new pr(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,i,s=.5,n=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:i,alignment:s,native:n}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:K.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Oi.BUTT,join:xe.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new gs,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new gs,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,s=i[i.length-2],n=i[i.length-1];return(s!==e||n!==t)&&i.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,i,s){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),Wh.curveTo(e,t,i,s,n),this}bezierCurveTo(e,t,i,s,n,r){return this._initCurve(),Gh.curveTo(e,t,i,s,n,r,this.currentPath.points),this}arcTo(e,t,i,s,n){this._initCurve(e,t);const r=this.currentPath.points,o=Gc.curveTo(e,t,i,s,n,r);if(o){const{cx:a,cy:h,radius:l,startAngle:c,endAngle:u,anticlockwise:d}=o;this.arc(a,h,l,c,u,d)}return this}arc(e,t,i,s,n,r=!1){if(s===n)return this;if(!r&&n<=s?n+=Dr:r&&s<=n&&(s+=Dr),n-s===0)return this;const a=e+Math.cos(s)*i,h=t+Math.sin(s)*i,l=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const u=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-h);u<l&&d<l||c.push(a,h)}else this.moveTo(a,h),c=this.currentPath.points;return Gc.arc(a,h,e,t,i,s,n,r,c),this}beginFill(e=0,t){return this.beginTextureFill({texture:K.WHITE,color:e,alpha:t})}normalizeColor(e){const t=bt.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:K.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,i,s){return this.drawShape(new lt(e,t,i,s))}drawRoundedRect(e,t,i,s,n){return this.drawShape(new Lh(e,t,i,s,n))}drawCircle(e,t,i){return this.drawShape(new io(e,t,i))}drawEllipse(e,t,i,s){return this.drawShape(new Oh(e,t,i,s))}drawPolygon(...e){let t,i=!0;const s=e[0];s.points?(i=s.closeStroke,t=s.points):Array.isArray(e[0])?t=e[0]:t=e;const n=new gs(t);return n.closeStroke=i,this.drawShape(n),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===$t.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let s=0;s<i;s++){const n=e.batches[s],r=n.style.color,o=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),a=new Float32Array(e.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),h=new Uint16Array(e.indicesUint16.buffer,n.start*2,n.size),l={vertexData:o,blendMode:t,indices:h,uvs:a,_batchRGB:bt.shared.setValue(r).toRgbArray(),_tintRGB:r,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[s]=l}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,i=this.batches.length;t<i;t++){const s=this.batches[t];s.worldAlpha=this.worldAlpha*s.alpha,e.plugins[this.pluginName].render(s)}}}_renderDirect(e){const t=this._resolveDirectShader(e),i=this._geometry,s=this.worldAlpha,n=t.uniforms,r=i.drawCalls;n.translationMatrix=this.transform.worldTransform,bt.shared.setValue(this._tintColor).premultiply(s).toArray(n.tint),e.shader.bind(t),e.geometry.bind(i,t),e.state.set(this.state);for(let o=0,a=r.length;o<a;o++)this._renderDrawCallDirect(e,i.drawCalls[o])}_renderDrawCallDirect(e,t){const{texArray:i,type:s,size:n,start:r}=t,o=i.count;for(let a=0;a<o;a++)e.texture.bind(i.elements[a],a);e.geometry.draw(s,n,r)}_resolveDirectShader(e){let t=this.shader;const i=this.pluginName;if(!t){if(!Ko[i]){const{maxTextures:s}=e.plugins[i],n=new Int32Array(s);for(let a=0;a<s;a++)n[a]=a;const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new At,default:Me.from({uSamplers:n},!0)},o=e.plugins[i]._shader.program;Ko[i]=new $e(o,r)}t=Ko[i]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:i,maxX:s,maxY:n}=e.bounds;this._bounds.addFrame(this.transform,t,i,s,n)}containsPoint(e){return this.worldTransform.applyInverse(e,pr._TEMP_POINT),this._geometry.containsPoint(pr._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=bt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,i=t.a,s=t.b,n=t.c,r=t.d,o=t.tx,a=t.ty,h=this._geometry.points,l=this.vertexData;let c=0;for(let u=0;u<h.length;u+=2){const d=h[u],f=h[u+1];l[c++]=i*d+n*f+o,l[c++]=r*f+s*d+a}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};let Ss=pr;Ss.curves=As;Ss._TEMP_POINT=new st;class E1{constructor(t,i){this.uvBuffer=t,this.uvMatrix=i,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const i=this.uvBuffer.data;(!this.data||this.data.length!==i.length)&&(this.data=new Float32Array(i.length)),this.uvMatrix.multiplyUvs(i,this.data),this._updateID++}}const qo=new st,zc=new gs,bf=class extends ae{constructor(e,t,i,s=Ge.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=i||ai.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=z.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ge.TRIANGLES&&t.length<bf.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const s=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[s]),e.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],i=t.data,s=t._updateID;if(s===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==i.length&&(this.vertexData=new Float32Array(i.length));const n=this.transform.worldTransform,r=n.a,o=n.b,a=n.c,h=n.d,l=n.tx,c=n.ty,u=this.vertexData;for(let d=0;d<u.length/2;d++){const f=i[d*2],p=i[d*2+1];u[d*2]=r*f+a*p+l,u[d*2+1]=o*f+h*p+c}if(this._roundPixels){const d=z.RESOLUTION;for(let f=0;f<u.length;++f)u[f]=Math.round(u[f]*d)/d}this.vertexDirty=s}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new E1(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,qo);const t=this.geometry.getBuffer("aVertexPosition").data,i=zc.points,s=this.geometry.getIndex().data,n=s.length,r=this.drawMode===4?3:1;for(let o=0;o+2<n;o+=r){const a=s[o]*2,h=s[o+1]*2,l=s[o+2]*2;if(i[0]=t[a],i[1]=t[a+1],i[2]=t[h],i[3]=t[h+1],i[4]=t[l],i[5]=t[l+1],zc.contains(qo.x,qo.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Ya=bf;Ya.BATCHABLE_SIZE=100;class A1 extends Ti{constructor(t,i,s){super();const n=new Rt(t),r=new Rt(i,!0),o=new Rt(s,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,et.FLOAT).addAttribute("aTextureCoord",r,2,!1,et.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var S1=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,C1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Vc extends $e{constructor(t,i){const s={uSampler:t,alpha:1,uTextureMatrix:At.IDENTITY,uColor:new Float32Array([1,1,1,1])};i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i),i.uniforms&&Object.assign(s,i.uniforms),super(i.program||Ae.from(C1,S1),s),this._colorDirty=!1,this.uvMatrix=new zd(t),this.batchable=i.program===void 0,this.pluginName=i.pluginName,this._tintColor=new bt(i.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=i.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const i=this.texture.baseTexture.alphaMode;bt.shared.setValue(this._tintColor).premultiply(this._alpha,i).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class jc{constructor(t,i,s){this.geometry=new Ti,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let r=t[n];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||et.FLOAT,offset:r.offset},i[n]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let i=0;this.indexBuffer=new Rt(hv(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=i,i+=a.size,this.dynamicStride+=a.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Rt(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=n,n+=a.size,this.staticStride+=a.size}const r=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(r),this.staticDataUint32=new Uint32Array(r),this.staticBuffer=new Rt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===et.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===et.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,i,s){for(let n=0;n<this.dynamicProperties.length;n++){const r=this.dynamicProperties[n];r.uploadFunction(t,i,s,r.type===et.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,i,s){for(let n=0;n<this.staticProperties.length;n++){const r=this.staticProperties[n];r.uploadFunction(t,i,s,r.type===et.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var I1=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,P1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Tf extends so{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new At,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:et.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=$e.from(P1,I1,{}),this.state=ai.for2d()}render(t){const i=t.children,s=t._maxSize,n=t._batchSize,r=this.renderer;let o=i.length;if(o===0)return;o>s&&!t.autoResize&&(o=s);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const h=i[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=Ad(t.blendMode,l),r.state.set(this.state);const c=r.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(r.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=bt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=n,p+=1){let m=o-f;m>n&&(m=n),p>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[p];g.uploadDynamic(i,f,m);const y=t._bufferUpdateIDs[p]||0;d=d||g._updateID<y,d&&(g._updateID=t._updateID,g.uploadStatic(i,f,m)),r.geometry.bind(g.geometry),c.drawElements(c.TRIANGLES,m*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const i=[],s=t._maxSize,n=t._batchSize,r=t._properties;for(let o=0;o<s;o+=n)i.push(new jc(this.properties,r,n));return i}_generateOneMoreBuffer(t){const i=t._batchSize,s=t._properties;return new jc(this.properties,s,i)}uploadVertices(t,i,s,n,r,o){let a=0,h=0,l=0,c=0;for(let u=0;u<s;++u){const d=t[i+u],f=d._texture,p=d.scale.x,m=d.scale.y,g=f.trim,y=f.orig;g?(h=g.x-d.anchor.x*y.width,a=h+g.width,c=g.y-d.anchor.y*y.height,l=c+g.height):(a=y.width*(1-d.anchor.x),h=y.width*-d.anchor.x,l=y.height*(1-d.anchor.y),c=y.height*-d.anchor.y),n[o]=h*p,n[o+1]=c*m,n[o+r]=a*p,n[o+r+1]=c*m,n[o+r*2]=a*p,n[o+r*2+1]=l*m,n[o+r*3]=h*p,n[o+r*3+1]=l*m,o+=r*4}}uploadPosition(t,i,s,n,r,o){for(let a=0;a<s;a++){const h=t[i+a].position;n[o]=h.x,n[o+1]=h.y,n[o+r]=h.x,n[o+r+1]=h.y,n[o+r*2]=h.x,n[o+r*2+1]=h.y,n[o+r*3]=h.x,n[o+r*3+1]=h.y,o+=r*4}}uploadRotation(t,i,s,n,r,o){for(let a=0;a<s;a++){const h=t[i+a].rotation;n[o]=h,n[o+r]=h,n[o+r*2]=h,n[o+r*3]=h,o+=r*4}}uploadUvs(t,i,s,n,r,o){for(let a=0;a<s;++a){const h=t[i+a]._texture._uvs;h?(n[o]=h.x0,n[o+1]=h.y0,n[o+r]=h.x1,n[o+r+1]=h.y1,n[o+r*2]=h.x2,n[o+r*2+1]=h.y2,n[o+r*3]=h.x3,n[o+r*3+1]=h.y3,o+=r*4):(n[o]=0,n[o+1]=0,n[o+r]=0,n[o+r+1]=0,n[o+r*2]=0,n[o+r*2+1]=0,n[o+r*3]=0,n[o+r*3+1]=0,o+=r*4)}}uploadTint(t,i,s,n,r,o){for(let a=0;a<s;++a){const h=t[i+a],l=bt.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);n[o]=l,n[o+r]=l,n[o+r*2]=l,n[o+r*3]=l,o+=r*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Tf.extension={name:"particle",type:V.RendererPlugin};q.add(Tf);var uo=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(uo||{});const ir={willReadFrequently:!0},Y=class{static get experimentalLetterSpacingSupported(){let e=Y._experimentalLetterSpacingSupported;if(e!==void 0){const t=z.ADAPTER.getCanvasRenderingContext2D().prototype;e=Y._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,s,n,r,o,a,h){this.text=e,this.style=t,this.width=i,this.height=s,this.lines=n,this.lineWidths=r,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(e,t,i,s=Y._canvas){i=i??t.wordWrap;const n=t.toFontString(),r=Y.measureFont(n);r.fontSize===0&&(r.fontSize=t.fontSize,r.ascent=t.fontSize);const o=s.getContext("2d",ir);o.font=n;const h=(i?Y.wordWrap(e,t,s):e).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let c=0;for(let p=0;p<h.length;p++){const m=Y._measureText(h[p],t.letterSpacing,o);l[p]=m,c=Math.max(c,m)}let u=c+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance);const d=t.lineHeight||r.fontSize+t.strokeThickness;let f=Math.max(d,r.fontSize+t.strokeThickness*2)+(h.length-1)*(d+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new Y(e,t,u,f,h,l,d+t.leading,c,r)}static _measureText(e,t,i){let s=!1;Y.experimentalLetterSpacingSupported&&(Y.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(e).width;return n>0&&(s?n-=t:n+=(Y.graphemeSegmenter(e).length-1)*t),n}static wordWrap(e,t,i=Y._canvas){const s=i.getContext("2d",ir);let n=0,r="",o="";const a=Object.create(null),{letterSpacing:h,whiteSpace:l}=t,c=Y.collapseSpaces(l),u=Y.collapseNewlines(l);let d=!c;const f=t.wordWrapWidth+h,p=Y.tokenize(e);for(let m=0;m<p.length;m++){let g=p[m];if(Y.isNewline(g)){if(!u){o+=Y.addLine(r),d=!c,r="",n=0;continue}g=" "}if(c){const v=Y.isBreakingSpace(g),_=Y.isBreakingSpace(r[r.length-1]);if(v&&_)continue}const y=Y.getFromCache(g,h,a,s);if(y>f)if(r!==""&&(o+=Y.addLine(r),r="",n=0),Y.canBreakWords(g,t.breakWords)){const v=Y.wordWrapSplit(g);for(let _=0;_<v.length;_++){let x=v[_],A=x,T=1;for(;v[_+T];){const S=v[_+T];if(!Y.canBreakChars(A,S,g,_,t.breakWords))x+=S;else break;A=S,T++}_+=T-1;const I=Y.getFromCache(x,h,a,s);I+n>f&&(o+=Y.addLine(r),d=!1,r="",n=0),r+=x,n+=I}}else{r.length>0&&(o+=Y.addLine(r),r="",n=0);const v=m===p.length-1;o+=Y.addLine(g,!v),d=!1,r="",n=0}else y+n>f&&(d=!1,o+=Y.addLine(r),r="",n=0),(r.length>0||!Y.isBreakingSpace(g)||d)&&(r+=g,n+=y)}return o+=Y.addLine(r,!1),o}static addLine(e,t=!0){return e=Y.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,i,s){let n=i[e];return typeof n!="number"&&(n=Y._measureText(e,t,s)+t,i[e]=n),n}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!Y.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Y._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:Y._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let s=0;s<e.length;s++){const n=e[s],r=e[s+1];if(Y.isBreakingSpace(n,r)||Y.isNewline(n)){i!==""&&(t.push(i),i=""),t.push(n);continue}i+=n}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,s,n){return!0}static wordWrapSplit(e){return Y.graphemeSegmenter(e)}static measureFont(e){if(Y._fonts[e])return Y._fonts[e];const t={ascent:0,descent:0,fontSize:0},i=Y._canvas,s=Y._context;s.font=e;const n=Y.METRICS_STRING+Y.BASELINE_SYMBOL,r=Math.ceil(s.measureText(n).width);let o=Math.ceil(s.measureText(Y.BASELINE_SYMBOL).width);const a=Math.ceil(Y.HEIGHT_MULTIPLIER*o);if(o=o*Y.BASELINE_MULTIPLIER|0,r===0||a===0)return Y._fonts[e]=t,t;i.width=r,i.height=a,s.fillStyle="#f00",s.fillRect(0,0,r,a),s.font=e,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(n,0,o);const h=s.getImageData(0,0,r,a).data,l=h.length,c=r*4;let u=0,d=0,f=!1;for(u=0;u<o;++u){for(let p=0;p<c;p+=4)if(h[d+p]!==255){f=!0;break}if(!f)d+=c;else break}for(t.ascent=o-u,d=l-c,f=!1,u=a;u>o;--u){for(let p=0;p<c;p+=4)if(h[d+p]!==255){f=!0;break}if(!f)d-=c;else break}return t.descent=u-o,t.fontSize=t.ascent+t.descent,Y._fonts[e]=t,t}static clearMetrics(e=""){e?delete Y._fonts[e]:Y._fonts={}}static get _canvas(){if(!Y.__canvas){let e;try{const t=new OffscreenCanvas(0,0),i=t.getContext("2d",ir);if(i!=null&&i.measureText)return Y.__canvas=t,t;e=z.ADAPTER.createCanvas()}catch{e=z.ADAPTER.createCanvas()}e.width=e.height=10,Y.__canvas=e}return Y.__canvas}static get _context(){return Y.__context||(Y.__context=Y._canvas.getContext("2d",ir)),Y.__context}};let Wt=Y;Wt.METRICS_STRING="|ÉqÅ";Wt.BASELINE_SYMBOL="M";Wt.BASELINE_MULTIPLIER=1.4;Wt.HEIGHT_MULTIPLIER=2;Wt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map(i=>i.segment)}return e=>[...e]})();Wt.experimentalLetterSpacing=!1;Wt._fonts={};Wt._newlines=[10,13];Wt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const M1=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],qs=class{constructor(e){this.styleID=0,this.reset(),Jo(this,e,e)}clone(){const e={};return Jo(e,this,qs.defaultStyle),new qs(e)}reset(){Jo(this,qs.defaultStyle,qs.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Zo(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Zo(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){R1(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Zo(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let s=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!M1.includes(s)&&(s=`"${s}"`),t[i]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};let ri=qs;ri.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:uo.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Zo(e){const t=bt.shared;return Array.isArray(e)?e.map(i=>t.setValue(i).toHex()):t.setValue(e).toHex()}function R1(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}function Jo(e,t,i){for(const s in i)Array.isArray(t[s])?e[s]=t[s].slice():e[s]=t[s]}const D1={texture:!0,children:!1,baseTexture:!0},Ka=class extends Rs{constructor(e,t,i){let s=!1;i||(i=z.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;const n=K.from(i);n.orig=new lt,n.trim=new lt,super(n),this._ownCanvas=s,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=Ka.defaultResolution??z.RESOLUTION,this._autoResolution=Ka.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return Wt.experimentalLetterSpacing}static set experimentalLetterSpacing(e){ft("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Wt.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,s=Wt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=s.width,r=s.height,o=s.lines,a=s.lineHeight,h=s.lineWidths,l=s.maxLineWidth,c=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;let u,d;const f=t.dropShadow?2:1;for(let p=0;p<f;++p){const m=t.dropShadow&&p===0,g=m?Math.ceil(Math.max(1,r)+t.padding*2):0,y=g*this._resolution;if(m){i.fillStyle="black",i.strokeStyle="black";const _=t.dropShadowColor,x=t.dropShadowBlur*this._resolution,A=t.dropShadowDistance*this._resolution;i.shadowColor=bt.shared.setValue(_).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=x,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*A,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*A+y}else i.fillStyle=this._generateFillStyle(t,o,s),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let v=(a-c.fontSize)/2;a-c.fontSize<0&&(v=0);for(let _=0;_<o.length;_++)u=t.strokeThickness/2,d=t.strokeThickness/2+_*a+c.ascent+v,t.align==="right"?u+=l-h[_]:t.align==="center"&&(u+=(l-h[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[_],u+t.padding,d+t.padding-g,!0),t.fill&&this.drawLetterSpacing(o[_],u+t.padding,d+t.padding-g)}this.updateTexture()}drawLetterSpacing(e,t,i,s=!1){const r=this._style.letterSpacing;let o=!1;if(Wt.experimentalLetterSpacingSupported&&(Wt.experimentalLetterSpacing?(this.context.letterSpacing=`${r}px`,this.context.textLetterSpacing=`${r}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),r===0||o){s?this.context.strokeText(e,t,i):this.context.fillText(e,t,i);return}let a=t;const h=Wt.graphemeSegmenter(e);let l=this.context.measureText(e).width,c=0;for(let u=0;u<h.length;++u){const d=h[u];s?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let f="";for(let p=u+1;p<h.length;++p)f+=h[p];c=this.context.measureText(f).width,a+=l-c+r,l=c}}updateTexture(){const e=this.canvas;if(this._style.trim){const r=dv(e);r.data&&(e.width=r.width,e.height=r.height,this.context.putImageData(r.data,0,0))}const t=this._texture,i=this._style,s=i.trim?0:i.padding,n=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),n.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,i){const s=e.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let n;const r=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=this.canvas.width/this._resolution-r-o*2,h=this.canvas.height/this._resolution-r-o*2,l=s.slice(),c=e.fillGradientStops.slice();if(!c.length){const u=l.length+1;for(let d=1;d<u;++d)c.push(d/u)}if(l.unshift(s[0]),c.unshift(0),l.push(s[s.length-1]),c.push(1),e.fillGradientType===uo.LINEAR_VERTICAL){n=this.context.createLinearGradient(a/2,o,a/2,h+o);const u=i.fontProperties.fontSize+e.strokeThickness;for(let d=0;d<t.length;d++){const f=i.lineHeight*(d-1)+u,p=i.lineHeight*d;let m=p;d>0&&f>p&&(m=(p+f)/2);const g=p+u,y=i.lineHeight*(d+1);let v=g;d+1<t.length&&y<g&&(v=(g+y)/2);const _=(v-m)/h;for(let x=0;x<l.length;x++){let A=0;typeof c[x]=="number"?A=c[x]:A=x/l.length;let T=Math.min(1,Math.max(0,m/h+A*_));T=Number(T.toFixed(5)),n.addColorStop(T,l[x])}}}else{n=this.context.createLinearGradient(o,h/2,a+o,h/2);const u=l.length+1;let d=1;for(let f=0;f<l.length;f++){let p;typeof c[f]=="number"?p=c[f]:p=d/u,n.addColorStop(p,l[f]),d++}}return n}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},D1,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=mi(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=mi(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof ri?this._style=e:this._style=new ri(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};let fo=Ka;fo.defaultAutoResolution=!0;class B1{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function F1(e,t){var s;let i=!1;if((s=e==null?void 0:e._textures)!=null&&s.length){for(let n=0;n<e._textures.length;n++)if(e._textures[n]instanceof K){const r=e._textures[n].baseTexture;t.includes(r)||(t.push(r),i=!0)}}return i}function N1(e,t){if(e.baseTexture instanceof at){const i=e.baseTexture;return t.includes(i)||t.push(i),!0}return!1}function O1(e,t){if(e._texture&&e._texture instanceof K){const i=e._texture.baseTexture;return t.includes(i)||t.push(i),!0}return!1}function L1(e,t){return t instanceof fo?(t.updateText(!0),!0):!1}function k1(e,t){if(t instanceof ri){const i=t.toFontString();return Wt.measureFont(i),!0}return!1}function U1(e,t){if(e instanceof fo){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const i=e._texture.baseTexture;return t.includes(i)||t.push(i),!0}return!1}function H1(e,t){return e instanceof ri?(t.includes(e)||t.push(e),!0):!1}const Ef=class{constructor(e){this.limiter=new B1(Ef.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(U1),this.registerFindHook(H1),this.registerFindHook(F1),this.registerFindHook(N1),this.registerFindHook(O1),this.registerUploadHook(L1),this.registerUploadHook(k1)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Gt.system.addOnce(this.tick,this,zi.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let i=0,s=this.uploadHooks.length;i<s;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Gt.system.addOnce(this.tick,this,zi.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,i=e.length;t<i;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof ae)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&Gt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Ur=Ef;Ur.uploadsPerFrame=4;Object.defineProperties(z,{UPLOADS_PER_FRAME:{get(){return Ur.uploadsPerFrame},set(e){ft("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Ur.uploadsPerFrame=e}}});function Af(e,t){return t instanceof at?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function G1(e,t){if(!(t instanceof Ss))return!1;const{geometry:i}=t;t.finishPoly(),i.updateBatches();const{batches:s}=i;for(let n=0;n<s.length;n++){const{texture:r}=s[n].style;r&&Af(e,r.baseTexture)}return i.batchable||e.geometry.bind(i,t._resolveDirectShader(e)),!0}function W1(e,t){return e instanceof Ss?(t.push(e),!0):!1}class Sf extends Ur{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(W1),this.registerUploadHook(Af),this.registerUploadHook(G1)}}Sf.extension={name:"prepare",type:V.RendererSystem};q.add(Sf);var X1=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,$1=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,z1=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Yc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,V1=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const sr=new At;class Cf extends so{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Gd,this.state=ai.for2d()}contextChange(){const t=this.renderer,i={globals:t.globalUniforms};this.simpleShader=$e.from(Yc,V1,i),this.shader=t.context.webGLVersion>1?$e.from($1,X1,i):$e.from(Yc,z1,i)}render(t){const i=this.renderer,s=this.quad;let n=s.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);const r=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;n=s.uvs,n[0]=n[6]=-r,n[1]=n[3]=-o,n[2]=n[4]=1-r,n[5]=n[7]=1-o,s.invalidate();const a=t._texture,h=a.baseTexture,l=h.alphaMode>0,c=t.tileTransform.localTransform,u=t.uvMatrix;let d=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;d&&(h._glTextures[i.CONTEXT_UID]?d=h.wrapMode!==vi.CLAMP:h.wrapMode===vi.CLAMP&&(h.wrapMode=vi.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,m=a.height,g=t._width,y=t._height;sr.set(c.a*p/g,c.b*p/y,c.c*m/g,c.d*m/y,c.tx/g,c.ty/y),sr.invert(),d?sr.prepend(u.mapCoord):(f.uniforms.uMapCoord=u.mapCoord.toArray(!0),f.uniforms.uClampFrame=u.uClampFrame,f.uniforms.uClampOffset=u.uClampOffset),f.uniforms.uTransform=sr.toArray(!0),f.uniforms.uColor=bt.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,i.shader.bind(f),i.geometry.bind(s),this.state.blendMode=Ad(t.blendMode,l),i.state.set(this.state),i.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Cf.extension={name:"tilingSprite",type:V.RendererPlugin};q.add(Cf);const Zs=class{constructor(e,t,i=null){this.linkedSheets=[],this._texture=e instanceof K?e:null,this.baseTexture=e instanceof at?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const s=this.baseTexture.resource;this.resolution=this._updateResolution(i||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let i=bi(e,null);return i===null&&(i=parseFloat(t??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Zs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=Zs.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const s=this._frameKeys[t],n=this._frames[s],r=n.frame;if(r){let o=null,a=null;const h=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,l=new lt(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);n.rotated?o=new lt(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):o=new lt(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(a=new lt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[s]=new K(this.baseTexture,o,l,a,n.rotated?2:0,n.anchor,n.borders),K.addToCache(this.textures[s],s)}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const s=e[t][i];this.animations[t].push(this.textures[s])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Zs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Zs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let qa=Zs;qa.BATCH_SIZE=1e3;const j1=["jpg","png","jpeg","avif","webp"];function If(e,t,i){const s={};if(e.forEach(n=>{s[n]=t}),Object.keys(t.textures).forEach(n=>{s[n]=t.textures[n]}),!i){const n=Kt.dirname(e[0]);t.linkedSheets.forEach((r,o)=>{const a=If([`${n}/${t.data.meta.related_multi_packs[o]}`],r,!0);Object.assign(s,a)})}return s}const Y1={extension:V.Asset,cache:{test:e=>e instanceof qa,getCacheableAssets:(e,t)=>If(e,t,!1)},resolver:{test:e=>{const i=e.split("?")[0].split("."),s=i.pop(),n=i.pop();return s==="json"&&j1.includes(n)},parse:e=>{var i;const t=e.split(".");return{resolution:parseFloat(((i=z.RETINA_PREFIX.exec(e))==null?void 0:i[1])??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:V.LoadParser,priority:je.Normal},async testParse(e,t){return Kt.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,i){var l,c;let s=Kt.dirname(t.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let n=s+e.meta.image;n=Va(n,t.src);const o=(await i.load([n]))[n],a=new qa(o.baseTexture,e,t.src);await a.parse();const h=(l=e==null?void 0:e.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(h)){const u=[];for(const f of h){if(typeof f!="string")continue;let p=s+f;(c=t.data)!=null&&c.ignoreMultiPack||(p=Va(p,t.src),u.push(i.load({src:p,data:{ignoreMultiPack:!0}})))}const d=await Promise.all(u);a.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[a].concat(a.linkedSheets.filter(p=>p!==f))})}return a},unload(e){e.destroy(!0)}}};q.add(Y1);class Hr{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class mr{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const i=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const r in i){const o=i[r].match(/^[a-z]+/gm)[0],a=i[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const l in a){const c=a[l].split("="),u=c[0],d=c[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;h[u]=p}s[o].push(h)}const n=new Hr;return s.info.forEach(r=>n.info.push({face:r.face,size:parseInt(r.size,10)})),s.common.forEach(r=>n.common.push({lineHeight:parseInt(r.lineHeight,10)})),s.page.forEach(r=>n.page.push({id:parseInt(r.id,10),file:r.file})),s.char.forEach(r=>n.char.push({id:parseInt(r.id,10),page:parseInt(r.page,10),x:parseInt(r.x,10),y:parseInt(r.y,10),width:parseInt(r.width,10),height:parseInt(r.height,10),xoffset:parseInt(r.xoffset,10),yoffset:parseInt(r.yoffset,10),xadvance:parseInt(r.xadvance,10)})),s.kerning.forEach(r=>n.kerning.push({first:parseInt(r.first,10),second:parseInt(r.second,10),amount:parseInt(r.amount,10)})),s.distanceField.forEach(r=>n.distanceField.push({distanceRange:parseInt(r.distanceRange,10),fieldType:r.fieldType})),n}}class Za{static test(t){const i=t;return"getElementsByTagName"in i&&i.getElementsByTagName("page").length&&i.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const i=new Hr,s=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let l=0;l<s.length;l++)i.info.push({face:s[l].getAttribute("face"),size:parseInt(s[l].getAttribute("size"),10)});for(let l=0;l<n.length;l++)i.common.push({lineHeight:parseInt(n[l].getAttribute("lineHeight"),10)});for(let l=0;l<r.length;l++)i.page.push({id:parseInt(r[l].getAttribute("id"),10)||0,file:r[l].getAttribute("file")});for(let l=0;l<o.length;l++){const c=o[l];i.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)i.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<h.length;l++)i.distanceField.push({fieldType:h[l].getAttribute("fieldType"),distanceRange:parseInt(h[l].getAttribute("distanceRange"),10)});return i}}class Ja{static test(t){return typeof t=="string"&&t.includes("<font>")?Za.test(z.ADAPTER.parseXML(t)):!1}static parse(t){return Za.parse(z.ADAPTER.parseXML(t))}}const Qo=[mr,Za,Ja];function K1(e){for(let t=0;t<Qo.length;t++)if(Qo[t].test(e))return Qo[t];return null}function q1(e,t,i,s,n,r){const o=i.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const h=i.dropShadow?i.dropShadowDistance:0,l=i.padding||0,c=e.width/s-h-l*2,u=e.height/s-h-l*2,d=o.slice(),f=i.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),i.fillGradientType===uo.LINEAR_VERTICAL){a=t.createLinearGradient(c/2,l,c/2,u+l);let p=0;const g=(r.fontProperties.fontSize+i.strokeThickness)/u;for(let y=0;y<n.length;y++){const v=r.lineHeight*y;for(let _=0;_<d.length;_++){let x=0;typeof f[_]=="number"?x=f[_]:x=_/d.length;const A=v/u+x*g;let T=Math.max(p,A);T=Math.min(T,1),a.addColorStop(T,d[_]),p=T}}}else{a=t.createLinearGradient(l,u/2,c+l,u/2);const p=d.length+1;let m=1;for(let g=0;g<d.length;g++){let y;typeof f[g]=="number"?y=f[g]:y=m/p,a.addColorStop(y,d[g]),m++}}return a}function Z1(e,t,i,s,n,r,o){const a=i.text,h=i.fontProperties;t.translate(s,n),t.scale(r,r);const l=o.strokeThickness/2,c=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=q1(e,t,o,r,[a],i),t.strokeStyle=o.stroke,o.dropShadow){const u=o.dropShadowColor,d=o.dropShadowBlur*r,f=o.dropShadowDistance*r;t.shadowColor=bt.shared.setValue(u).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,l,c+i.lineHeight-h.descent),o.fill&&t.fillText(a,l,c+i.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function gr(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function Pf(e){return Array.from?Array.from(e):e.split("")}function J1(e){typeof e=="string"&&(e=[e]);const t=[];for(let i=0,s=e.length;i<s;i++){const n=e[i];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const r=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<r)throw new Error("[BitmapFont]: Invalid character range.");for(let a=r,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...Pf(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const _e=class{constructor(e,t,i){var l;const[s]=e.info,[n]=e.common,[r]=e.page,[o]=e.distanceField,a=bi(r.file),h={};this._ownsTextures=i,this.font=s.face,this.size=s.size,this.lineHeight=n.lineHeight/a,this.chars={},this.pageTextures=h;for(let c=0;c<e.page.length;c++){const{id:u,file:d}=e.page[c];h[u]=t instanceof Array?t[c]:t[d],o!=null&&o.fieldType&&o.fieldType!=="none"&&(h[u].baseTexture.alphaMode=De.NO_PREMULTIPLIED_ALPHA,h[u].baseTexture.mipmap=ze.OFF)}for(let c=0;c<e.char.length;c++){const{id:u,page:d}=e.char[c];let{x:f,y:p,width:m,height:g,xoffset:y,yoffset:v,xadvance:_}=e.char[c];f/=a,p/=a,m/=a,g/=a,y/=a,v/=a,_/=a;const x=new lt(f+h[d].frame.x/a,p+h[d].frame.y/a,m,g);this.chars[u]={xOffset:y,yOffset:v,xAdvance:_,kerning:{},texture:new K(h[d].baseTexture,x),page:d}}for(let c=0;c<e.kerning.length;c++){let{first:u,second:d,amount:f}=e.kerning[c];u/=a,d/=a,f/=a,this.chars[d]&&(this.chars[d].kerning[u]=f)}this.distanceFieldRange=o==null?void 0:o.distanceRange,this.distanceFieldType=((l=o==null?void 0:o.fieldType)==null?void 0:l.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,i){let s;if(e instanceof Hr)s=e;else{const r=K1(e);if(!r)throw new Error("Unrecognized data format for font.");s=r.parse(e)}t instanceof K&&(t=[t]);const n=new _e(s,t,i);return _e.available[n.font]=n,n}static uninstall(e){const t=_e.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete _e.available[e]}static from(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:n,resolution:r,textureWidth:o,textureHeight:a,...h}=Object.assign({},_e.defaultOptions,i),l=J1(s),c=t instanceof ri?t:new ri(t),u=o,d=new Hr;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};let f=0,p=0,m,g,y,v=0;const _=[];for(let A=0;A<l.length;A++){m||(m=z.ADAPTER.createCanvas(),m.width=o,m.height=a,g=m.getContext("2d"),y=new at(m,{resolution:r,...h}),_.push(new K(y)),d.page.push({id:_.length-1,file:""}));const T=l[A],I=Wt.measureText(T,c,!1,m),S=I.width,G=Math.ceil(I.height),H=Math.ceil((c.fontStyle==="italic"?2:1)*S);if(p>=a-G*r){if(p===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${T}')`);--A,m=null,g=null,y=null,p=0,f=0,v=0;continue}if(v=Math.max(G+I.fontProperties.descent,v),H*r+f>=u){if(f===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${T}')`);--A,p+=v*r,p=Math.ceil(p),f=0,v=0;continue}Z1(m,g,I,f,p,r,c);const N=gr(I.text);d.char.push({id:N,page:_.length-1,x:f/r,y:p/r,width:H,height:G,xoffset:0,yoffset:0,xadvance:S-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),f+=(H+2*n)*r,f=Math.ceil(f)}for(let A=0,T=l.length;A<T;A++){const I=l[A];for(let S=0;S<T;S++){const G=l[S],H=g.measureText(I).width,N=g.measureText(G).width,D=g.measureText(I+G).width-(H+N);D&&d.kerning.push({first:gr(I),second:gr(G),amount:D})}}const x=new _e(d,_,!0);return _e.available[e]!==void 0&&_e.uninstall(e),_e.available[e]=x,x}};let te=_e;te.ALPHA=[["a","z"],["A","Z"]," "];te.NUMERIC=[["0","9"]];te.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];te.ASCII=[[" ","~"]];te.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_e.ALPHANUMERIC};te.available={};var Q1=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,tT=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Kc=[],qc=[],Zc=[],Mf=class extends ae{constructor(e,t={}){super();const{align:i,tint:s,maxWidth:n,letterSpacing:r,fontName:o,fontSize:a}=Object.assign({},Mf.styleDefaults,t);if(!te.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new bt(s),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=e,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=r,this._anchor=new gi(()=>{this.dirty=!0},this,0,0),this._roundPixels=z.ROUND_PIXELS,this.dirty=!0,this._resolution=z.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var H;const e=te.available[this._fontName],t=this.fontSize,i=t/e.size,s=new st,n=[],r=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=Pf(a),l=this._maxWidth*e.size/t,c=e.distanceFieldType==="none"?Kc:qc;let u=null,d=0,f=0,p=0,m=-1,g=0,y=0,v=0,_=0;for(let N=0;N<h.length;N++){const $=h[N],D=gr($);if(/(?:\s)/.test($)&&(m=N,g=d,_++),$==="\r"||$===`
`){r.push(d),o.push(-1),f=Math.max(f,d),++p,++y,s.x=0,s.y+=e.lineHeight,u=null,_=0;continue}const M=e.chars[D];if(!M)continue;u&&M.kerning[u]&&(s.x+=M.kerning[u]);const ht=Zc.pop()||{texture:K.EMPTY,line:0,charCode:0,prevSpaces:0,position:new st};ht.texture=M.texture,ht.line=p,ht.charCode=D,ht.position.x=Math.round(s.x+M.xOffset+this._letterSpacing/2),ht.position.y=Math.round(s.y+M.yOffset),ht.prevSpaces=_,n.push(ht),d=ht.position.x+Math.max(M.xAdvance-M.xOffset,M.texture.orig.width),s.x+=M.xAdvance+this._letterSpacing,v=Math.max(v,M.yOffset+M.texture.height),u=D,m!==-1&&l>0&&s.x>l&&(++y,ms(n,1+m-y,1+N-m),N=m,m=-1,r.push(g),o.push(n.length>0?n[n.length-1].prevSpaces:0),f=Math.max(f,g),p++,s.x=0,s.y+=e.lineHeight,u=null,_=0)}const x=h[h.length-1];x!=="\r"&&x!==`
`&&(/(?:\s)/.test(x)&&(d=g),r.push(d),f=Math.max(f,d),o.push(-1));const A=[];for(let N=0;N<=p;N++){let $=0;this._align==="right"?$=f-r[N]:this._align==="center"?$=(f-r[N])/2:this._align==="justify"&&($=o[N]<0?0:(f-r[N])/o[N]),A.push($)}const T=n.length,I={},S=[],G=this._activePagesMeshData;c.push(...G);for(let N=0;N<T;N++){const $=n[N].texture,D=$.baseTexture.uid;if(!I[D]){let M=c.pop();if(!M){const it=new A1;let O,Z;e.distanceFieldType==="none"?(O=new Vc(K.EMPTY),Z=nt.NORMAL):(O=new Vc(K.EMPTY,{program:Ae.from(tT,Q1),uniforms:{uFWidth:0}}),Z=nt.NORMAL_NPM);const _t=new Ya(it,O);_t.blendMode=Z,M={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:_t,vertices:null,uvs:null,indices:null}}M.index=0,M.indexCount=0,M.vertexCount=0,M.uvsCount=0,M.total=0;const{_textureCache:ht}=this;ht[D]=ht[D]||new K($.baseTexture),M.mesh.texture=ht[D],M.mesh.tint=this._tintColor.value,S.push(M),I[D]=M}I[D].total++}for(let N=0;N<G.length;N++)S.includes(G[N])||this.removeChild(G[N].mesh);for(let N=0;N<S.length;N++)S[N].mesh.parent!==this&&this.addChild(S[N].mesh);this._activePagesMeshData=S;for(const N in I){const $=I[N],D=$.total;if(!(((H=$.indices)==null?void 0:H.length)>6*D)||$.vertices.length<Ya.BATCHABLE_SIZE*2)$.vertices=new Float32Array(4*2*D),$.uvs=new Float32Array(4*2*D),$.indices=new Uint16Array(6*D);else{const M=$.total,ht=$.vertices;for(let it=M*4*2;it<ht.length;it++)ht[it]=0}$.mesh.size=6*D}for(let N=0;N<T;N++){const $=n[N];let D=$.position.x+A[$.line]*(this._align==="justify"?$.prevSpaces:1);this._roundPixels&&(D=Math.round(D));const M=D*i,ht=$.position.y*i,it=$.texture,O=I[it.baseTexture.uid],Z=it.frame,_t=it._uvs,B=O.index++;O.indices[B*6+0]=0+B*4,O.indices[B*6+1]=1+B*4,O.indices[B*6+2]=2+B*4,O.indices[B*6+3]=0+B*4,O.indices[B*6+4]=2+B*4,O.indices[B*6+5]=3+B*4,O.vertices[B*8+0]=M,O.vertices[B*8+1]=ht,O.vertices[B*8+2]=M+Z.width*i,O.vertices[B*8+3]=ht,O.vertices[B*8+4]=M+Z.width*i,O.vertices[B*8+5]=ht+Z.height*i,O.vertices[B*8+6]=M,O.vertices[B*8+7]=ht+Z.height*i,O.uvs[B*8+0]=_t.x0,O.uvs[B*8+1]=_t.y0,O.uvs[B*8+2]=_t.x1,O.uvs[B*8+3]=_t.y1,O.uvs[B*8+4]=_t.x2,O.uvs[B*8+5]=_t.y2,O.uvs[B*8+6]=_t.x3,O.uvs[B*8+7]=_t.y3}this._textWidth=f*i,this._textHeight=(s.y+e.lineHeight)*i;for(const N in I){const $=I[N];if(this.anchor.x!==0||this.anchor.y!==0){let it=0;const O=this._textWidth*this.anchor.x,Z=this._textHeight*this.anchor.y;for(let _t=0;_t<$.total;_t++)$.vertices[it++]-=O,$.vertices[it++]-=Z,$.vertices[it++]-=O,$.vertices[it++]-=Z,$.vertices[it++]-=O,$.vertices[it++]-=Z,$.vertices[it++]-=O,$.vertices[it++]-=Z}this._maxLineHeight=v*i;const D=$.mesh.geometry.getBuffer("aVertexPosition"),M=$.mesh.geometry.getBuffer("aTextureCoord"),ht=$.mesh.geometry.getIndex();D.data=$.vertices,M.data=$.uvs,ht.data=$.indices,D.update(),M.update(),ht.update()}for(let N=0;N<n.length;N++)Zc.push(n[N]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:i,size:s}=te.available[this._fontName];if(i!=="none"){const{a:n,b:r,c:o,d:a}=this.worldTransform,h=Math.sqrt(n*n+r*r),l=Math.sqrt(o*o+a*a),c=(Math.abs(h)+Math.abs(l))/2,u=this.fontSize/s,d=e._view.resolution;for(const f of this._activePagesMeshData)f.mesh.shader.uniforms.uFWidth=c*t*u*d}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=te.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!te.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??te.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,s=te.available[this._fontName].distanceFieldType==="none"?Kc:qc;s.push(...this._activePagesMeshData);for(const n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],s.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=K.EMPTY});for(const n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};let eT=Mf;eT.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const iT=[".xml",".fnt"],sT={extension:{type:V.LoadParser,priority:je.Normal},name:"loadBitmapFont",test(e){return iT.includes(Kt.extname(e).toLowerCase())},async testParse(e){return mr.test(e)||Ja.test(e)},async parse(e,t,i){const s=mr.test(e)?mr.parse(e):Ja.parse(e),{src:n}=t,{page:r}=s,o=[];for(let l=0;l<r.length;++l){const c=r[l].file;let u=Kt.join(Kt.dirname(n),c);u=Va(u,n),o.push(u)}const a=await i.load(o),h=o.map(l=>a[l]);return te.install(s,h,!0)},async load(e,t){return(await z.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};q.add(sT);const ss=class extends ri{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new ss(Object.keys(ss.defaultOptions).reduce((t,i)=>({...t,[i]:e[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete ss.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:i}=ss;if(i[e]){const s=i[e];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return z.ADAPTER.fetch(e).then(s=>s.blob()).then(async s=>new Promise((n,r)=>{const o=URL.createObjectURL(s),a=new FileReader;a.onload=()=>n([o,a.result]),a.onerror=r,a.readAsDataURL(s)})).then(async([s,n])=>{const r=Object.assign({family:Kt.basename(e,Kt.extname(e)),weight:"normal",style:"normal",src:s,dataSrc:n,refs:1,originalUrl:e,fontFace:null},t);i[e]=r,this._fonts.push(r),this.styleID++;const o=new FontFace(r.family,`url(${r.src})`,{weight:r.weight,style:r.style});r.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(i=>!this._overrides.includes(i));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(i=>this._overrides.includes(i));t.length>0&&(this._overrides=this._overrides.filter(i=>!t.includes(i)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=ov(e)),typeof e=="number"?rv(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const n=`${i}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${n} ${e}`}reset(){Object.assign(this,ss.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=z.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let sn=ss;sn.availableFonts={};sn.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const ns=class extends Rs{constructor(e="",t={}){super(K.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const i=new Image,s=K.from(i,{scaleMode:z.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new lt,s.trim=new lt,this.texture=s;const n="http://www.w3.org/2000/svg",r="http://www.w3.org/1999/xhtml",o=document.createElementNS(n,"svg"),a=document.createElementNS(n,"foreignObject"),h=document.createElementNS(r,"div"),l=document.createElementNS(r,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=ns.defaultMaxWidth,this.maxHeight=ns.defaultMaxHeight,this._domElement=h,this._styleElement=l,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(l),this._foreignObject.appendChild(h),this._image=i,this._loadImage=new Image,this._autoResolution=ns.defaultAutoResolution,this._resolution=ns.defaultResolution??z.RESOLUTION,this.text=e,this.style=t}measureText(e){var a,h;const{text:t,style:i,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:i.toCSS(s)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const r=Math.min(this.maxWidth,Math.ceil(n.width)),o=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",r.toString()),this._svgRoot.setAttribute("height",o.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(a=this._style)==null?void 0:a.toCSS(s)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:r+i.padding*2,height:o+i.padding*2}}async updateText(e=!0){const{style:t,_image:i,_loadImage:s}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:n,height:r}=this.measureText();i.width=s.width=Math.ceil(Math.max(1,n)),i.height=s.height=Math.ceil(Math.max(1,r)),this._loading||(this._loading=!0,await new Promise(o=>{s.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,i.src=s.src,s.onload=null,s.src="",this.updateTexture(),o()};const a=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(a)}`}))}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:i,resolution:s}=this,{padding:n}=e,{baseTexture:r}=t;t.trim.width=t._frame.width=i.width/s,t.trim.height=t._frame.height=i.height/s,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),r.setRealSize(i.width,i.height,s),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var i,s,n,r,o;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},ns.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=t,(s=this._svgRoot)==null||s.remove(),this._svgRoot=t,(n=this._domElement)==null||n.remove(),this._domElement=t,(r=this._foreignObject)==null||r.remove(),this._foreignObject=t,(o=this._styleElement)==null||o.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=mi(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=mi(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof sn?(this.ownsStyle=!1,this._style=e):e instanceof ri?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=sn.from(e)):(this.ownsStyle=!0,this._style=new sn(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let po=ns;po.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};po.defaultMaxWidth=2024;po.defaultMaxHeight=2024;po.defaultAutoResolution=!0;var nT=Object.defineProperty,rT=(e,t,i)=>t in e?nT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,C=(e,t,i)=>(rT(e,typeof t!="symbol"?t+"":t,i),i);class ce{constructor(t){C(this,"parent"),C(this,"paused"),this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var oT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rf={exports:{}};(function(e,t){(function(){var i,s;s=function(n){return e.exports=n},i={linear:function(n,r,o,a){return o*n/a+r},easeInQuad:function(n,r,o,a){return o*(n/=a)*n+r},easeOutQuad:function(n,r,o,a){return-o*(n/=a)*(n-2)+r},easeInOutQuad:function(n,r,o,a){return(n/=a/2)<1?o/2*n*n+r:-o/2*(--n*(n-2)-1)+r},easeInCubic:function(n,r,o,a){return o*(n/=a)*n*n+r},easeOutCubic:function(n,r,o,a){return o*((n=n/a-1)*n*n+1)+r},easeInOutCubic:function(n,r,o,a){return(n/=a/2)<1?o/2*n*n*n+r:o/2*((n-=2)*n*n+2)+r},easeInQuart:function(n,r,o,a){return o*(n/=a)*n*n*n+r},easeOutQuart:function(n,r,o,a){return-o*((n=n/a-1)*n*n*n-1)+r},easeInOutQuart:function(n,r,o,a){return(n/=a/2)<1?o/2*n*n*n*n+r:-o/2*((n-=2)*n*n*n-2)+r},easeInQuint:function(n,r,o,a){return o*(n/=a)*n*n*n*n+r},easeOutQuint:function(n,r,o,a){return o*((n=n/a-1)*n*n*n*n+1)+r},easeInOutQuint:function(n,r,o,a){return(n/=a/2)<1?o/2*n*n*n*n*n+r:o/2*((n-=2)*n*n*n*n+2)+r},easeInSine:function(n,r,o,a){return-o*Math.cos(n/a*(Math.PI/2))+o+r},easeOutSine:function(n,r,o,a){return o*Math.sin(n/a*(Math.PI/2))+r},easeInOutSine:function(n,r,o,a){return-o/2*(Math.cos(Math.PI*n/a)-1)+r},easeInExpo:function(n,r,o,a){return n===0?r:o*Math.pow(2,10*(n/a-1))+r},easeOutExpo:function(n,r,o,a){return n===a?r+o:o*(-Math.pow(2,-10*n/a)+1)+r},easeInOutExpo:function(n,r,o,a){return(n/=a/2)<1?o/2*Math.pow(2,10*(n-1))+r:o/2*(-Math.pow(2,-10*--n)+2)+r},easeInCirc:function(n,r,o,a){return-o*(Math.sqrt(1-(n/=a)*n)-1)+r},easeOutCirc:function(n,r,o,a){return o*Math.sqrt(1-(n=n/a-1)*n)+r},easeInOutCirc:function(n,r,o,a){return(n/=a/2)<1?-o/2*(Math.sqrt(1-n*n)-1)+r:o/2*(Math.sqrt(1-(n-=2)*n)+1)+r},easeInElastic:function(n,r,o,a){var h,l,c;return c=1.70158,l=0,h=o,n===0||(n/=a),l||(l=a*.3),h<Math.abs(o)?(h=o,c=l/4):c=l/(2*Math.PI)*Math.asin(o/h),-(h*Math.pow(2,10*(n-=1))*Math.sin((n*a-c)*(2*Math.PI)/l))+r},easeOutElastic:function(n,r,o,a){var h,l,c;return c=1.70158,l=0,h=o,n===0||(n/=a),l||(l=a*.3),h<Math.abs(o)?(h=o,c=l/4):c=l/(2*Math.PI)*Math.asin(o/h),h*Math.pow(2,-10*n)*Math.sin((n*a-c)*(2*Math.PI)/l)+o+r},easeInOutElastic:function(n,r,o,a){var h,l,c;return c=1.70158,l=0,h=o,n===0||(n/=a/2),l||(l=a*(.3*1.5)),h<Math.abs(o)?(h=o,c=l/4):c=l/(2*Math.PI)*Math.asin(o/h),n<1?-.5*(h*Math.pow(2,10*(n-=1))*Math.sin((n*a-c)*(2*Math.PI)/l))+r:h*Math.pow(2,-10*(n-=1))*Math.sin((n*a-c)*(2*Math.PI)/l)*.5+o+r},easeInBack:function(n,r,o,a,h){return h===void 0&&(h=1.70158),o*(n/=a)*n*((h+1)*n-h)+r},easeOutBack:function(n,r,o,a,h){return h===void 0&&(h=1.70158),o*((n=n/a-1)*n*((h+1)*n+h)+1)+r},easeInOutBack:function(n,r,o,a,h){return h===void 0&&(h=1.70158),(n/=a/2)<1?o/2*(n*n*(((h*=1.525)+1)*n-h))+r:o/2*((n-=2)*n*(((h*=1.525)+1)*n+h)+2)+r},easeInBounce:function(n,r,o,a){var h;return h=i.easeOutBounce(a-n,0,o,a),o-h+r},easeOutBounce:function(n,r,o,a){return(n/=a)<1/2.75?o*(7.5625*n*n)+r:n<2/2.75?o*(7.5625*(n-=1.5/2.75)*n+.75)+r:n<2.5/2.75?o*(7.5625*(n-=2.25/2.75)*n+.9375)+r:o*(7.5625*(n-=2.625/2.75)*n+.984375)+r},easeInOutBounce:function(n,r,o,a){var h;return n<a/2?(h=i.easeInBounce(n*2,0,o,a),h*.5+r):(h=i.easeOutBounce(n*2-a,0,o,a),h*.5+o*.5+r)}},s(i)}).call(oT)})(Rf);const Jc=Rf.exports;function mo(e,t){if(e){if(typeof e=="function")return e;if(typeof e=="string")return Jc[e]}else return Jc[t]}const aT={removeOnInterrupt:!1,ease:"linear",time:1e3};class hT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"startX"),C(this,"startY"),C(this,"deltaX"),C(this,"deltaY"),C(this,"keepCenter"),C(this,"startWidth",null),C(this,"startHeight",null),C(this,"deltaWidth",null),C(this,"deltaHeight",null),C(this,"width",null),C(this,"height",null),C(this,"time",0),this.options=Object.assign({},aT,i),this.options.ease=mo(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),this.width!==null&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),this.height!==null&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),this.width!==null&&this.parent.fitWidth(this.width,this.keepCenter,this.height===null),this.height!==null&&this.parent.fitHeight(this.height,this.keepCenter,this.width===null),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(this.paused)return;this.time+=t;const i=new st(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const s=this.parent.width,n=this.parent.height;this.complete(),(s!==this.parent.width||n!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:i,type:"animate"})}else{const s=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){const n=this.startWidth,r=this.deltaWidth;this.parent.fitWidth(n+r*s,this.keepCenter,this.height===null)}if(this.height!==null){const n=this.startHeight,r=this.deltaHeight;this.parent.fitHeight(n+r*s,this.keepCenter,this.width===null)}if(this.width===null?this.parent.scale.x=this.parent.scale.y:this.height===null&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const n=this.startX,r=this.startY,o=this.deltaX,a=this.deltaY,h=new st(this.parent.x,this.parent.y);this.parent.moveCenter(n+o*s,r+a*s),this.parent.emit("moved",{viewport:this.parent,original:h,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:i,type:"animate"})}}}const lT={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class cT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"left"),C(this,"top"),C(this,"right"),C(this,"bottom"),C(this,"underflowX"),C(this,"underflowY"),C(this,"ease"),C(this,"toX"),C(this,"toY"),this.options=Object.assign({},lT,i),this.ease=mo(this.options.ease,"easeInOutSine"),this.options.sides?this.options.sides==="all"?this.top=this.bottom=this.left=this.right=!0:this.options.sides==="horizontal"?(this.right=this.left=!0,this.top=this.bottom=!1):this.options.sides==="vertical"?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1):this.left=this.top=this.right=this.bottom=!1;const s=this.options.underflow.toLowerCase();s==="center"?(this.underflowX=0,this.underflowY=0):(this.underflowX=s.indexOf("left")!==-1?-1:s.indexOf("right")!==-1?1:0,this.underflowY=s.indexOf("top")!==-1?-1:s.indexOf("bottom")!==-1?1:0),this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const i=this.toX;i.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),i.time>=this.options.time?(this.parent.x=i.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(i.time,i.start,i.delta,this.options.time)}if(this.toY){const i=this.toY;i.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),i.time>=this.options.time?(this.parent.y=i.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(i.time,i.start,i.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const i=typeof t.x>"u"?0:t.x,s=typeof t.y>"u"?0:t.y,n=typeof t.width>"u"?this.parent.worldWidth:t.width,r=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<i,right:this.parent.right>n,top:this.parent.top<s,bottom:this.parent.bottom>r,topLeft:new st(i*this.parent.scale.x,s*this.parent.scale.y),bottomRight:new st(n*this.parent.scale.x-this.parent.screenWidth,r*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new st(0,0),bottomRight:new st(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var t,i;if(this.paused)return;let s,n=this.parent.plugins.get("decelerate",!0);n&&(n.x||n.y)&&(n.x&&n.percentChangeX===((t=n.options)==null?void 0:t.friction)||n.y&&n.percentChangeY===((i=n.options)==null?void 0:i.friction))&&(s=this.oob(),(s.left&&this.left||s.right&&this.right)&&(n.percentChangeX=this.options.friction),(s.top&&this.top||s.bottom&&this.bottom)&&(n.percentChangeY=this.options.friction));const r=this.parent.plugins.get("drag",!0)||{},o=this.parent.plugins.get("pinch",!0)||{};if(n=n||{},!(r!=null&&r.active)&&!(o!=null&&o.active)&&(!this.toX||!this.toY)&&(!n.x||!n.y)){s=s||this.oob();const a=s.topLeft,h=s.bottomRight;if(!this.toX&&!n.x){let l=null;s.left&&this.left?l=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-a.x:s.right&&this.right&&(l=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-h.x),l!==null&&this.parent.x!==l&&(this.toX={time:0,start:this.parent.x,delta:l-this.parent.x,end:l},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!n.y){let l=null;s.top&&this.top?l=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-a.y:s.bottom&&this.bottom&&(l=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-h.y),l!==null&&this.parent.y!==l&&(this.toY={time:0,start:this.parent.y,delta:l-this.parent.y,end:l},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const uT={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class dT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"last"),C(this,"noUnderflow"),C(this,"underflowX"),C(this,"underflowY"),this.options=Object.assign({},uT,i),this.options.direction&&(this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();t==="none"?this.noUnderflow=!0:t==="center"?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=t.indexOf("left")!==-1?-1:t.indexOf("right")!==-1?1:0,this.underflowY=t.indexOf("top")!==-1?-1:t.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t=new st(this.parent.x,this.parent.y),i=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let s=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x!==0&&(this.parent.x=0,s=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,s=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,s=!0)}else this.options.left!==null&&this.parent.left<(this.options.left===!0?0:this.options.left)&&(this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,i.x=0,s=!0),this.options.right!==null&&this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,i.x=0,s=!0);s&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let s=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y!==0&&(this.parent.y=0,s=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,s=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,s=!0)}else this.options.top!==null&&this.parent.top<(this.options.top===!0?0:this.options.top)&&(this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,i.y=0,s=!0),this.options.bottom!==null&&this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,i.y=0,s=!0);s&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const fT={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class pT extends ce{constructor(t,i={}){super(t),C(this,"options"),this.options=Object.assign({},fT,i),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused){if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,i=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&t<this.options.minWidth){const s=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/s,t=this.parent.worldScreenWidth,i=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&t>this.options.maxWidth){const s=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/s,t=this.parent.worldScreenWidth,i=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&i<this.options.minHeight){const s=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/s,t=this.parent.worldScreenWidth,i=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&i>this.options.maxHeight){const s=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/s,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},i={x:null,y:null};if(typeof this.options.minScale=="number")t.x=this.options.minScale,t.y=this.options.minScale;else if(this.options.minScale!==null){const r=this.options.minScale;t.x=typeof r.x>"u"?null:r.x,t.y=typeof r.y>"u"?null:r.y}if(typeof this.options.maxScale=="number")i.x=this.options.maxScale,i.y=this.options.maxScale;else if(this.options.maxScale!==null){const r=this.options.maxScale;i.x=typeof r.x>"u"?null:r.x,i.y=typeof r.y>"u"?null:r.y}let s=this.parent.scale.x,n=this.parent.scale.y;t.x!==null&&s<t.x&&(s=t.x),i.x!==null&&s>i.x&&(s=i.x),t.y!==null&&n<t.y&&(n=t.y),i.y!==null&&n>i.y&&(n=i.y),(s!==this.parent.scale.x||n!==this.parent.scale.y)&&(this.parent.scale.set(s,n),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}}reset(){this.clamp()}}const mT={friction:.98,bounce:.8,minSpeed:.01},ci=16;class gT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"x"),C(this,"y"),C(this,"percentChangeX"),C(this,"percentChangeY"),C(this,"saved"),C(this,"timeSinceRelease"),this.options=Object.assign({},mT,i),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",s=>this.handleMoved(s))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(t===1||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved(t){if(this.saved.length){const i=this.saved[this.saved.length-1];t.type==="clamp-x"&&t.original?i.x===t.original.x&&(i.x=this.parent.x):t.type==="clamp-y"&&t.original&&i.y===t.original.y&&(i.y=this.parent.y)}}up(){if(this.parent.input.count()===0&&this.saved.length){const t=performance.now();for(const i of this.saved)if(i.time>=t-100){const s=t-i.time;this.x=(this.parent.x-i.x)/s,this.y=(this.parent.y-i.y)/s,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){t=t||{},typeof t.x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const i=this.x||this.y,s=this.timeSinceRelease,n=this.timeSinceRelease+t;if(this.x){const r=this.percentChangeX,o=Math.log(r);this.parent.x+=this.x*ci/o*(Math.pow(r,n/ci)-Math.pow(r,s/ci)),this.x*=Math.pow(this.percentChangeX,t/ci)}if(this.y){const r=this.percentChangeY,o=Math.log(r);this.parent.y+=this.y*ci/o*(Math.pow(r,n/ci)-Math.pow(r,s/ci)),this.y*=Math.pow(this.percentChangeY,t/ci)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),i&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const _T={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class xT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"moved"),C(this,"reverse"),C(this,"xDirection"),C(this,"yDirection"),C(this,"keyIsPressed"),C(this,"mouse"),C(this,"underflowX"),C(this,"underflowY"),C(this,"last"),C(this,"current"),C(this,"windowEventHandlers",[]),this.options=Object.assign({},_T,i),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){const i=n=>{t.includes(n.code)&&(this.keyIsPressed=!0)},s=n=>{t.includes(n.code)&&(this.keyIsPressed=!1)};this.addWindowEventHandler("keyup",s),this.addWindowEventHandler("keydown",i)}addWindowEventHandler(t,i){window.addEventListener(t,i),this.windowEventHandlers.push({event:t,handler:i})}destroy(){this.windowEventHandlers.forEach(({event:t,handler:i})=>{window.removeEventListener(t,i)})}mouseButtons(t){!t||t==="all"?this.mouse=[!0,!0,!0]:this.mouse=[t.indexOf("left")!==-1,t.indexOf("middle")!==-1,t.indexOf("right")!==-1]}parseUnderflow(){const t=this.options.underflow.toLowerCase();t==="center"?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const i=t.pointerType==="mouse",s=this.parent.input.count();return!!((s===1||s>1&&!this.parent.plugins.get("pinch",!0))&&(!i||this.mouse[t.button]))}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&t.data.pointerType==="touch"}down(t){return this.paused||!this.options.pressDrag?!1:this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.global.x,y:t.global.y},this.current=t.pointerId,!0):(this.last=null,!1)}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const i=t.global.x,s=t.global.y,n=this.parent.input.count();if(n===1||n>1&&!this.parent.plugins.get("pinch",!0)){const r=i-this.last.x,o=s-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(r)||this.yDirection&&this.parent.input.checkThreshold(o)){const a={x:i,y:s};return this.xDirection&&(this.parent.x+=(a.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(a.y-this.last.y)*this.options.factor),this.last=a,this.moved||this.parent.emit("drag-start",{event:t,screen:new st(this.last.x,this.last.y),world:this.parent.toWorld(new st(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const i=this.parent.input.touches;if(i.length===1){const s=i[0];return s.last&&(this.last={x:s.last.x,y:s.last.y},this.current=s.id),this.moved=!1,!0}else if(this.last&&this.moved){const s=new st(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:s,world:this.parent.toWorld(s),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){const i=this.parent.plugins.get("wheel",!0);if(!i||!i.options.wheelZoom&&!t.ctrlKey){const s=t.deltaMode?this.options.lineHeight:1,n=[t.deltaX,t.deltaY],[r,o]=this.options.wheelSwapAxes?n.reverse():n;return this.xDirection&&(this.parent.x+=r*s*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=o*s*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y")if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const yT={speed:0,acceleration:null,radius:null};class vT extends ce{constructor(t,i,s={}){super(t),C(this,"options"),C(this,"target"),C(this,"velocity"),this.target=i,this.options=Object.assign({},yT,s),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const i=this.parent.center;let s=this.target.x,n=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-i.y,2)+Math.pow(this.target.x-i.x,2))>this.options.radius){const a=Math.atan2(this.target.y-i.y,this.target.x-i.x);s=this.target.x-Math.cos(a)*this.options.radius,n=this.target.y-Math.sin(a)*this.options.radius}else return;const r=s-i.x,o=n-i.y;if(r||o)if(this.options.speed)if(this.options.acceleration){const a=Math.atan2(n-i.y,s-i.x),h=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));if(h){const l=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);h>l?this.velocity={x:Math.min(this.velocity.x+(this.options.acceleration*t,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration*t,this.options.speed))}:this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const c=Math.cos(a)*this.velocity.x,u=Math.sin(a)*this.velocity.y,d=Math.abs(c)>Math.abs(r)?s:i.x+c,f=Math.abs(u)>Math.abs(o)?n:i.y+u;this.parent.moveCenter(d,f),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const a=Math.atan2(n-i.y,s-i.x),h=Math.cos(a)*this.options.speed,l=Math.sin(a)*this.options.speed,c=Math.abs(h)>Math.abs(r)?s:i.x+h,u=Math.abs(l)>Math.abs(o)?n:i.y+l;this.parent.moveCenter(c,u),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(s,n),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const wT={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class bT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"reverse"),C(this,"radiusSquared"),C(this,"left"),C(this,"top"),C(this,"right"),C(this,"bottom"),C(this,"horizontal"),C(this,"vertical"),this.options=Object.assign({},wT,i),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius=="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;t!==null?(this.left=t,this.top=t,this.right=this.parent.screenWidth-t,this.bottom=this.parent.screenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.screenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||t.pointerType!=="mouse"&&t.pointerId!==1||!this.options.allowButtons&&t.buttons!==0)return!1;const i=t.global.x,s=t.global.y;if(this.radiusSquared){const n=this.parent.toScreen(this.parent.center);if(Math.pow(n.x-i,2)+Math.pow(n.y-s,2)>=this.radiusSquared){const r=Math.atan2(n.y-s,n.x-i);this.options.linear?(this.horizontal=Math.round(Math.cos(r))*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.round(Math.sin(r))*this.options.speed*this.reverse*(60/1e3)):(this.horizontal=Math.cos(r)*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.sin(r)*this.options.speed*this.reverse*(60/1e3))}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else this.left!==null&&i<this.left?this.horizontal=Number(this.reverse)*this.options.speed*(60/1e3):this.right!==null&&i>this.right?this.horizontal=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateHorizontal(),this.horizontal=0),this.top!==null&&s<this.top?this.vertical=Number(this.reverse)*this.options.speed*(60/1e3):this.bottom!==null&&s>this.bottom?this.vertical=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const TT={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class ET extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"active",!1),C(this,"pinching",!1),C(this,"moved",!1),C(this,"lastCenter"),this.options=Object.assign({},TT,i)}down(){return this.parent.input.count()>=2?(this.active=!0,!0):!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const i=t.global.x,s=t.global.y,n=this.parent.input.touches;if(n.length>=2){const r=n[0],o=n[1],a=r.last&&o.last?Math.sqrt(Math.pow(o.last.x-r.last.x,2)+Math.pow(o.last.y-r.last.y,2)):null;if(r.id===t.pointerId?r.last={x:i,y:s,data:t}:o.id===t.pointerId&&(o.last={x:i,y:s,data:t}),a){let h;const l=new st(r.last.x+(o.last.x-r.last.x)/2,r.last.y+(o.last.y-r.last.y)/2);this.options.center||(h=this.parent.toLocal(l));let c=Math.sqrt(Math.pow(o.last.x-r.last.x,2)+Math.pow(o.last.y-r.last.y,2));c=c===0?c=1e-10:c;const u=(1-a/c)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=u),this.isAxisY()&&(this.parent.scale.y+=u),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:l});const d=this.parent.plugins.get("clamp-zoom",!0);if(d&&d.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const f=this.parent.toGlobal(h);this.parent.x+=(l.x-f.x)*this.options.factor,this.parent.y+=(l.y-f.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(l.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(l.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=l,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return this.pinching&&this.parent.input.touches.length<=1?(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}const AT={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class ST extends ce{constructor(t,i,s,n={}){super(t),C(this,"options"),C(this,"ease"),C(this,"x"),C(this,"y"),C(this,"percent"),C(this,"snapping"),C(this,"deltaX"),C(this,"deltaY"),C(this,"startX"),C(this,"startY"),this.options=Object.assign({},AT,n),this.ease=mo(n.ease,"easeInOutSine"),this.x=i,this.y=s,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(this.parent.input.count()===0){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!this.paused&&!(this.options.interrupt&&this.parent.input.count()!==0))if(this.snapping){const i=this.snapping;i.time+=t;let s,n,r;const o=this.startX,a=this.startY,h=this.deltaX,l=this.deltaY;if(i.time>this.options.time)s=!0,n=o+h,r=a+l;else{const c=this.ease(i.time,0,1,this.options.time);n=o+h*c,r=a+l*c}this.options.topLeft?this.parent.moveCorner(n,r):this.parent.moveCenter(n,r),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),s&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const i=this.options.topLeft?this.parent.corner:this.parent.center;(i.x!==this.x||i.y!==this.y)&&this.snapStart()}}}const CT={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class IT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"ease"),C(this,"xScale"),C(this,"yScale"),C(this,"xIndependent"),C(this,"yIndependent"),C(this,"snapping"),this.options=Object.assign({},CT,i),this.ease=mo(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):i.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,i=this.parent.worldScreenHeight,s=this.parent.screenWidth/this.xScale,n=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:i,deltaX:s-t,deltaY:n-i},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&this.parent.input.count()!==0)return;let i;if(!this.options.center&&!this.options.noMove&&(i=this.parent.center),!this.snapping)(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping();else if(this.snapping){const s=this.snapping;if(s.time+=t,s.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const r=this.snapping,o=this.ease(r.time,r.startX,r.deltaX,this.options.time),a=this.ease(r.time,r.startY,r.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/o,this.parent.scale.y=this.parent.screenHeight/a}const n=this.parent.plugins.get("clamp-zoom",!0);n&&n.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(i))}}resume(){this.snapping=null,super.resume()}}const PT={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class MT extends ce{constructor(t,i={}){super(t),C(this,"options"),C(this,"smoothing"),C(this,"smoothingCenter"),C(this,"smoothingCount"),C(this,"keyIsPressed"),this.options=Object.assign({},PT,i),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",i=>{t.includes(i.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",i=>{t.includes(i.code)&&(this.keyIsPressed=!1)})}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,i=this.smoothing;let s;this.options.center||(s=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=i.x),this.isAxisY()&&(this.parent.scale.y+=i.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const r=this.parent.toGlobal(s);this.parent.x+=t.x-r.x,this.parent.y+=t.y-r.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(t){if(this.paused)return;const i=this.parent.input.getPointerPosition(t),s=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,n=Math.pow(2,(1+this.options.percent)*s);let r;this.options.center||(r=this.parent.toLocal(i)),this.isAxisX()&&(this.parent.scale.x*=n),this.isAxisY()&&(this.parent.scale.y*=n),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const a=this.parent.toGlobal(r);this.parent.x+=i.x-a.x,this.parent.y+=i.y-a.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}wheel(t){if(this.paused||!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){const i=this.parent.input.getPointerPosition(t),s=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,n=Math.pow(2,(1+this.options.percent)*s);if(this.options.smooth){const r={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+r.x)*n-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+r.y)*n-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=i}else{let r;this.options.center||(r=this.parent.toLocal(i)),this.isAxisX()&&(this.parent.scale.x*=n),this.isAxisY()&&(this.parent.scale.y*=n),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const a=this.parent.toGlobal(r);this.parent.x+=i.x-a.x,this.parent.y+=i.y-a.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}class RT{constructor(t){C(this,"viewport"),C(this,"clickedAvailable"),C(this,"isMouseDown"),C(this,"last"),C(this,"wheelFunction"),C(this,"touches"),this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new lt(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.options.allowPreserveDragOutside?this.viewport.on("globalpointermove",this.move,this):this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.options.allowPreserveDragOutside||this.viewport.on("pointerleave",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.events.domElement.removeEventListener("wheel",this.wheelFunction)}down(t){if(!(this.viewport.pause||!this.viewport.worldVisible)){if(t.pointerType==="mouse"?this.isMouseDown=!0:this.get(t.pointerId)||this.touches.push({id:t.pointerId,last:null}),this.count()===1){this.last=t.global.clone();const i=this.viewport.plugins.get("decelerate",!0),s=this.viewport.plugins.get("bounce",!0);(!i||!i.isActive())&&(!s||!s.isActive())?this.clickedAvailable=!0:this.clickedAvailable=!1}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const i=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const s=t.global.x-this.last.x,n=t.global.y-this.last.y;(this.checkThreshold(s)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}i&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;t.pointerType==="mouse"&&(this.isMouseDown=!1),t.pointerType!=="mouse"&&this.remove(t.pointerId);const i=this.viewport.plugins.up(t);this.clickedAvailable&&this.count()===0&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),i&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const i=new st;return this.viewport.options.events.mapPositionToPoint(i,t.clientX,t.clientY),i}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const i=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=i.x&&i.x<=this.viewport.right&&this.viewport.top<=i.y&&i.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const i of this.touches)if(i.id===t)return i;return null}remove(t){for(let i=0;i<this.touches.length;i++)if(this.touches[i].id===t){this.touches.splice(i,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}const Gs=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class DT{constructor(t){C(this,"plugins"),C(this,"list"),C(this,"viewport"),this.viewport=t,this.list=[],this.plugins={}}add(t,i,s=Gs.length){const n=this.plugins[t];n&&n.destroy(),this.plugins[t]=i;const r=Gs.indexOf(t);r!==-1&&Gs.splice(r,1),Gs.splice(s,0,t),this.sort()}get(t,i){var s;return i&&(s=this.plugins[t])!=null&&s.paused?null:this.plugins[t]}update(t){for(const i of this.list)i.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.list.forEach(t=>{t.destroy()}),this.plugins={},this.sort()}remove(t){var i;this.plugins[t]&&((i=this.plugins[t])==null||i.destroy(),delete this.plugins[t],this.viewport.emit("plugin-remove",t),this.sort())}pause(t){var i;(i=this.plugins[t])==null||i.pause()}resume(t){var i;(i=this.plugins[t])==null||i.resume()}sort(){this.list=[];for(const t of Gs)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let i=!1;for(const s of this.list)s.down(t)&&(i=!0);return i}move(t){let i=!1;for(const s of this.viewport.plugins.list)s.move(t)&&(i=!0);return i}up(t){let i=!1;for(const s of this.list)s.up(t)&&(i=!0);return i}wheel(t){let i=!1;for(const s of this.list)s.wheel(t)&&(i=!0);return i}}const BT={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:Gt.shared,allowPreserveDragOutside:!1};class FT extends ae{constructor(t){super(),C(this,"moving"),C(this,"screenWidth"),C(this,"screenHeight"),C(this,"threshold"),C(this,"input"),C(this,"plugins"),C(this,"zooming"),C(this,"lastViewport"),C(this,"options"),C(this,"_dirty"),C(this,"_forceHitArea"),C(this,"_hitAreaDefault"),C(this,"_pause"),C(this,"tickerFunction"),C(this,"_worldWidth"),C(this,"_worldHeight"),C(this,"_disableOnContextMenu",i=>i.preventDefault()),this.options={...BT,...t},this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new RT(this),this.plugins=new DT(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.events.domElement.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new lt(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,i=window.innerHeight,s,n){this.screenWidth=t,this.screenHeight=i,typeof s<"u"&&(this._worldWidth=s),typeof n<"u"&&(this._worldHeight=n),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new lt(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,i){return arguments.length===2?this.toLocal(new st(t,i)):this.toLocal(t)}toScreen(t,i){return arguments.length===2?this.toGlobal(new st(t,i)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new st(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let i,s;typeof t[0]=="number"?(i=t[0],s=t[1]):(i=t[0].x,s=t[0].y);const n=(this.worldScreenWidth/2-i)*this.scale.x,r=(this.worldScreenHeight/2-s)*this.scale.y;return(this.x!==n||this.y!==r)&&(this.position.set(n,r),this.plugins.reset(),this.dirty=!0),this}get corner(){return new st(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let i,s;return t.length===1?(i=-t[0].x*this.scale.x,s=-t[0].y*this.scale.y):(i=-t[0]*this.scale.x,s=-t[1]*this.scale.y),(i!==this.x||s!==this.y)&&(this.position.set(i,s),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,i){const s=this.screenWidth/t,n=this.screenHeight/i;return Math.min(s,n)}findCover(t,i){const s=this.screenWidth/t,n=this.screenHeight/i;return Math.max(s,n)}fitWidth(t=this.worldWidth,i,s=!0,n){let r;i&&(r=this.center),this.scale.x=this.screenWidth/t,s&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),i&&r&&this.moveCenter(r),this}fitHeight(t=this.worldHeight,i,s=!0,n){let r;i&&(r=this.center),this.scale.y=this.screenHeight/t,s&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),i&&r&&this.moveCenter(r),this}fitWorld(t){let i;t&&(i=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),t&&i&&this.moveCenter(i),this}fit(t,i=this.worldWidth,s=this.worldHeight){let n;t&&(n=this.center),this.scale.x=this.screenWidth/i,this.scale.y=this.screenHeight/s,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),t&&n&&this.moveCenter(n),this}setZoom(t,i){let s;i&&(s=this.center),this.scale.set(t);const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),i&&s&&this.moveCenter(s),this}zoomPercent(t,i){return this.setZoom(this.scale.x+this.scale.x*t,i)}zoom(t,i){return this.fitWidth(t+this.worldScreenWidth,i),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new IT(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new st(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new lt(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new xT(this,t)),this}clamp(t){return this.plugins.add("clamp",new dT(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new gT(this,t)),this}bounce(t){return this.plugins.add("bounce",new cT(this,t)),this}pinch(t){return this.plugins.add("pinch",new ET(this,t)),this}snap(t,i,s){return this.plugins.add("snap",new ST(this,t,i,s)),this}follow(t,i){return this.plugins.add("follow",new vT(this,t,i)),this}wheel(t){return this.plugins.add("wheel",new MT(this,t)),this}animate(t){return this.plugins.add("animate",new hT(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new pT(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new bT(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,i,s,n,r){r&&(s>this.worldScreenWidth||n>this.worldScreenHeight)&&(this.fit(!0,s,n),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;t<this.left?(this.left=t,o=!0):t+s>this.right&&(this.right=t+s,o=!0),i<this.top?(this.top=i,o=!0):i+n>this.bottom&&(this.bottom=i+n,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}function NT(e,t,i,s,n){const r=t.map(T=>Object.assign({},T)),o=i.map(T=>Object.assign({},T)),a=e.getBoundingClientRect(),h=a.height,l=a.width;let c=!1;e.innerHTML="";const u=()=>"#f0f8ff";if(!document.querySelector("#graph-tooltip")){const T=document.createElement("div");T.classList.add("tooltip"),T.style.opacity="0",T.id="graph-tooltip",document.body.appendChild(T)}j_("#graph-tooltip");const f=T=>parseInt(u().slice(1),16);function p(T){v.plugins.pause("drag"),_.alphaTarget(.3).restart(),this.isDown=!0,this.eventData=T.data,this.alpha=.5,this.dragging=!0}function m(T){T.stopPropagation(),T.active||_.alphaTarget(0),this.alpha=1,this.dragging=!1,this.isOver=!1,this.eventData=null,v.plugins.resume("drag")}function g(T){if(T.dragging){c=!0;const I=T.eventData.getLocalPosition(T.parent);this.x=I.x,this.y=I.y}}const y=new Hh({width:l,height:h,antialias:!0,transparent:!0,resolution:1});y.renderer.type===Ir.WEBGL?console.log("Используется рендерер WebGL"):y.renderer.type===Ir.CANVAS&&console.log("Используется рендерер Canvas"),e.appendChild(y.view);const v=new FT({screenWidth:l,screenHeight:h,worldWidth:l*4,worldHeight:h*4,passiveWheel:!1,events:y.renderer.events});y.stage.addChild(v),v.drag().pinch().wheel().decelerate().clampZoom({minWidth:l/4,minHeight:h/4});const _=sy(o).force("link",Kx(r).id(T=>T.id).distance(50)).force("charge",ny().strength(-500)).force("center",Ix(l/2,h/2)).force("collision",jx().radius(T=>T.radius).iterations(2)).velocityDecay(.8);let x=new Ss;v.addChild(x),o.forEach(T=>{const I=g.bind(T),{name:S,gender:G}=T;T.gfx=new Ss,T.gfx.lineStyle(1,13882323),T.gfx.beginFill(f(T.id)),T.gfx.drawCircle(0,0,24),T.gfx.endFill(),T.gfx.on("click",N=>{c||N.stopPropagation(),c=!1}).on("mousedown",p).on("mouseup",m).on("mouseupoutside",m).on("mousemove",()=>I(T.gfx)),v.addChild(T.gfx),T.gfx.interactive=!0,T.gfx.buttonMode=!0,T.gfx.hitArea=new io(0,0,24);const H=new fo(S,{fontSize:12,fill:"#000"});H.anchor.set(.5),H.resolution=2,T.gfx.addChild(H)});const A=()=>{o.forEach(T=>{let{x:I,y:S,gfx:G}=T;G.position=new st(I,S)});for(let T=x.children.length-1;T>=0;T--)x.children[T].destroy();x.clear(),x.removeChildren(),x.alpha=1,r.forEach(T=>{let{source:I,target:S,number:G}=T;x.lineStyle(2,13882323),x.moveTo(I.x,I.y),x.lineTo(S.x,S.y)}),x.endFill()};return _.on("tick",A),{destroy:()=>{_.stop(),o.forEach(T=>{T.gfx.clear()}),x.clear()}}}const OT=_h({name:"NodeTooltip",setup(){return{style:$u()}}}),LT=_h({name:"GraphCanvas",setup(){const e=$u(),t=ra(null),i=ra(null),s=()=>{const n=[];for(let r=1;r<=1e3;r++)n.push({id:r,name:`name ${r}`,gender:"male"});return n};return Iu(()=>{NT(t.value,[],s(),OT,i.value)}),{style:e,container:t,canvas:i}}});const Df=(e,t)=>{const i=e.__vccOpts||e;for(const[s,n]of t)i[s]=n;return i},kT={class:"container",ref:"container"},UT={ref:"canvas",class:"canvas"};function HT(e,t,i,s,n,r){return ku(),Uu("div",kT,[Gu("GraphCanvas "),vh("canvas",UT,null,512)],512)}const GT=Df(LT,[["render",HT]]),WT={class:"container"},XT=_h({__name:"App",setup(e){return(t,i)=>(ku(),Uu("main",WT,[yi(GT)]))}});const $T=Df(XT,[["__scopeId","data-v-f721ca77"]]),Bf=ag($T);Bf.use(ug());Bf.mount("#app");
